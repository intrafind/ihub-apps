# JIRA Integration Configuration Example
# Copy these variables to your .env file and update with your values

# ==============================================================================
# JIRA CLOUD OAUTH CONFIGURATION (Required)
# ==============================================================================

# Your JIRA/Atlassian instance URL (without trailing slash)
JIRA_BASE_URL=https://your-company.atlassian.net

# OAuth2 Application Credentials from Atlassian Developer Console
# IMPORTANT: Create app at https://developer.atlassian.com/console/myapps/
# NOT in your JIRA instance admin panel
JIRA_OAUTH_CLIENT_ID=your-oauth-client-id-from-console
JIRA_OAUTH_CLIENT_SECRET=your-oauth-client-secret-from-console

# OAuth Redirect URI (must match EXACTLY what's configured in Atlassian)
# Development:
JIRA_OAUTH_REDIRECT_URI=http://localhost:5173/api/integrations/jira/callback
# Production (update with your domain):
# JIRA_OAUTH_REDIRECT_URI=https://your-ihub-domain.com/api/integrations/jira/callback

# Security Configuration (Required for production)
# Generate a secure 256-bit key: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
TOKEN_ENCRYPTION_KEY=your-256-bit-encryption-key-in-hex-format

# ==============================================================================
# OPTIONAL CONFIGURATION
# ==============================================================================

# Rate Limiting Configuration (optional, these are defaults)
# JIRA_RATE_LIMIT_WINDOW=900000  # 15 minutes in milliseconds
# JIRA_RATE_LIMIT_MAX=100        # Maximum requests per window per user

# ==============================================================================
# SETUP INSTRUCTIONS
# ==============================================================================
#
# 1. CREATE ATLASSIAN OAUTH APP:
#    a. Go to https://developer.atlassian.com/console/myapps/
#    b. Click "Create" → "OAuth 2.0 integration"
#    c. Set App Type: OAuth 2.0 (3LO)
#    d. Set App Name: iHub Apps JIRA Integration
#
# 2. CONFIGURE OAUTH SETTINGS:
#    a. Add Callback URL matching JIRA_OAUTH_REDIRECT_URI above
#    b. Add Permissions (Scopes):
#       - read:jira-user    (Access user profile)
#       - read:jira-work    (Read issues, projects)
#       - write:jira-work   (Create/update issues)
#       - offline_access    (REQUIRED for refresh tokens)
#    c. Enable the app
#
# 3. COPY CREDENTIALS:
#    a. Copy Client ID → JIRA_OAUTH_CLIENT_ID
#    b. Copy Client Secret → JIRA_OAUTH_CLIENT_SECRET
#
# 4. GENERATE ENCRYPTION KEY:
#    Run: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#    Copy result → TOKEN_ENCRYPTION_KEY
#
# 5. ADD TO YOUR .env FILE:
#    Copy all the above variables to your .env file
#
# 6. RESTART SERVER:
#    npm run dev (development) or restart production server
#
# 7. TEST CONNECTION:
#    a. Go to http://localhost:5173/apps/jira-assistant
#    b. Ask "Show me my assigned tickets"
#    c. Click "Connect JIRA Account" when prompted
#
# ==============================================================================
# IMPORTANT NOTES
# ==============================================================================
#
# - Atlassian uses centralized OAuth endpoints:
#   Authorization: https://auth.atlassian.com/authorize
#   Token: https://auth.atlassian.com/oauth/token
#
# - API calls use: https://api.atlassian.com/ex/jira/{cloudId}/rest/api/3/
#
# - The audience=api.atlassian.com parameter is MANDATORY
#
# - Tokens expire after 1 hour but refresh automatically if offline_access granted
#
# - If no refresh token received, users must reconnect every hour (check logs)