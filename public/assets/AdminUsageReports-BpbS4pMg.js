import{u as T,j as e,L as S,I as b}from"./index-BImwYGvy.js";import{r as w}from"./vendor-react-9AdXaApd.js";import{f as E}from"./adminApi-ChCbw-zB.js";import{A as J}from"./AdminAuth-DlQsuewr.js";import{A as V}from"./AdminNavigation-BmtWl3vA.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";const f=({title:s,value:m,icon:c,color:j,change:x,changeType:a})=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:typeof m=="number"?new Intl.NumberFormat().format(m):m}),x&&e.jsxs("p",{className:`text-sm ${a==="positive"?"text-green-600":"text-red-600"} mt-1`,children:[a==="positive"?"↗":"↘"," ",x]})]}),e.jsx("div",{className:`p-3 rounded-full ${j}`,children:c})]})}),y=({title:s,data:m,color:c,showRating:j=!1})=>{const x=Object.entries(m||{}).sort(([,a],[,i])=>{const v=typeof a=="object"?a.total||(a.good||0)+(a.bad||0):a,o=typeof i=="object"?i.total||(i.good||0)+(i.bad||0):i;return v-o}).reverse().slice(0,5);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsx("div",{className:"space-y-3",children:x.map(([a,i],v)=>{const o=typeof i=="object"?i.total||(i.good||0)+(i.bad||0):i,N=Math.max(...x.map(([,p])=>typeof p=="object"?p.total||(p.good||0)+(p.bad||0):p)),d=N>0?o/N*100:0,g=typeof i=="object"&&i.averageRating||0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${c} flex items-center justify-center text-white text-sm font-medium`,children:v+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.replace("session-","")}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:`h-2 rounded-full ${c}`,style:{width:`${d}%`}})})]})]}),e.jsxs("div",{className:"text-right ml-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Intl.NumberFormat().format(o)}),j&&g>0&&e.jsxs("div",{className:"flex items-center text-xs text-amber-600",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),g.toFixed(1)]})]})]},a)})})]})},A=({data:s})=>{const{t:m}=T(),c=Object.entries(s||{}),j=c.reduce((x,[,a])=>x+(typeof a=="object"?a.total||(a.good||0)+(a.bad||0):a),0);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:m("admin.usage.appUsageDistribution","App Usage Distribution")}),e.jsx("div",{className:"space-y-4",children:c.map(([x,a])=>{const i=typeof a=="object"?a.total||(a.good||0)+(a.bad||0):a,v=j>0?i/j*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:x.replace("-"," ")}),e.jsxs("span",{className:"text-sm text-gray-600",children:[v.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-300",style:{width:`${v}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[new Intl.NumberFormat().format(i)," uses"]})]},x)})})]})},G=({data:s})=>{const{t:m}=T(),c={...s.ratings||{}},j=s.good||0,x=s.bad||0;j>0&&(c[5]=(c[5]||0)+j),x>0&&(c[1]=(c[1]||0)+x);const a=Object.values(c).reduce((o,N)=>o+N,0),i=Object.entries(c).reduce((o,[N,d])=>o+parseInt(N)*d,0),v=a>0?i/a:0;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:m("admin.dashboard.feedbackOverview","Feedback Overview")}),a>0?e.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-3",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(o=>e.jsx("svg",{className:`w-6 h-6 ${o<=Math.round(v)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},o))}),e.jsx("span",{className:"text-2xl font-bold text-amber-600",children:v.toFixed(1)})]}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-sm text-amber-600 font-medium",children:["Average Rating (",a," ratings)"]})}),e.jsx("div",{className:"mt-4 space-y-2",children:[5,4,3,2,1].map(o=>{const N=c[o]||0,d=a>0?N/a*100:0;return e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("span",{className:"w-8 text-gray-600",children:[o,"★"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})}),e.jsx("span",{className:"w-8 text-gray-600 text-xs",children:N})]},o)})})]}):e.jsxs("div",{className:"text-center p-8 text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),e.jsx("div",{className:"text-lg font-medium mb-2",children:"No feedback available"}),e.jsx("div",{className:"text-sm",children:"No user ratings have been submitted yet."})]}),e.jsxs("div",{className:"text-center text-sm text-gray-600 mt-4",children:["Total feedback: ",a," responses"]})]})},se=()=>{const{t:s}=T(),[m,c]=w.useState(null),[j,x]=w.useState(!0),[a,i]=w.useState("overview"),v=async()=>{try{x(!0);const t=await E();c(t)}catch(t){console.error("Failed to load usage data",t)}finally{x(!1)}};w.useEffect(()=>{v()},[]);const o=()=>{if(!m)return;const t=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download="usage.json",l.click(),URL.revokeObjectURL(r)},N=()=>{if(!m)return;const{messages:t,tokens:r,feedback:l,magicPrompt:n}=m,k=[["Metric","Total","Description"],["Messages",t.total,"Total messages sent"],["Tokens",r.total,"Total tokens processed"],["Prompt Tokens",r.prompt.total,"Input tokens"],["Completion Tokens",r.completion.total,"Output tokens"],["Feedback Good",l.good,"Positive feedback count"],["Feedback Bad",l.bad,"Negative feedback count"],["Magic Prompt Uses",n.total,"Magic prompt invocations"],["Magic Prompt Input Tokens",n.tokensIn.total,"Magic prompt input tokens"],["Magic Prompt Output Tokens",n.tokensOut.total,"Magic prompt output tokens"]].map(B=>B.join(",")).join(`
`),P=new Blob([k],{type:"text/csv"}),M=URL.createObjectURL(P),U=document.createElement("a");U.href=M,U.download="usage-summary.csv",U.click(),URL.revokeObjectURL(M)};if(j)return e.jsx(S,{});if(!m)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:s("admin.usage.noDataTitle","No Data Available")}),e.jsx("p",{className:"text-gray-600",children:s("admin.usage.noDataDesc","Unable to load usage statistics.")})]})});const{messages:d,tokens:g,feedback:p,magicPrompt:u,lastUpdated:O,lastReset:F}=m,R=[{id:"overview",label:s("admin.usage.tabs.overview","Overview"),icon:e.jsx(b,{name:"chart",size:"md"})},{id:"users",label:s("admin.usage.tabs.users","Users"),icon:e.jsx(b,{name:"users",size:"md"})},{id:"apps",label:s("admin.usage.tabs.apps","Applications"),icon:e.jsx(b,{name:"settings",size:"md"})},{id:"magic",label:s("admin.usage.tabs.magic","Magic Prompt"),icon:e.jsx(b,{name:"sparkles",size:"md"})},{id:"feedback",label:s("admin.usage.tabs.feedback","Feedback"),icon:e.jsx(b,{name:"thumbs-up",size:"md"})},{id:"details",label:s("admin.usage.tabs.details","Details"),icon:e.jsx(b,{name:"chat",size:"md"})}],D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(f,{title:s("admin.usage.totalMessages","Total Messages"),value:d.total,icon:e.jsx(b,{name:"chat",size:"lg",className:"text-white"}),color:"bg-blue-500"}),e.jsx(f,{title:s("admin.usage.totalTokens","Total Tokens"),value:g.total,icon:e.jsx(b,{name:"document-text",size:"lg",className:"text-white"}),color:"bg-green-500"}),e.jsx(f,{title:s("admin.usage.magicPrompts","Magic Prompts"),value:u.total,icon:e.jsx(b,{name:"sparkles",size:"lg",className:"text-white"}),color:"bg-purple-500"}),e.jsx(f,{title:s("admin.usage.feedbackScore","Average Rating"),value:p.averageRating?`${p.averageRating.toFixed(1)} ★`:"N/A",icon:e.jsx(b,{name:"star",size:"lg",className:"text-white"}),color:"bg-amber-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.tokenDistribution","Token Distribution")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:s("admin.usage.promptTokens","Prompt Tokens")}),e.jsx("span",{className:"font-semibold",children:new Intl.NumberFormat().format(g.prompt.total)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-500 h-3 rounded-l-full",style:{width:`${g.prompt.total/g.total*100}%`}})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:s("admin.usage.completionTokens","Completion Tokens")}),e.jsx("span",{className:"font-semibold",children:new Intl.NumberFormat().format(g.completion.total)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-green-500 h-3 rounded-l-full",style:{width:`${g.completion.total/g.total*100}%`}})})]})]}),e.jsx(A,{data:d.perApp})]})]}),I=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(y,{title:s("admin.dashboard.topUsersByMessages","Top Users by Messages"),data:d.perUser,color:"bg-blue-500"}),e.jsx(y,{title:s("admin.dashboard.topUsersByTokens","Top Users by Tokens"),data:g.perUser,color:"bg-green-500"}),e.jsx(y,{title:s("admin.dashboard.topUsersByMagicPrompts","Top Users by Magic Prompts"),data:u.perUser,color:"bg-purple-500"}),e.jsx(y,{title:s("admin.dashboard.userFeedback","User Feedback"),data:p.perUser,color:"bg-amber-500",showRating:!0})]}),z=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(A,{data:d.perApp}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.appTokenUsage","App Token Usage")}),e.jsx("div",{className:"space-y-4",children:Object.entries(g.perApp||{}).map(([t,r])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium capitalize",children:t.replace("-"," ")}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:new Intl.NumberFormat().format(r)})]},t))})]})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(f,{title:s("admin.dashboard.totalInvocations","Total Invocations"),value:u.total,icon:e.jsx(b,{name:"sparkles",size:"lg",className:"text-white"}),color:"bg-purple-500"}),e.jsx(f,{title:s("admin.dashboard.inputTokens","Input Tokens"),value:u.tokensIn.total,icon:e.jsx(b,{name:"document-text",size:"lg",className:"text-white"}),color:"bg-blue-500"}),e.jsx(f,{title:s("admin.dashboard.outputTokens","Output Tokens"),value:u.tokensOut.total,icon:e.jsx(b,{name:"document-text",size:"lg",className:"text-white"}),color:"bg-green-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(y,{title:"Top Users by Magic Prompts",data:u.perUser,color:"bg-purple-500"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.sections.appUsage","App Usage")}),e.jsx("div",{className:"space-y-4",children:Object.entries(u.perApp||{}).map(([t,r])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("span",{className:"font-medium capitalize",children:t.replace("-"," ")}),e.jsx("span",{className:"text-lg font-bold text-purple-600",children:new Intl.NumberFormat().format(r)})]},t))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.sections.tokenEfficiency","Token Efficiency")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:s("admin.usage.sections.inputTokenDistribution","Input Token Distribution")}),e.jsx("div",{className:"space-y-3",children:Object.entries(u.tokensIn.perUser||{}).map(([t,r])=>{const l=Math.max(...Object.values(u.tokensIn.perUser||{})),n=l>0?r/l*100:0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 truncate",children:t.replace("session-","")}),e.jsx("span",{className:"font-medium",children:new Intl.NumberFormat().format(r)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]},t)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:s("admin.usage.sections.outputTokenDistribution","Output Token Distribution")}),e.jsx("div",{className:"space-y-3",children:Object.entries(u.tokensOut.perUser||{}).map(([t,r])=>{const l=Math.max(...Object.values(u.tokensOut.perUser||{})),n=l>0?r/l*100:0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 truncate",children:t.replace("session-","")}),e.jsx("span",{className:"font-medium",children:new Intl.NumberFormat().format(r)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]},t)})})]})]})]})]}),$=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(G,{data:p}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.sections.userFeedbackActivity","User Feedback Activity")}),e.jsx("div",{className:"space-y-4",children:Object.entries(p.perUser||{}).map(([t,r])=>{const l=r.total||0,n=r.averageRating||0;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900 truncate",children:t.replace("session-","")}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l," responses"]})]}),l>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(h=>e.jsx("svg",{className:`w-3 h-3 ${h<=Math.round(n)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},h))}),e.jsx("span",{className:"text-amber-600 font-medium",children:n.toFixed(1)})]})]},t)})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.sections.feedbackByApplication","Feedback by Application")}),e.jsx("div",{className:"space-y-4",children:Object.entries(p.perApp||{}).map(([t,r])=>{const l=r.total||0,n=r.averageRating||0;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:t.replace("-"," ")}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l," responses"]})]}),l>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(h=>e.jsx("svg",{className:`w-3 h-3 ${h<=Math.round(n)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},h))}),e.jsx("span",{className:"text-amber-600 font-medium",children:n.toFixed(1)})]})]},t)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.sections.feedbackByModel","Feedback by Model")}),e.jsx("div",{className:"space-y-4",children:Object.entries(p.perModel||{}).map(([t,r])=>{const l=r.total||0,n=r.averageRating||0;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l," responses"]})]}),l>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(h=>e.jsx("svg",{className:`w-3 h-3 ${h<=Math.round(n)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},h))}),e.jsx("span",{className:"text-amber-600 font-medium",children:n.toFixed(1)})]})]},t)})})]})]})]}),C=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Model Usage Details"}),e.jsx("div",{className:"space-y-4",children:Object.entries(d.perModel||{}).map(([t,r])=>{const l=g.perModel[t]||0,n=g.prompt.perModel[t]||0,h=g.completion.perModel[t]||0,k=r>0?Math.round(l/r):0;return e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:t}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI Model"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r}),e.jsx("div",{className:"text-sm text-gray-600",children:"messages"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:new Intl.NumberFormat().format(l)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Tokens"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:new Intl.NumberFormat().format(n)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Prompt Tokens"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:new Intl.NumberFormat().format(h)}),e.jsx("div",{className:"text-xs text-green-600",children:"Completion Tokens"})]}),e.jsxs("div",{className:"text-center p-3 bg-amber-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-amber-600",children:k}),e.jsx("div",{className:"text-xs text-amber-600",children:"Avg/Message"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Token Distribution"}),e.jsxs("span",{children:[l>0?(n/l*100).toFixed(1):0,"% prompt / ",l>0?(h/l*100).toFixed(1):0,"% completion"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsxs("div",{className:"h-full flex",children:[e.jsx("div",{className:"bg-blue-500",style:{width:l>0?`${n/l*100}%`:"0%"}}),e.jsx("div",{className:"bg-green-500",style:{width:l>0?`${h/l*100}%`:"0%"}})]})})]})]},t)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("admin.usage.overview.systemOverview","System Overview")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Object.keys(d.perUser||{}).length}),e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:s("admin.usage.overview.activeUsers","Active Users")})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Object.keys(d.perApp||{}).length}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:s("admin.usage.overview.activeApps","Active Apps")})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Object.keys(d.perModel||{}).length}),e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:s("admin.usage.overview.modelsUsed","Models Used")})]}),e.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:d.total>0?Math.round(g.total/d.total):0}),e.jsx("div",{className:"text-sm text-amber-600 font-medium",children:s("admin.usage.overview.avgTokensPerMsg","Avg Tokens/Msg")})]})]})]})]});return e.jsxs(J,{children:[e.jsx(V,{}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s("admin.usage.title","Admin Dashboard")}),e.jsx("p",{className:"text-gray-600 mt-1",children:s("admin.usage.subtitle","Usage analytics and system overview")})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:N,className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s("admin.usage.downloadCsv","Download CSV")}),e.jsx("button",{onClick:o,className:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s("admin.usage.downloadJson","Download JSON")})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("admin.usage.lastUpdated","Last Updated")}),e.jsx("div",{className:"text-sm font-medium",children:new Date(O).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("admin.usage.lastReset","Last Reset")}),e.jsx("div",{className:"text-sm font-medium",children:new Date(F).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("admin.usage.activeUsers","Active Users")}),e.jsx("div",{className:"text-sm font-medium",children:Object.keys(d.perUser||{}).length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:s("admin.usage.activeApps","Active Apps")}),e.jsx("div",{className:"text-sm font-medium",children:Object.keys(d.perApp||{}).length})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:R.map(t=>e.jsxs("button",{onClick:()=>i(t.id),className:`inline-flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${a===t.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.icon,e.jsx("span",{children:t.label})]},t.id))})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a==="overview"&&D(),a==="users"&&I(),a==="apps"&&z(),a==="magic"&&L(),a==="feedback"&&$(),a==="details"&&C()]})]})]})};export{se as default};
