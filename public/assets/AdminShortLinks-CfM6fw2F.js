import{u as I,j as e,I as r,h as z}from"./index-BImwYGvy.js";import{e as L,r as l}from"./vendor-react-9AdXaApd.js";import{A as J}from"./AdminAuth-DlQsuewr.js";import{A as q}from"./AdminNavigation-BmtWl3vA.js";import{m as A}from"./adminApi-ChCbw-zB.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";const G=({link:s,isOpen:f,onClose:x})=>{const{t:a}=I(),p=L();if(!f||!s)return null;const y=()=>{window.open(`/s/${s.code}`,"_blank")};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-indigo-100 flex items-center justify-center",children:e.jsx(r,{name:"link",className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.code}),e.jsxs("p",{className:"text-sm text-gray-500",children:["/s/",s.code]})]})]}),e.jsx("button",{onClick:x,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:e.jsx(r,{name:"x",className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.appId","App ID")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:s.appId})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.userId","User ID")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:s.userId||"-"})]}),s.url&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.url","Redirect URL")}),e.jsx("div",{className:"text-sm text-gray-900 break-all mt-1",children:s.url})]}),s.path&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.path","Path")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:s.path})]}),s.params&&Object.keys(s.params).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.params","Params")}),e.jsx("pre",{className:"text-sm text-gray-900 whitespace-pre-wrap break-all mt-1",children:JSON.stringify(s.params,null,2)})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.includeParams","Include Params")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:String(s.includeParams)})]}),s.expiresAt&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.expiresAt","Expires")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:new Date(s.expiresAt).toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("admin.shortlinks.usage","Usage")}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:s.usage||0})]})]})}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-between items-center rounded-b-lg",children:[e.jsxs("div",{className:"space-x-2",children:[e.jsxs("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(r,{name:"arrow-right",className:"w-4 h-4 mr-2"}),a("admin.shortlinks.test","Test")]}),e.jsxs("button",{onClick:()=>{p(`/admin/shortlinks/${s.code}`),x()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(r,{name:"pencil",className:"w-4 h-4 mr-2"}),a("admin.shortlinks.edit","Edit")]})]}),e.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:a("common.close","Close")})]})]})})},te=()=>{const{t:s}=I(),f=L(),{copyText:x}=z(),[a,p]=l.useState([]),[y,w]=l.useState(!0),[N,v]=l.useState(null),[g,D]=l.useState(""),[u,$]=l.useState(""),[E,U]=l.useState(null),[T,b]=l.useState(!1),[o,F]=l.useState("createdAt"),[i,k]=l.useState("desc"),[P,C]=l.useState(null),j=l.useCallback(async()=>{try{w(!0);const t=new URLSearchParams;g&&t.set("appId",g),u&&t.set("userId",u);const m=(await A(`/shortlinks?${t.toString()}`)).data;p(m)}catch(t){v(t.message)}finally{w(!1)}},[g,u]);l.useEffect(()=>{j()},[j]);const R=async t=>{if(window.confirm(s("admin.shortlinks.deleteConfirm","Delete this link?")))try{await A(`/shortlinks/${t}`,{method:"DELETE"}),p(n=>n.filter(m=>m.code!==t))}catch(n){v(n.message)}},M=t=>{U(t),b(!0)},h=t=>{o===t?k(n=>n==="asc"?"desc":"asc"):(F(t),k("asc"))},O=async t=>{const n=`${window.location.origin}/s/${t}`;(await x(n)).success&&(C(t),setTimeout(()=>C(null),2e3))},B=t=>{const n=`${window.location.origin}/s/${t}`;window.open(n,"_blank")},S=l.useMemo(()=>{const t=[...a],n=(m,_)=>{let d=m[o],c=_[o];return d==null&&(d=""),c==null&&(c=""),o==="usage"?i==="asc"?d-c:c-d:o==="createdAt"||o==="expiresAt"?(d=d?new Date(d).getTime():0,c=c?new Date(c).getTime():0,i==="asc"?d-c:c-d):i==="asc"?String(d).localeCompare(String(c)):String(c).localeCompare(String(d))};return t.sort(n)},[a,o,i]);return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):N?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(r,{name:"exclamation-triangle",className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:s("admin.shortlinks.loadError","Error loading short links")}),e.jsx("p",{className:"mt-1 text-sm text-red-700",children:N}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 text-sm text-red-600 hover:text-red-500",children:s("common.retry","Retry")})]})]})}):e.jsxs(J,{children:[e.jsxs("div",{children:[e.jsx(q,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:s("admin.shortlinks.title","Short Links Management")}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:s("admin.shortlinks.subtitle","Manage and monitor short links for your applications")})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:e.jsxs("button",{onClick:()=>f("/admin/shortlinks/new"),className:"inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:w-auto",children:[e.jsx(r,{name:"plus",className:"h-4 w-4 mr-2"}),s("admin.shortlinks.addNew","Add New Link")]})})]}),e.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",className:"block w-full px-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:s("admin.shortlinks.filterByAppId","Filter by App ID"),value:g,onChange:t=>D(t.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",className:"block w-full px-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:s("admin.shortlinks.filterByUser","Filter by User"),value:u,onChange:t=>$(t.target.value)})}),e.jsx("div",{className:"sm:w-32",children:e.jsx("button",{onClick:j,className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s("admin.shortlinks.filter","Filter")})})]}),e.jsx("div",{className:"mt-8 flex flex-col",children:e.jsx("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsxs("th",{scope:"col",onClick:()=>h("code"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[s("admin.shortlinks.code","Code"),o==="code"&&e.jsx(r,{name:"chevron-down",className:`inline w-3 h-3 ml-1 transform ${i==="asc"?"":"rotate-180"}`})]}),e.jsxs("th",{scope:"col",onClick:()=>h("appId"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[s("admin.shortlinks.appId","App ID"),o==="appId"&&e.jsx(r,{name:"chevron-down",className:`inline w-3 h-3 ml-1 transform ${i==="asc"?"":"rotate-180"}`})]}),e.jsxs("th",{scope:"col",onClick:()=>h("userId"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[s("admin.shortlinks.userId","User ID"),o==="userId"&&e.jsx(r,{name:"chevron-down",className:`inline w-3 h-3 ml-1 transform ${i==="asc"?"":"rotate-180"}`})]}),e.jsxs("th",{scope:"col",onClick:()=>h("usage"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[s("admin.shortlinks.usage","Usage"),o==="usage"&&e.jsx(r,{name:"chevron-down",className:`inline w-3 h-3 ml-1 transform ${i==="asc"?"":"rotate-180"}`})]}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("admin.shortlinks.createdAt","Created")}),e.jsxs("th",{scope:"col",onClick:()=>h("expiresAt"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[s("admin.shortlinks.expiresAt","Expires"),o==="expiresAt"&&e.jsx(r,{name:"chevron-down",className:`inline w-3 h-3 ml-1 transform ${i==="asc"?"":"rotate-180"}`})]}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:s("admin.shortlinks.actions","Actions")})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>M(t),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-8 w-8",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx(r,{name:"link",className:"h-4 w-4 text-indigo-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.code}),e.jsxs("div",{className:"text-sm text-gray-500",children:["/s/",t.code]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.appId})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.userId||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.usage||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.expiresAt?new Date(t.expiresAt).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:n=>n.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>O(t.code),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-full",title:s("admin.shortlinks.copyLink","Copy link"),children:P===t.code?e.jsx(r,{name:"check",className:"h-4 w-4 text-green-600"}):e.jsx(r,{name:"copy",className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(t.code),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full",title:s("admin.shortlinks.testLink","Test link"),children:e.jsx(r,{name:"external-link",className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(t.code),className:"p-2 text-red-600 hover:bg-red-50 rounded-full",title:s("admin.shortlinks.delete","Delete"),children:e.jsx(r,{name:"trash",className:"h-4 w-4"})})]})})]},t.code))})]})})})})}),S.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{name:"link",className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:s("admin.shortlinks.noLinks","No short links found")}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s("admin.shortlinks.noLinksDesc","Short links will appear here when created by users.")})]})]})]}),e.jsx(G,{link:E,isOpen:T,onClose:()=>b(!1)})]})};export{te as default};
