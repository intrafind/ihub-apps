import{u as c,j as e}from"./index-BImwYGvy.js";import{r as o}from"./vendor-react-9AdXaApd.js";import{B as d,E as l}from"./teams-CwMtNG0x.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./vendor-forms-DyVXvDXu.js";import"./vendor-ui-lZiltAcz.js";var a={};function N(){const{t:i}=c();o.useEffect(()=>{d(),l(t=>{const r=n(t);window.location.href=r})},[n]);const n=o.useCallback(t=>{const r=new URLSearchParams({client_id:a.REACT_APP_AAD_CLIENT_ID||t.clientId,response_type:"token",response_mode:"fragment",scope:"https://graph.microsoft.com/User.Read openid profile email",redirect_uri:`${window.location.origin}/teams/auth-end`,nonce:s(),state:m(),login_hint:t.loginHint||t.userPrincipalName,domain_hint:"organizations"});return`https://login.microsoftonline.com/${a.REACT_APP_AAD_TENANT_ID||t.tid||"common"}/oauth2/v2.0/authorize?${r.toString()}`},[]),s=()=>Math.random().toString(36).substring(2)+Date.now().toString(36),m=()=>Math.random().toString(36).substring(2)+Date.now().toString(36);return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:i("teams.auth.redirecting")})]})})}export{N as default};
