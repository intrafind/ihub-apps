import{u as fe,j as e,I as u,a as ve,L as we}from"./index-BImwYGvy.js";import{r as g}from"./vendor-react-9AdXaApd.js";import{A as ge}from"./AdminAuth-DlQsuewr.js";import{A as ye}from"./AdminNavigation-BmtWl3vA.js";import{D as Ae}from"./DualModeEditor-DudKIsvj.js";import{m as je}from"./adminApi-ChCbw-zB.js";import{g as ke}from"./schemaService-CVoZgOcb.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";import"./monaco-CCrBizaJ.js";const Ce=({value:t,onChange:n,onValidationChange:v})=>{var L,S,T,G,I,U,M,R,E,J,W,O,$,F,z,B,H,_,X,q,K,V,Q,Y,Z,ee,se,te,ae,re,le,de,oe,ne,ce,me,ie,ue,xe,he,pe,be;const{t:x}=fe(),[k,w]=g.useState({}),p=s=>{var l;const a={};(l=s.auth)!=null&&l.mode||(a["auth.mode"]="Authentication mode is required"),w(a);const r=Object.keys(a).length===0;return v&&v({isValid:r,errors:Object.entries(a).map(([i,A])=>({field:i,message:A,severity:"error"}))}),r};g.useEffect(()=>{t&&p(t)},[t]);const y=s=>{n({...t,auth:{...t.auth,mode:s}})},b=(s,a)=>{n({...t,[s]:{...t[s],enabled:a}})},d=(s,a,r)=>{n({...t,[s]:{...t[s],[a]:r}})},f=()=>{var a;const s={name:"",displayName:"",clientId:"",clientSecret:"",authorizationURL:"",tokenURL:"",userInfoURL:"",scope:["openid","profile","email"],callbackURL:"",groupsAttribute:"groups",defaultGroups:[],pkce:!0,enabled:!0};n({...t,oidcAuth:{...t.oidcAuth,providers:[...((a=t.oidcAuth)==null?void 0:a.providers)||[],s]}})},c=(s,a,r)=>{var i;const l=[...((i=t.oidcAuth)==null?void 0:i.providers)||[]];l[s]={...l[s],[a]:r},n({...t,oidcAuth:{...t.oidcAuth,providers:l}})},C=s=>{var r;const a=[...((r=t.oidcAuth)==null?void 0:r.providers)||[]];a.splice(s,1),n({...t,oidcAuth:{...t.oidcAuth,providers:a}})},D=()=>{var a;const s={name:"",header:"Authorization",issuer:"",audience:"",jwkUrl:""};n({...t,proxyAuth:{...t.proxyAuth,jwtProviders:[...((a=t.proxyAuth)==null?void 0:a.jwtProviders)||[],s]}})},j=(s,a,r)=>{var i;const l=[...((i=t.proxyAuth)==null?void 0:i.jwtProviders)||[]];l[s]={...l[s],[a]:r},n({...t,proxyAuth:{...t.proxyAuth,jwtProviders:l}})},P=s=>{var r;const a=[...((r=t.proxyAuth)==null?void 0:r.jwtProviders)||[]];a.splice(s,1),n({...t,proxyAuth:{...t.proxyAuth,jwtProviders:a}})},m=()=>{var a;const s={name:"",displayName:"",url:"",adminDn:"",adminPassword:"",userSearchBase:"",usernameAttribute:"uid",userDn:"",groupSearchBase:"",groupClass:"groupOfNames",defaultGroups:[],sessionTimeoutMinutes:480};n({...t,ldapAuth:{...t.ldapAuth,providers:[...((a=t.ldapAuth)==null?void 0:a.providers)||[],s]}})},o=(s,a,r)=>{var i;const l=[...((i=t.ldapAuth)==null?void 0:i.providers)||[]];l[s]={...l[s],[a]:r},n({...t,ldapAuth:{...t.ldapAuth,providers:l}})},N=s=>{var r;const a=[...((r=t.ldapAuth)==null?void 0:r.providers)||[]];a.splice(s,1),n({...t,ldapAuth:{...t.ldapAuth,providers:a}})},h=(s,a)=>{n({...t,authDebug:{...t.authDebug,[s]:a}})},Ne=(s,a,r)=>{var l,i,A;n({...t,authDebug:{...t.authDebug,providers:{...(l=t.authDebug)==null?void 0:l.providers,[s]:{...(A=(i=t.authDebug)==null?void 0:i.providers)==null?void 0:A[s],[a]:r}}}})};return t?e.jsxs("div",{className:"platform-form-editor space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Primary Authentication Mode"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select the primary authentication mode for default behavior and routing."}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{mode:"proxy",title:"Proxy Mode",desc:"Authentication via reverse proxy or JWT tokens"},{mode:"local",title:"Local Mode",desc:"Built-in username/password authentication"},{mode:"oidc",title:"OIDC Mode",desc:"OpenID Connect with external providers"},{mode:"ldap",title:"LDAP Mode",desc:"LDAP/Active Directory authentication"},{mode:"ntlm",title:"NTLM Mode",desc:"Windows Integrated Authentication (NTLM/Kerberos)"},{mode:"anonymous",title:"Anonymous Mode",desc:"No authentication required (default)"}].map(s=>{var a,r;return e.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-colors ${((a=t.auth)==null?void 0:a.mode)===s.mode?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>y(s.mode),children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"radio",checked:((r=t.auth)==null?void 0:r.mode)===s.mode,onChange:()=>y(s.mode),className:"mr-2"}),e.jsx("h4",{className:"font-medium text-gray-900",children:s.title})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.desc})]},s.mode)})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:x("admin.auth.methods","Authentication Methods")}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enable multiple authentication methods simultaneously. Users can choose their preferred login method."}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((L=t.proxyAuth)==null?void 0:L.enabled)||!1,onChange:s=>b("proxyAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Proxy/JWT Authentication"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Headers or JWT tokens from reverse proxy"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((S=t.localAuth)==null?void 0:S.enabled)||!1,onChange:s=>b("localAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Local Authentication"}),e.jsx("p",{className:"text-xs text-gray-500",children:x("admin.auth.builtInSystem","Built-in username/password system")})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((T=t.oidcAuth)==null?void 0:T.enabled)||!1,onChange:s=>b("oidcAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"OIDC Authentication"}),e.jsx("p",{className:"text-xs text-gray-500",children:"OpenID Connect providers (Google, etc.)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((G=t.ldapAuth)==null?void 0:G.enabled)||!1,onChange:s=>b("ldapAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"LDAP Authentication"}),e.jsx("p",{className:"text-xs text-gray-500",children:"LDAP/Active Directory authentication with multiple providers"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((I=t.ntlmAuth)==null?void 0:I.enabled)||!1,onChange:s=>b("ntlmAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"NTLM Authentication"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Windows Integrated Authentication (NTLM)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((U=t.anonymousAuth)==null?void 0:U.enabled)||!1,onChange:s=>b("anonymousAuth",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:x("admin.auth.anonymousAccess","Anonymous Access")}),e.jsx("p",{className:"text-xs text-gray-500",children:"Allow users to access without authentication"})]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:x("admin.auth.defaultGroups","Default Groups")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authenticated Groups"}),e.jsx("input",{type:"text",value:((M=t.auth)==null?void 0:M.authenticatedGroup)||"",onChange:s=>d("auth","authenticatedGroup",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"authenticated"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Group automatically assigned to all authenticated users"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Anonymous Groups"}),e.jsx("input",{type:"text",value:Array.isArray((R=t.anonymousAuth)==null?void 0:R.defaultGroups)?t.anonymousAuth.defaultGroups.join(", "):"",onChange:s=>d("anonymousAuth","defaultGroups",s.target.value.split(",").map(a=>a.trim()).filter(a=>a)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"anonymous, guest"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Groups assigned to users who access without authentication (comma-separated)"})]})]})]}),((E=t.proxyAuth)==null?void 0:E.enabled)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Proxy/JWT Authentication Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure header-based authentication from reverse proxy and/or JWT token validation for pure JWT authentication."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Header"}),e.jsx("input",{type:"text",value:((J=t.proxyAuth)==null?void 0:J.userHeader)||"",onChange:s=>d("proxyAuth","userHeader",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"X-Forwarded-User"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Groups Header"}),e.jsx("input",{type:"text",value:((W=t.proxyAuth)==null?void 0:W.groupsHeader)||"",onChange:s=>d("proxyAuth","groupsHeader",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"X-Forwarded-Groups"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((O=t.proxyAuth)==null?void 0:O.allowSelfSignup)||!1,onChange:s=>d("proxyAuth","allowSelfSignup",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Self-Signup"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Allow new users to register automatically through proxy authentication. If disabled, new users must be added manually by administrators."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:x("admin.auth.jwtProviders","JWT Providers")}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure JWT token validation for pure JWT authentication (no headers required)"})]}),e.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[e.jsx(u,{name:"plus",size:"sm",className:"mr-1"}),"Add Provider"]})]}),((($=t.proxyAuth)==null?void 0:$.jwtProviders)||[]).map((s,a)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-md mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("h5",{className:"font-medium text-gray-900",children:["JWT Provider ",a+1]}),e.jsx("button",{type:"button",onClick:()=>P(a),className:"text-red-600 hover:text-red-800",children:e.jsx(u,{name:"trash",size:"sm"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Provider name",value:s.name||"",onChange:r=>j(a,"name",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),e.jsx("input",{type:"text",placeholder:"Header name",value:s.header||"",onChange:r=>j(a,"header",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),e.jsx("input",{type:"text",placeholder:"Issuer URL",value:s.issuer||"",onChange:r=>j(a,"issuer",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),e.jsx("input",{type:"text",placeholder:"Audience",value:s.audience||"",onChange:r=>j(a,"audience",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),e.jsx("input",{type:"text",placeholder:"JWK URL",value:s.jwkUrl||"",onChange:r=>j(a,"jwkUrl",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm md:col-span-2"})]})]},a))]})]})]}),((F=t.localAuth)==null?void 0:F.enabled)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Local Authentication Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Users File Path"}),e.jsx("input",{type:"text",value:((z=t.localAuth)==null?void 0:z.usersFile)||"",onChange:s=>d("localAuth","usersFile",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"contents/config/users.json"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session Timeout (minutes)"}),e.jsx("input",{type:"number",value:((B=t.localAuth)==null?void 0:B.sessionTimeoutMinutes)||"",onChange:s=>d("localAuth","sessionTimeoutMinutes",parseInt(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"480"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"JWT Secret"}),e.jsx("input",{type:"text",value:((H=t.localAuth)==null?void 0:H.jwtSecret)||"",onChange:s=>d("localAuth","jwtSecret",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"${JWT_SECRET}"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Use environment variable $","{JWT_SECRET}"," for security"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((_=t.localAuth)==null?void 0:_.showDemoAccounts)||!1,onChange:s=>d("localAuth","showDemoAccounts",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Demo Accounts in Login Form"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Display demo account credentials on the login form for development/testing"})]})]})]}),((X=t.oidcAuth)==null?void 0:X.enabled)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"OIDC Authentication Settings"}),e.jsxs("button",{type:"button",onClick:f,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[e.jsx(u,{name:"plus",size:"sm",className:"mr-2"}),"Add OIDC Provider"]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((q=t.oidcAuth)==null?void 0:q.allowSelfSignup)||!1,onChange:s=>d("oidcAuth","allowSelfSignup",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Self-Signup"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Allow new users to register automatically through OIDC authentication. If disabled, new users must be added manually by administrators."})]}),!((K=t.oidcAuth)!=null&&K.providers)||t.oidcAuth.providers.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(u,{name:"key",size:"lg",className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:x("admin.auth.noOidcProviders","No OIDC providers configured")}),e.jsx("p",{className:"text-sm",children:x("admin.auth.addProvider","Add a provider to enable OIDC authentication")})]}):e.jsx("div",{className:"space-y-6",children:t.oidcAuth.providers.map((s,a)=>e.jsxs("div",{className:"p-6 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled!==!1,onChange:r=>c(a,"enabled",r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("h4",{className:"text-md font-medium text-gray-900",children:s.displayName||s.name||`Provider ${a+1}`}),s.enabled===!1&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:"Disabled"})]}),e.jsx("button",{type:"button",onClick:()=>C(a),className:"text-red-600 hover:text-red-800",children:e.jsx(u,{name:"trash",size:"sm"})})]}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-4 ${s.enabled===!1?"opacity-50 pointer-events-none":""}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider Name"}),e.jsx("input",{type:"text",placeholder:"google",value:s.name||"",onChange:r=>c(a,"name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",placeholder:"Google",value:s.displayName||"",onChange:r=>c(a,"displayName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID"}),e.jsx("input",{type:"text",placeholder:"${GOOGLE_CLIENT_ID}",value:s.clientId||"",onChange:r=>c(a,"clientId",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret"}),e.jsx("input",{type:"password",placeholder:"${GOOGLE_CLIENT_SECRET}",value:s.clientSecret||"",onChange:r=>c(a,"clientSecret",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authorization URL"}),e.jsx("input",{type:"url",placeholder:"https://accounts.google.com/o/oauth2/v2/auth",value:s.authorizationURL||"",onChange:r=>c(a,"authorizationURL",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Token URL"}),e.jsx("input",{type:"url",placeholder:"https://www.googleapis.com/oauth2/v4/token",value:s.tokenURL||"",onChange:r=>c(a,"tokenURL",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Info URL"}),e.jsx("input",{type:"url",placeholder:"https://www.googleapis.com/oauth2/v2/userinfo",value:s.userInfoURL||"",onChange:r=>c(a,"userInfoURL",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Groups Attribute"}),e.jsx("input",{type:"text",placeholder:"groups",value:s.groupsAttribute||"",onChange:r=>c(a,"groupsAttribute",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scope (comma-separated)"}),e.jsx("input",{type:"text",placeholder:"openid, profile, email",value:s.scope?s.scope.join(", "):"",onChange:r=>c(a,"scope",r.target.value.split(",").map(l=>l.trim())),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Groups (comma-separated)"}),e.jsx("input",{type:"text",placeholder:"google-users, external-users",value:s.defaultGroups?s.defaultGroups.join(", "):"",onChange:r=>c(a,"defaultGroups",r.target.value.split(",").map(l=>l.trim()).filter(l=>l)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.pkce!==!1,onChange:r=>c(a,"pkce",r.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable PKCE"})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.autoRedirect||!1,onChange:r=>c(a,"autoRedirect",r.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Auto-redirect"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically redirect users to this provider when it's the only auth method enabled"})]})]})]},a))})]}),((V=t.ldapAuth)==null?void 0:V.enabled)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"LDAP Authentication Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure LDAP/Active Directory authentication providers"})]}),e.jsxs("button",{type:"button",onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 text-sm font-medium",children:[e.jsx(u,{name:"plus",className:"h-4 w-4 inline-block mr-1"}),"Add LDAP Provider"]})]}),((Y=(Q=t.ldapAuth)==null?void 0:Q.providers)==null?void 0:Y.length)===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(u,{name:"server",className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No LDAP providers configured"}),e.jsx("p",{className:"text-sm mt-1",children:'Click "Add LDAP Provider" to get started'})]}),(ee=(Z=t.ldapAuth)==null?void 0:Z.providers)==null?void 0:ee.map((s,a)=>e.jsxs("div",{className:"mb-6 p-6 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("h4",{className:"text-md font-semibold text-gray-900",children:["LDAP Provider ",a+1,s.displayName&&`: ${s.displayName}`]})}),e.jsx("button",{type:"button",onClick:()=>N(a),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:e.jsx(u,{name:"trash",className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider Name"}),e.jsx("input",{type:"text",value:s.name||"",onChange:r=>o(a,"name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"corporate-ldap"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Internal identifier for this provider"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:s.displayName||"",onChange:r=>o(a,"displayName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Corporate LDAP"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"User-friendly name shown in login"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LDAP URL"}),e.jsx("input",{type:"text",value:s.url||"",onChange:r=>o(a,"url",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ldap://ldap.example.com:389"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"LDAP server URL (e.g., ldap://ldap.example.com:389 or ldaps://ldap.example.com:636)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin DN"}),e.jsx("input",{type:"text",value:s.adminDn||"",onChange:r=>o(a,"adminDn",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"cn=admin,dc=example,dc=org"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Admin Distinguished Name for binding"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Password"}),e.jsx("input",{type:"password",value:s.adminPassword||"",onChange:r=>o(a,"adminPassword",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"${LDAP_ADMIN_PASSWORD}"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password for admin DN (use env vars for security)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Search Base"}),e.jsx("input",{type:"text",value:s.userSearchBase||"",onChange:r=>o(a,"userSearchBase",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ou=people,dc=example,dc=org"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Base DN for user searches"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username Attribute"}),e.jsx("input",{type:"text",value:s.usernameAttribute||"uid",onChange:r=>o(a,"usernameAttribute",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"uid"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"LDAP attribute for username (uid or sAMAccountName)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User DN"}),e.jsx("input",{type:"text",value:s.userDn||"",onChange:r=>o(a,"userDn",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"uid={{username}},ou=people,dc=example,dc=org"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["User DN template (use ","{{username}}"," placeholder)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Search Base"}),e.jsx("input",{type:"text",value:s.groupSearchBase||"",onChange:r=>o(a,"groupSearchBase",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ou=groups,dc=example,dc=org"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Base DN for group searches"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Class"}),e.jsx("input",{type:"text",value:s.groupClass||"groupOfNames",onChange:r=>o(a,"groupClass",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"groupOfNames"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"LDAP group object class (groupOfNames or group for AD)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session Timeout (minutes)"}),e.jsx("input",{type:"number",value:s.sessionTimeoutMinutes||480,onChange:r=>o(a,"sessionTimeoutMinutes",parseInt(r.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"480"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JWT token expiration time"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Groups (comma-separated)"}),e.jsx("input",{type:"text",value:Array.isArray(s.defaultGroups)?s.defaultGroups.join(", "):"",onChange:r=>o(a,"defaultGroups",r.target.value.split(",").map(l=>l.trim()).filter(l=>l)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ldap-users, employees"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Groups automatically assigned to LDAP users"})]})]})]},a))]}),((se=t.ntlmAuth)==null?void 0:se.enabled)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"NTLM Authentication Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure Windows Integrated Authentication (NTLM) for domain users."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Domain Name"}),e.jsx("input",{type:"text",value:((te=t.ntlmAuth)==null?void 0:te.domain)||"",onChange:s=>d("ntlmAuth","domain",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"EXAMPLE"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Windows domain name (e.g., EXAMPLE, MUC)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Domain Controller URL"}),e.jsx("input",{type:"text",value:((ae=t.ntlmAuth)==null?void 0:ae.domainController)||"",onChange:s=>d("ntlmAuth","domainController",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ldap://dc.example.com:389"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"LDAP URL of domain controller (e.g., ldap://dc.example.com:389)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authentication Type"}),e.jsxs("select",{value:((re=t.ntlmAuth)==null?void 0:re.type)||"ntlm",onChange:s=>d("ntlmAuth","type",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"ntlm",children:"NTLM"}),e.jsx("option",{value:"negotiate",children:"Negotiate"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Protocol to use for Windows authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session Timeout (minutes)"}),e.jsx("input",{type:"number",value:((le=t.ntlmAuth)==null?void 0:le.sessionTimeoutMinutes)||480,onChange:s=>d("ntlmAuth","sessionTimeoutMinutes",parseInt(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"480"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JWT token expiration time"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Groups (comma-separated)"}),e.jsx("input",{type:"text",value:Array.isArray((de=t.ntlmAuth)==null?void 0:de.defaultGroups)?t.ntlmAuth.defaultGroups.join(", "):"",onChange:s=>d("ntlmAuth","defaultGroups",s.target.value.split(",").map(a=>a.trim()).filter(a=>a)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"ntlm-users, domain-users"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Groups automatically assigned to NTLM authenticated users"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((oe=t.ntlmAuth)==null?void 0:oe.debug)||!1,onChange:s=>d("ntlmAuth","debug",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Debug Logging"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Log detailed NTLM authentication information"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((ne=t.ntlmAuth)==null?void 0:ne.getUserInfo)!==!1,onChange:s=>d("ntlmAuth","getUserInfo",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Get User Info"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Retrieve additional user information from domain"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((ce=t.ntlmAuth)==null?void 0:ce.getGroups)!==!1,onChange:s=>d("ntlmAuth","getGroups",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Get Groups"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Retrieve user group memberships from domain"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((me=t.ntlmAuth)==null?void 0:me.generateJwtToken)!==!1,onChange:s=>d("ntlmAuth","generateJwtToken",s.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Generate JWT Token"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Generate JWT tokens for API access after NTLM authentication"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Debug Settings"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Enable detailed logging for authentication providers to troubleshoot issues.",e.jsx("span",{className:"text-amber-600 font-medium ml-1",children:"Warning: This may log sensitive information."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:((ie=t.authDebug)==null?void 0:ie.enabled)||!1,onChange:s=>h("enabled",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Enable Authentication Debug Logging"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Log authentication events, token exchanges, and user information for troubleshooting"})]})]}),((ue=t.authDebug)==null?void 0:ue.enabled)&&e.jsxs("div",{className:"ml-6 space-y-4 pl-4 border-l-2 border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((xe=t.authDebug)==null?void 0:xe.maskTokens)!==!1,onChange:s=>h("maskTokens",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mask Tokens"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Hide sensitive parts of access tokens and secrets"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((he=t.authDebug)==null?void 0:he.redactPasswords)!==!1,onChange:s=>h("redactPasswords",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Redact Passwords"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Remove passwords and credentials from logs"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((pe=t.authDebug)==null?void 0:pe.consoleLogging)||!1,onChange:s=>h("consoleLogging",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Console Logging"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Also output debug logs to console"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((be=t.authDebug)==null?void 0:be.includeRawData)||!1,onChange:s=>h("includeRawData",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Include Raw Data"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Include unsanitized raw data (security risk)"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Provider Settings"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:["oidc","local","proxy","ldap","ntlm"].map(s=>{var a,r,l;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`debug-${s}`,checked:((l=(r=(a=t.authDebug)==null?void 0:a.providers)==null?void 0:r[s])==null?void 0:l.enabled)!==!1,onChange:i=>Ne(s,"enabled",i.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:`debug-${s}`,className:"text-sm text-gray-700",children:s.toUpperCase()})]},s)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Enable debug logging per authentication provider"})]})]})]})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(u,{name:"exclamation-triangle",className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium",children:x("admin.auth.noConfigData","No configuration data available")})]})},Oe=()=>{const{t}=fe(),{refreshConfig:n}=ve(),[v,x]=g.useState(!0),[k,w]=g.useState(!1),[p,y]=g.useState(""),[b,d]=g.useState(null),[f,c]=g.useState({auth:{mode:"proxy",authenticatedGroup:"authenticated"},anonymousAuth:{enabled:!0,defaultGroups:["anonymous"]},proxyAuth:{enabled:!1,allowSelfSignup:!1,userHeader:"X-Forwarded-User",groupsHeader:"X-Forwarded-Groups",jwtProviders:[]},localAuth:{enabled:!1,usersFile:"contents/config/users.json",sessionTimeoutMinutes:480,jwtSecret:"${JWT_SECRET}",showDemoAccounts:!1},oidcAuth:{enabled:!1,allowSelfSignup:!1,providers:[]},ntlmAuth:{enabled:!1,domain:"",domainController:"",type:"ntlm",debug:!1,getUserInfo:!0,getGroups:!0,defaultGroups:[],sessionTimeoutMinutes:480,generateJwtToken:!0},authDebug:{enabled:!1,maskTokens:!0,redactPasswords:!0,consoleLogging:!1,includeRawData:!1,providers:{oidc:{enabled:!0},local:{enabled:!0},proxy:{enabled:!0},ldap:{enabled:!0},ntlm:{enabled:!0}}}});g.useEffect(()=>{D(),C()},[]);const C=async()=>{try{const m=await ke("platform");d(m)}catch(m){console.error("Failed to load platform schema:",m)}},D=async()=>{try{const o=(await je("/admin/configs/platform")).data;c(N=>({...N,...o}))}catch(m){y({type:"error",text:`Failed to load configuration: ${m.message}`})}finally{x(!1)}},j=async m=>{m||(m=f),w(!0),y("");try{await je("/admin/configs/platform",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),y({type:"success",text:"Authentication configuration saved successfully!"}),n()}catch(o){throw y({type:"error",text:`Failed to save configuration: ${o.message}`}),o}finally{w(!1)}},P=m=>{c(m)};return v?e.jsxs(ge,{children:[e.jsx(ye,{}),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(we,{size:"lg"})})]}):e.jsxs(ge,{children:[e.jsx(ye,{}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t("admin.auth.configuration","Authentication Configuration")}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure multiple authentication methods and user access settings. Enable dual authentication for maximum flexibility."})]}),e.jsxs("button",{type:"button",onClick:()=>{const m=JSON.stringify(f,null,2),o="data:application/json;charset=utf-8,"+encodeURIComponent(m),N="platform-config.json",h=document.createElement("a");h.setAttribute("href",o),h.setAttribute("download",N),h.click()},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(u,{name:"download",className:"h-4 w-4 mr-2"}),t("common.download")]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[p&&e.jsx("div",{className:`mb-6 p-4 rounded-md ${p.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx(u,{name:p.type==="success"?"check":"warning",size:"md",className:`mt-0.5 mr-3 ${p.type==="success"?"text-green-500":"text-red-500"}`}),e.jsx("p",{className:`text-sm ${p.type==="success"?"text-green-700":"text-red-700"}`,children:p.text})]})}),e.jsx(Ae,{value:f,onChange:P,formComponent:Ce,jsonSchema:b,title:t("admin.auth.configuration","Authentication Configuration")}),e.jsx("div",{className:"flex justify-end space-x-4 mt-8",children:e.jsx("button",{type:"button",onClick:()=>j(),disabled:k,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),t("admin.auth.saving","Saving...")]}):t("admin.auth.save","Save Configuration")})})]})]})]})};export{Oe as default};
