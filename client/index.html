<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <script>
      // Dynamically set base tag for proper asset loading when deployed at subpath
      // This logic is aligned with client/src/utils/runtimeBasePath.js
      (function () {
        // Get the current pathname
        const pathname = window.location.pathname;

        // Find the base path by looking for where index.html is served
        // Remove any trailing /index.html or just trailing slash
        let basePath = pathname.replace(/\/index\.html$/, '').replace(/\/$/, '');

        // Known React routes - these are app routes, not deployment subpaths
        // IMPORTANT: Keep in sync with runtimeBasePath.js
        const knownRoutes = [
          'apps',
          'admin',
          'auth',
          'login',
          'chat',
          'pages',
          'prompts',
          'settings',
          'teams',
          's'
        ];

        // Split path into segments and find the first known route
        // This correctly handles paths like /admin/apps (route 'admin' at segment 0)
        // vs /ihub/admin/apps (route 'admin' at segment 1, base path is '/ihub')
        const segments = basePath.split('/').filter(function(s) { return s !== ''; });
        let routeSegmentIndex = -1;

        for (var i = 0; i < segments.length; i++) {
          if (knownRoutes.indexOf(segments[i]) !== -1) {
            routeSegmentIndex = i;
            break;
          }
        }

        // Determine base path from segment analysis
        if (routeSegmentIndex === 0) {
          // Route is at root (e.g., /admin/apps) - no subpath deployment
          basePath = '';
        } else if (routeSegmentIndex > 0) {
          // Route found after subpath (e.g., /ihub/admin/apps) - base is /ihub
          basePath = '/' + segments.slice(0, routeSegmentIndex).join('/');
        }
        // If no route found, basePath remains as-is (unusual case)

        // Add base tag to ensure proper asset loading
        const base = document.createElement('base');
        base.href = basePath === '' ? '/' : basePath + '/';
        document.head.appendChild(base);

        // Store for debugging (same as runtimeBasePath.js)
        window.__BASE_PATH__ = basePath;
      })();
    </script>
    <link rel="icon" type="image/svg+xml" href="./favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A platform for AI-powered applications" />
    <title>iHub Apps</title>
    <!-- Import local font -->
    <link rel="stylesheet" href="./fonts/Inter Web/inter.css" />
    <style>
      /* Fallback font settings */
      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Roboto,
          Oxygen,
          Ubuntu,
          Cantarell,
          'Open Sans',
          'Helvetica Neue',
          sans-serif;
      }
      /* Support for variable fonts if available */
      @supports (font-variation-settings: normal) {
        body {
          font-family: 'Inter var', sans-serif;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="./src/index.jsx"></script>
  </body>
</html>
