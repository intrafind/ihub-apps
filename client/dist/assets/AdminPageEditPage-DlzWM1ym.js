import{u as j,j as e}from"./index-CdJiYb_a.js";import{u as v,e as N,r}from"./vendor-react-9AdXaApd.js";import{A as k}from"./AdminAuth-w86Ms2_j.js";import{A as q}from"./AdminNavigation-CghX6zwW.js";import{D as f}from"./DynamicLanguageEditor-DFv1lM-q.js";import{e as T,g as C,u as R}from"./adminApi-DCK2UDnY.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";const M=()=>{const{t:s}=j(),{pageId:o}=v(),m=N(),d=o==="new",[n,i]=r.useState({id:"",title:{en:""},content:{en:""},authRequired:!1,allowedGroups:"*",contentType:"markdown"}),[y,c]=r.useState(!d),[u,p]=r.useState(!1),[g,x]=r.useState(null);r.useEffect(()=>{d?c(!1):b()},[o,d]);const b=r.useCallback(async()=>{try{c(!0);const t=await T(o);i({id:t.id,title:t.title||{en:""},content:t.content||{en:""},authRequired:t.authRequired||!1,allowedGroups:Array.isArray(t.allowedGroups)&&t.allowedGroups.length>0?t.allowedGroups.join(","):"*",contentType:t.contentType||"markdown"})}catch(t){x(t.message)}finally{c(!1)}},[o]),w=async t=>{if(t.preventDefault(),!n.id){alert(s("admin.pages.fields.idRequired","ID is required"));return}const a=n.allowedGroups.trim(),h={...n,allowedGroups:a===""||a==="*"?"*":a.split(",").map(l=>l.trim()).filter(l=>l.length>0)};try{p(!0),d?await C(h):await R(o,h),m("/admin/pages")}catch(l){x(l.message)}finally{p(!1)}};return y?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsxs(k,{children:[e.jsx(q,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("admin.pages.fields.id","Page ID")}),e.jsx("input",{type:"text",value:n.id,onChange:t=>i(a=>({...a,id:t.target.value})),disabled:!d,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsx(f,{label:s("admin.pages.fields.title","Title"),value:n.title,onChange:t=>i(a=>({...a,title:t})),required:!0}),e.jsx(f,{label:s("admin.pages.fields.content","Content"),value:n.content,onChange:t=>i(a=>({...a,content:t})),type:"textarea",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("admin.pages.fields.contentType","Content Type")}),e.jsxs("select",{value:n.contentType,onChange:t=>i(a=>({...a,contentType:t.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"markdown",children:s("admin.pages.contentTypes.markdown","Markdown (.md)")}),e.jsx("option",{value:"react",children:s("admin.pages.contentTypes.reactComponent","React Component (.jsx)")})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:n.contentType==="react"?s("admin.pages.contentTypes.jsxDescription","Write JSX code that will be compiled and rendered as a React component"):s("admin.pages.contentTypes.markdownDescription","Write standard markdown content with syntax highlighting support")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"authRequired",type:"checkbox",checked:n.authRequired,onChange:t=>i(a=>({...a,authRequired:t.target.checked})),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"authRequired",className:"ml-2 block text-sm text-gray-700",children:s("admin.pages.fields.authRequired","Authentication Required")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("admin.pages.fields.allowedGroups","Allowed Groups")}),e.jsx("input",{type:"text",value:n.allowedGroups,onChange:t=>i(a=>({...a,allowedGroups:t.target.value})),placeholder:"admin, user or *",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),g&&e.jsx("div",{className:"text-red-600 text-sm",children:g}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>m("/admin/pages"),className:"px-4 py-2 rounded-md bg-gray-200",children:s("common.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 rounded-md bg-indigo-600 text-white",children:u?s("common.saving","Saving..."):s("common.save","Save")})]})]})})]})};export{M as default};
