import{u as $,j as e,L as z,I as n}from"./index-CdJiYb_a.js";import{e as E,r as l}from"./vendor-react-9AdXaApd.js";import{A as y}from"./AdminAuth-w86Ms2_j.js";import{A as f}from"./AdminNavigation-CghX6zwW.js";import{m as N}from"./adminApi-DCK2UDnY.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";const R=()=>{const{t}=$(),o=E(),[b,v]=l.useState(!0),[w,A]=l.useState({}),[a,d]=l.useState("");l.useEffect(()=>{p()},[]);const p=async()=>{try{const r=(await N("/admin/groups")).data;A(r.groups||{})}catch(s){d({type:"error",text:`Failed to load groups: ${s.message}`})}finally{v(!1)}},G=async(s,r)=>{if(window.confirm(`Are you sure you want to delete the group "${r}"?`))try{await N(`/admin/groups/${s}`,{method:"DELETE"}),d({type:"success",text:"Group deleted successfully!"}),p()}catch(i){d({type:"error",text:`Failed to delete group: ${i.message}`})}},k=s=>["admin","user","anonymous","authenticated"].includes(s);if(b)return e.jsxs(y,{children:[e.jsx(f,{}),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(z,{size:"lg"})})]});const c=Object.values(w);return e.jsxs(y,{children:[e.jsx(f,{}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t("admin.groups.management","Group Management")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("admin.groups.subtitle","Manage user groups, permissions, and external group mappings")})]}),e.jsxs("button",{onClick:()=>o("/admin/groups/new"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(n,{name:"plus",size:"md",className:"mr-2"}),"Add Group"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a&&e.jsx("div",{className:`mb-6 p-4 rounded-md ${a.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{name:a.type==="success"?"check":"warning",size:"md",className:`mt-0.5 mr-3 ${a.type==="success"?"text-green-500":"text-red-500"}`}),e.jsx("p",{className:`text-sm ${a.type==="success"?"text-green-700":"text-red-700"}`,children:a.text})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Groups (",c.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Group"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permissions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"External Mappings"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:[e.jsx(n,{name:"users",size:"lg",className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:t("admin.groups.noGroupsFound","No groups found")}),e.jsx("p",{className:"text-sm",children:t("admin.groups.createFirstGroup","Create your first group to get started")})]})}):c.map(s=>{var r,i,u,g,h,j;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(n,{name:"users",size:"md",className:"text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.description}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",s.id]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:t("admin.groups.apps","Apps:")}),(i=(r=s.permissions)==null?void 0:r.apps)!=null&&i.includes("*")?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"All Apps (*)"}):e.jsxs(e.Fragment,{children:[(((u=s.permissions)==null?void 0:u.apps)||[]).slice(0,3).map((x,m)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:x},m)),(((g=s.permissions)==null?void 0:g.apps)||[]).length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",(((h=s.permissions)==null?void 0:h.apps)||[]).length-3," more"]})]})]}),((j=s.permissions)==null?void 0:j.adminAccess)&&e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Admin Access"})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(s.mappings||[]).map((x,m)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:x},m)),(!s.mappings||s.mappings.length===0)&&e.jsx("span",{className:"text-sm text-gray-400",children:t("admin.groups.noMappings","No mappings")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>o(`/admin/groups/${s.id}`),className:"text-blue-600 hover:text-blue-900",children:e.jsx(n,{name:"edit",size:"sm"})}),!k(s.id)&&e.jsx("button",{onClick:()=>G(s.id,s.name),className:"text-red-600 hover:text-red-900",children:e.jsx(n,{name:"trash",size:"sm"})})]})})]},s.id)})})]})})]})]})]})]})};export{R as default};
