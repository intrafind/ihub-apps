import{u as N,j as e}from"./index-CdJiYb_a.js";import{u as w,e as S,r as i}from"./vendor-react-9AdXaApd.js";import{A}from"./AdminNavigation-CghX6zwW.js";import{A as C}from"./AdminAuth-w86Ms2_j.js";import{m as f}from"./adminApi-DCK2UDnY.js";import"./mermaid-DechTdnA.js";import"./vendor-utils-CF1RCcgi.js";import"./teams-CwMtNG0x.js";import"./vendor-ui-lZiltAcz.js";import"./vendor-forms-DyVXvDXu.js";const $=()=>{const{code:o}=w(),u=S(),{t:a}=N(),n=o==="new",[t,x]=i.useState({code:"",appId:"",userId:"",path:"",url:"",includeParams:!1,params:{},expiresAt:""}),[m,h]=i.useState("{}"),[y,v]=i.useState(!n),[p,g]=i.useState(!1),[b,c]=i.useState(null);i.useEffect(()=>{n||(async()=>{try{const r=(await f(`/shortlinks/${o}`)).data;x({...r,params:r.params||{},expiresAt:r.expiresAt||""}),h(JSON.stringify(r.params||{},null,2))}catch(s){c(s.message)}finally{v(!1)}})()},[o,n]);const l=(s,r)=>{x(d=>({...d,[s]:r}))},k=async s=>{s.preventDefault();let r={};if(m.trim())try{r=JSON.parse(m)}catch{c(a("admin.shortlinks.invalidParams","Invalid params JSON"));return}g(!0);try{const d=n?"POST":"PUT",j=n?"/shortlinks":`/shortlinks/${o}`;await f(j,{method:d,body:JSON.stringify({...t,params:r,expiresAt:t.expiresAt?new Date(t.expiresAt).toISOString():null})}),u("/admin/shortlinks")}catch(d){c(d.message)}finally{g(!1)}};return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsx(C,{children:e.jsxs("div",{children:[e.jsx(A,{}),e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:n?a("admin.shortlinks.new","Create Short Link"):a("admin.shortlinks.edit","Edit Short Link")}),b&&e.jsx("div",{className:"text-red-600",children:b}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.code","Code")}),e.jsx("input",{type:"text",value:t.code,onChange:s=>l("code",s.target.value),disabled:!n,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.appId","App ID")}),e.jsx("input",{type:"text",value:t.appId,onChange:s=>l("appId",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.userId","User ID")}),e.jsx("input",{type:"text",value:t.userId,onChange:s=>l("userId",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.path","Path")}),e.jsx("input",{type:"text",value:t.path||"",onChange:s=>l("path",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.url","Redirect URL")}),e.jsx("input",{type:"text",value:t.url||"",onChange:s=>l("url",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.includeParams,onChange:s=>l("includeParams",s.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:a("admin.shortlinks.includeParams","Include Params")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.expiresAt","Expires At")}),e.jsx("input",{type:"datetime-local",value:t.expiresAt?t.expiresAt.substring(0,16):"",onChange:s=>l("expiresAt",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("admin.shortlinks.params","Params (JSON)")}),e.jsx("textarea",{rows:"4",value:m,onChange:s=>h(s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm font-mono"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>u("/admin/shortlinks"),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:a("common.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:p,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:p?a("common.saving","Saving..."):a("common.save","Save")})]})]})]})]})})};export{$ as default};
