import{r as Yt}from"./vendor-ui-lZiltAcz.js";var _t={},Ot={},gr={},Mt={},Y={},na={},Dt={},ia={},mr={},Uo={},Xp;function wg(){if(Xp)return Uo;Xp=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.default=r;let e;const t=new Uint8Array(16);function r(){if(!e&&(e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}return Uo}var ir={},Sr={},Cr={},ed;function Gy(){if(ed)return Cr;ed=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.default=void 0;var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return Cr.default=e,Cr}var td;function Ps(){if(td)return Sr;td=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.default=void 0;var e=t(Gy());function t(n){return n&&n.__esModule?n:{default:n}}function r(n){return typeof n=="string"&&e.default.test(n)}var i=r;return Sr.default=i,Sr}var rd;function ws(){if(rd)return ir;rd=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.default=void 0,ir.unsafeStringify=i;var e=t(Ps());function t(a){return a&&a.__esModule?a:{default:a}}const r=[];for(let a=0;a<256;++a)r.push((a+256).toString(16).slice(1));function i(a,o=0){return r[a[o+0]]+r[a[o+1]]+r[a[o+2]]+r[a[o+3]]+"-"+r[a[o+4]]+r[a[o+5]]+"-"+r[a[o+6]]+r[a[o+7]]+"-"+r[a[o+8]]+r[a[o+9]]+"-"+r[a[o+10]]+r[a[o+11]]+r[a[o+12]]+r[a[o+13]]+r[a[o+14]]+r[a[o+15]]}function n(a,o=0){const c=i(a,o);if(!(0,e.default)(c))throw TypeError("Stringified UUID is invalid");return c}var s=n;return ir.default=s,ir}var nd;function Jy(){if(nd)return mr;nd=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.default=void 0;var e=r(wg()),t=ws();function r(u){return u&&u.__esModule?u:{default:u}}let i,n,s=0,a=0;function o(u,p,d){let h=p&&d||0;const l=p||new Array(16);u=u||{};let f=u.node||i,m=u.clockseq!==void 0?u.clockseq:n;if(f==null||m==null){const I=u.random||(u.rng||e.default)();f==null&&(f=i=[I[0]|1,I[1],I[2],I[3],I[4],I[5]]),m==null&&(m=n=(I[6]<<8|I[7])&16383)}let P=u.msecs!==void 0?u.msecs:Date.now(),g=u.nsecs!==void 0?u.nsecs:a+1;const w=P-s+(g-a)/1e4;if(w<0&&u.clockseq===void 0&&(m=m+1&16383),(w<0||P>s)&&u.nsecs===void 0&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=P,a=g,n=m,P+=122192928e5;const R=((P&268435455)*1e4+g)%4294967296;l[h++]=R>>>24&255,l[h++]=R>>>16&255,l[h++]=R>>>8&255,l[h++]=R&255;const A=P/4294967296*1e4&268435455;l[h++]=A>>>8&255,l[h++]=A&255,l[h++]=A>>>24&15|16,l[h++]=A>>>16&255,l[h++]=m>>>8|128,l[h++]=m&255;for(let I=0;I<6;++I)l[h+I]=f[I];return p||(0,t.unsafeStringify)(l)}var c=o;return mr.default=c,mr}var yr={},dt={},Pr={},id;function Rg(){if(id)return Pr;id=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.default=void 0;var e=t(Ps());function t(n){return n&&n.__esModule?n:{default:n}}function r(n){if(!(0,e.default)(n))throw TypeError("Invalid UUID");let s;const a=new Uint8Array(16);return a[0]=(s=parseInt(n.slice(0,8),16))>>>24,a[1]=s>>>16&255,a[2]=s>>>8&255,a[3]=s&255,a[4]=(s=parseInt(n.slice(9,13),16))>>>8,a[5]=s&255,a[6]=(s=parseInt(n.slice(14,18),16))>>>8,a[7]=s&255,a[8]=(s=parseInt(n.slice(19,23),16))>>>8,a[9]=s&255,a[10]=(s=parseInt(n.slice(24,36),16))/1099511627776&255,a[11]=s/4294967296&255,a[12]=s>>>24&255,a[13]=s>>>16&255,a[14]=s>>>8&255,a[15]=s&255,a}var i=r;return Pr.default=i,Pr}var od;function Eg(){if(od)return dt;od=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.URL=dt.DNS=void 0,dt.default=a;var e=ws(),t=r(Rg());function r(o){return o&&o.__esModule?o:{default:o}}function i(o){o=unescape(encodeURIComponent(o));const c=[];for(let u=0;u<o.length;++u)c.push(o.charCodeAt(u));return c}const n="6ba7b810-9dad-11d1-80b4-00c04fd430c8";dt.DNS=n;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";dt.URL=s;function a(o,c,u){function p(d,h,l,f){var m;if(typeof d=="string"&&(d=i(d)),typeof h=="string"&&(h=(0,t.default)(h)),((m=h)===null||m===void 0?void 0:m.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let P=new Uint8Array(16+d.length);if(P.set(h),P.set(d,h.length),P=u(P),P[6]=P[6]&15|c,P[8]=P[8]&63|128,l){f=f||0;for(let g=0;g<16;++g)l[f+g]=P[g];return l}return(0,e.unsafeStringify)(P)}try{p.name=o}catch{}return p.DNS=n,p.URL=s,p}return dt}var wr={},sd;function Qy(){if(sd)return wr;sd=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.default=void 0;function e(l){if(typeof l=="string"){const f=unescape(encodeURIComponent(l));l=new Uint8Array(f.length);for(let m=0;m<f.length;++m)l[m]=f.charCodeAt(m)}return t(i(n(l),l.length*8))}function t(l){const f=[],m=l.length*32,P="0123456789abcdef";for(let g=0;g<m;g+=8){const w=l[g>>5]>>>g%32&255,R=parseInt(P.charAt(w>>>4&15)+P.charAt(w&15),16);f.push(R)}return f}function r(l){return(l+64>>>9<<4)+14+1}function i(l,f){l[f>>5]|=128<<f%32,l[r(f)-1]=f;let m=1732584193,P=-271733879,g=-1732584194,w=271733878;for(let R=0;R<l.length;R+=16){const A=m,I=P,D=g,q=w;m=c(m,P,g,w,l[R],7,-680876936),w=c(w,m,P,g,l[R+1],12,-389564586),g=c(g,w,m,P,l[R+2],17,606105819),P=c(P,g,w,m,l[R+3],22,-1044525330),m=c(m,P,g,w,l[R+4],7,-176418897),w=c(w,m,P,g,l[R+5],12,1200080426),g=c(g,w,m,P,l[R+6],17,-1473231341),P=c(P,g,w,m,l[R+7],22,-45705983),m=c(m,P,g,w,l[R+8],7,1770035416),w=c(w,m,P,g,l[R+9],12,-1958414417),g=c(g,w,m,P,l[R+10],17,-42063),P=c(P,g,w,m,l[R+11],22,-1990404162),m=c(m,P,g,w,l[R+12],7,1804603682),w=c(w,m,P,g,l[R+13],12,-40341101),g=c(g,w,m,P,l[R+14],17,-1502002290),P=c(P,g,w,m,l[R+15],22,1236535329),m=u(m,P,g,w,l[R+1],5,-165796510),w=u(w,m,P,g,l[R+6],9,-1069501632),g=u(g,w,m,P,l[R+11],14,643717713),P=u(P,g,w,m,l[R],20,-373897302),m=u(m,P,g,w,l[R+5],5,-701558691),w=u(w,m,P,g,l[R+10],9,38016083),g=u(g,w,m,P,l[R+15],14,-660478335),P=u(P,g,w,m,l[R+4],20,-405537848),m=u(m,P,g,w,l[R+9],5,568446438),w=u(w,m,P,g,l[R+14],9,-1019803690),g=u(g,w,m,P,l[R+3],14,-187363961),P=u(P,g,w,m,l[R+8],20,1163531501),m=u(m,P,g,w,l[R+13],5,-1444681467),w=u(w,m,P,g,l[R+2],9,-51403784),g=u(g,w,m,P,l[R+7],14,1735328473),P=u(P,g,w,m,l[R+12],20,-1926607734),m=p(m,P,g,w,l[R+5],4,-378558),w=p(w,m,P,g,l[R+8],11,-2022574463),g=p(g,w,m,P,l[R+11],16,1839030562),P=p(P,g,w,m,l[R+14],23,-35309556),m=p(m,P,g,w,l[R+1],4,-1530992060),w=p(w,m,P,g,l[R+4],11,1272893353),g=p(g,w,m,P,l[R+7],16,-155497632),P=p(P,g,w,m,l[R+10],23,-1094730640),m=p(m,P,g,w,l[R+13],4,681279174),w=p(w,m,P,g,l[R],11,-358537222),g=p(g,w,m,P,l[R+3],16,-722521979),P=p(P,g,w,m,l[R+6],23,76029189),m=p(m,P,g,w,l[R+9],4,-640364487),w=p(w,m,P,g,l[R+12],11,-421815835),g=p(g,w,m,P,l[R+15],16,530742520),P=p(P,g,w,m,l[R+2],23,-995338651),m=d(m,P,g,w,l[R],6,-198630844),w=d(w,m,P,g,l[R+7],10,1126891415),g=d(g,w,m,P,l[R+14],15,-1416354905),P=d(P,g,w,m,l[R+5],21,-57434055),m=d(m,P,g,w,l[R+12],6,1700485571),w=d(w,m,P,g,l[R+3],10,-1894986606),g=d(g,w,m,P,l[R+10],15,-1051523),P=d(P,g,w,m,l[R+1],21,-2054922799),m=d(m,P,g,w,l[R+8],6,1873313359),w=d(w,m,P,g,l[R+15],10,-30611744),g=d(g,w,m,P,l[R+6],15,-1560198380),P=d(P,g,w,m,l[R+13],21,1309151649),m=d(m,P,g,w,l[R+4],6,-145523070),w=d(w,m,P,g,l[R+11],10,-1120210379),g=d(g,w,m,P,l[R+2],15,718787259),P=d(P,g,w,m,l[R+9],21,-343485551),m=s(m,A),P=s(P,I),g=s(g,D),w=s(w,q)}return[m,P,g,w]}function n(l){if(l.length===0)return[];const f=l.length*8,m=new Uint32Array(r(f));for(let P=0;P<f;P+=8)m[P>>5]|=(l[P/8]&255)<<P%32;return m}function s(l,f){const m=(l&65535)+(f&65535);return(l>>16)+(f>>16)+(m>>16)<<16|m&65535}function a(l,f){return l<<f|l>>>32-f}function o(l,f,m,P,g,w){return s(a(s(s(f,l),s(P,w)),g),m)}function c(l,f,m,P,g,w,R){return o(f&m|~f&P,l,f,g,w,R)}function u(l,f,m,P,g,w,R){return o(f&P|m&~P,l,f,g,w,R)}function p(l,f,m,P,g,w,R){return o(f^m^P,l,f,g,w,R)}function d(l,f,m,P,g,w,R){return o(m^(f|~P),l,f,g,w,R)}var h=e;return wr.default=h,wr}var ad;function Yy(){if(ad)return yr;ad=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.default=void 0;var e=r(Eg()),t=r(Qy());function r(s){return s&&s.__esModule?s:{default:s}}var n=(0,e.default)("v3",48,t.default);return yr.default=n,yr}var Rr={},Er={},cd;function Zy(){if(cd)return Er;cd=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return Er.default=t,Er}var ud;function Xy(){if(ud)return Rr;ud=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.default=void 0;var e=i(Zy()),t=i(wg()),r=ws();function i(a){return a&&a.__esModule?a:{default:a}}function n(a,o,c){if(e.default.randomUUID&&!o&&!a)return e.default.randomUUID();a=a||{};const u=a.random||(a.rng||t.default)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,o){c=c||0;for(let p=0;p<16;++p)o[c+p]=u[p];return o}return(0,r.unsafeStringify)(u)}var s=n;return Rr.default=s,Rr}var Ar={},Tr={},pd;function eP(){if(pd)return Tr;pd=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.default=void 0;function e(n,s,a,o){switch(n){case 0:return s&a^~s&o;case 1:return s^a^o;case 2:return s&a^s&o^a&o;case 3:return s^a^o}}function t(n,s){return n<<s|n>>>32-s}function r(n){const s=[1518500249,1859775393,2400959708,3395469782],a=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){const p=unescape(encodeURIComponent(n));n=[];for(let d=0;d<p.length;++d)n.push(p.charCodeAt(d))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);const o=n.length/4+2,c=Math.ceil(o/16),u=new Array(c);for(let p=0;p<c;++p){const d=new Uint32Array(16);for(let h=0;h<16;++h)d[h]=n[p*64+h*4]<<24|n[p*64+h*4+1]<<16|n[p*64+h*4+2]<<8|n[p*64+h*4+3];u[p]=d}u[c-1][14]=(n.length-1)*8/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=(n.length-1)*8&4294967295;for(let p=0;p<c;++p){const d=new Uint32Array(80);for(let g=0;g<16;++g)d[g]=u[p][g];for(let g=16;g<80;++g)d[g]=t(d[g-3]^d[g-8]^d[g-14]^d[g-16],1);let h=a[0],l=a[1],f=a[2],m=a[3],P=a[4];for(let g=0;g<80;++g){const w=Math.floor(g/20),R=t(h,5)+e(w,l,f,m)+P+s[w]+d[g]>>>0;P=m,m=f,f=t(l,30)>>>0,l=h,h=R}a[0]=a[0]+h>>>0,a[1]=a[1]+l>>>0,a[2]=a[2]+f>>>0,a[3]=a[3]+m>>>0,a[4]=a[4]+P>>>0}return[a[0]>>24&255,a[0]>>16&255,a[0]>>8&255,a[0]&255,a[1]>>24&255,a[1]>>16&255,a[1]>>8&255,a[1]&255,a[2]>>24&255,a[2]>>16&255,a[2]>>8&255,a[2]&255,a[3]>>24&255,a[3]>>16&255,a[3]>>8&255,a[3]&255,a[4]>>24&255,a[4]>>16&255,a[4]>>8&255,a[4]&255]}var i=r;return Tr.default=i,Tr}var dd;function tP(){if(dd)return Ar;dd=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.default=void 0;var e=r(Eg()),t=r(eP());function r(s){return s&&s.__esModule?s:{default:s}}var n=(0,e.default)("v5",80,t.default);return Ar.default=n,Ar}var br={},ld;function rP(){if(ld)return br;ld=1,Object.defineProperty(br,"__esModule",{value:!0}),br.default=void 0;var e="00000000-0000-0000-0000-000000000000";return br.default=e,br}var Ir={},hd;function nP(){if(hd)return Ir;hd=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.default=void 0;var e=t(Ps());function t(n){return n&&n.__esModule?n:{default:n}}function r(n){if(!(0,e.default)(n))throw TypeError("Invalid UUID");return parseInt(n.slice(14,15),16)}var i=r;return Ir.default=i,Ir}var vd;function iP(){return vd||(vd=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return a.default}});var t=p(Jy()),r=p(Yy()),i=p(Xy()),n=p(tP()),s=p(rP()),a=p(nP()),o=p(Ps()),c=p(ws()),u=p(Rg());function p(d){return d&&d.__esModule?d:{default:d}}})(ia)),ia}var fd;function Xt(){if(fd)return Dt;fd=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.createNoDashGuid=Dt.createGuid=void 0;const e=iP(),t=()=>(0,e.v4)();Dt.createGuid=t;const r=()=>t().replace(new RegExp("-","g"),"").toUpperCase();return Dt.createNoDashGuid=r,Dt}var gd;function bo(){return gd||(gd=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformEvent=e.EventType=void 0;const t=Xt();(function(i){i[i.Debug=0]="Debug",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i[i.None=4]="None"})(e.EventType||(e.EventType={}));class r{constructor(n,s){this.privName=n,this.privEventId=(0,t.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=s,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}e.PlatformEvent=r})(na)),na}var md;function oP(){if(md)return Y;md=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.AudioStreamNodeErrorEvent=Y.AudioStreamNodeDetachedEvent=Y.AudioStreamNodeAttachedEvent=Y.AudioStreamNodeAttachingEvent=Y.AudioStreamNodeEvent=Y.AudioSourceErrorEvent=Y.AudioSourceOffEvent=Y.AudioSourceReadyEvent=Y.AudioSourceInitializingEvent=Y.AudioSourceEvent=void 0;const e=bo();class t extends e.PlatformEvent{constructor(h,l,f=e.EventType.Info){super(h,f),this.privAudioSourceId=l}get audioSourceId(){return this.privAudioSourceId}}Y.AudioSourceEvent=t;class r extends t{constructor(h){super("AudioSourceInitializingEvent",h)}}Y.AudioSourceInitializingEvent=r;class i extends t{constructor(h){super("AudioSourceReadyEvent",h)}}Y.AudioSourceReadyEvent=i;class n extends t{constructor(h){super("AudioSourceOffEvent",h)}}Y.AudioSourceOffEvent=n;class s extends t{constructor(h,l){super("AudioSourceErrorEvent",h,e.EventType.Error),this.privError=l}get error(){return this.privError}}Y.AudioSourceErrorEvent=s;class a extends t{constructor(h,l,f){super(h,l),this.privAudioNodeId=f}get audioNodeId(){return this.privAudioNodeId}}Y.AudioStreamNodeEvent=a;class o extends a{constructor(h,l){super("AudioStreamNodeAttachingEvent",h,l)}}Y.AudioStreamNodeAttachingEvent=o;class c extends a{constructor(h,l){super("AudioStreamNodeAttachedEvent",h,l)}}Y.AudioStreamNodeAttachedEvent=c;class u extends a{constructor(h,l){super("AudioStreamNodeDetachedEvent",h,l)}}Y.AudioStreamNodeDetachedEvent=u;class p extends a{constructor(h,l,f){super("AudioStreamNodeErrorEvent",h,l),this.privError=f}get error(){return this.privError}}return Y.AudioStreamNodeErrorEvent=p,Y}var Z={},Sd;function sP(){if(Sd)return Z;Sd=1,Object.defineProperty(Z,"__esModule",{value:!0}),Z.ConnectionRedirectEvent=Z.ConnectionMessageSentEvent=Z.ConnectionMessageReceivedEvent=Z.ConnectionEstablishErrorEvent=Z.ConnectionErrorEvent=Z.ConnectionClosedEvent=Z.ConnectionEstablishedEvent=Z.ConnectionStartEvent=Z.ConnectionEvent=Z.ServiceEvent=void 0;const e=bo();class t extends e.PlatformEvent{constructor(h,l,f=e.EventType.Info){super(h,f),this.privJsonResult=l}get jsonString(){return this.privJsonResult}}Z.ServiceEvent=t;class r extends e.PlatformEvent{constructor(h,l,f=e.EventType.Info){super(h,f),this.privConnectionId=l}get connectionId(){return this.privConnectionId}}Z.ConnectionEvent=r;class i extends r{constructor(h,l,f){super("ConnectionStartEvent",h),this.privUri=l,this.privHeaders=f}get uri(){return this.privUri}get headers(){return this.privHeaders}}Z.ConnectionStartEvent=i;class n extends r{constructor(h){super("ConnectionEstablishedEvent",h)}}Z.ConnectionEstablishedEvent=n;class s extends r{constructor(h,l,f){super("ConnectionClosedEvent",h,e.EventType.Debug),this.privReason=f,this.privStatusCode=l}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Z.ConnectionClosedEvent=s;class a extends r{constructor(h,l,f){super("ConnectionErrorEvent",h,e.EventType.Debug),this.privMessage=l,this.privType=f}get message(){return this.privMessage}get type(){return this.privType}}Z.ConnectionErrorEvent=a;class o extends r{constructor(h,l,f){super("ConnectionEstablishErrorEvent",h,e.EventType.Error),this.privStatusCode=l,this.privReason=f}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Z.ConnectionEstablishErrorEvent=o;class c extends r{constructor(h,l,f){super("ConnectionMessageReceivedEvent",h),this.privNetworkReceivedTime=l,this.privMessage=f}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}Z.ConnectionMessageReceivedEvent=c;class u extends r{constructor(h,l,f){super("ConnectionMessageSentEvent",h),this.privNetworkSentTime=l,this.privMessage=f}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}Z.ConnectionMessageSentEvent=u;class p extends r{constructor(h,l,f,m){super("ConnectionRedirectEvent",h,e.EventType.Info),this.privRedirectUrl=l,this.privOriginalUrl=f,this.privContext=m}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return Z.ConnectionRedirectEvent=p,Z}var oa={},Ye={},Cd;function Ge(){if(Cd)return Ye;Cd=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.ObjectDisposedError=Ye.InvalidOperationError=Ye.ArgumentNullError=void 0;class e extends Error{constructor(n){super(n),this.name="ArgumentNull",this.message=n}}Ye.ArgumentNullError=e;class t extends Error{constructor(n){super(n),this.name="InvalidOperation",this.message=n}}Ye.InvalidOperationError=t;class r extends Error{constructor(n,s){super(s),this.name=n+"ObjectDisposed",this.message=s}}return Ye.ObjectDisposedError=r,Ye}var yd;function Ag(){return yd||(yd=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessage=e.MessageType=void 0;const t=Ge(),r=Xt();var i;(function(s){s[s.Text=0]="Text",s[s.Binary=1]="Binary"})(i=e.MessageType||(e.MessageType={}));class n{constructor(a,o,c,u){if(this.privBody=null,a===i.Text&&o&&typeof o!="string")throw new t.InvalidOperationError("Payload must be a string");if(a===i.Binary&&o&&!(o instanceof ArrayBuffer))throw new t.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=a,this.privBody=o,this.privHeaders=c||{},this.privId=u||(0,r.createNoDashGuid)(),this.messageType){case i.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case i.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===i.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===i.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}e.ConnectionMessage=n})(oa)),oa}var _r={},Pd;function aP(){if(Pd)return _r;Pd=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.ConnectionOpenResponse=void 0;let e=class{constructor(r,i){this.privStatusCode=r,this.privReason=i}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return _r.ConnectionOpenResponse=e,_r}var Or={},wd;function cP(){if(wd)return Or;wd=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.DeferralMap=void 0;let e=class{constructor(){this.privMap={}}add(r,i){this.privMap[r]=i}getId(r){return this.privMap[r]}complete(r,i){try{this.privMap[r].resolve(i)}catch(n){this.privMap[r].reject(n)}finally{this.privMap[r]=void 0}}};return Or.DeferralMap=e,Or}var kt={},Rd;function Tg(){if(Rd)return kt;Rd=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.SendingAgentContextMessageEvent=kt.DialogEvent=void 0;const e=bo();class t extends e.PlatformEvent{constructor(n,s=e.EventType.Info){super(n,s)}}kt.DialogEvent=t;class r extends t{constructor(n){super("SendingAgentContextMessageEvent"),this.privAgentConfig=n}get agentConfig(){return this.privAgentConfig}}return kt.SendingAgentContextMessageEvent=r,kt}var Mr={},Dr={},Ed;function bg(){if(Ed)return Dr;Ed=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.EventSource=void 0;const e=Ge(),t=Xt();let r=class{constructor(n){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=n}onEvent(n){if(this.isDisposed())throw new e.ObjectDisposedError("EventSource");if(this.metadata)for(const s in this.metadata)s&&n.metadata&&(n.metadata[s]||(n.metadata[s]=this.metadata[s]));for(const s in this.privEventListeners)s&&this.privEventListeners[s]&&this.privEventListeners[s](n)}attach(n){const s=(0,t.createNoDashGuid)();return this.privEventListeners[s]=n,{detach:()=>(delete this.privEventListeners[s],Promise.resolve())}}attachListener(n){return this.attach(s=>n.onEvent(s))}attachConsoleListener(n){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(s=>n.onEvent(s)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Dr.EventSource=r,Dr}var Ad;function uP(){if(Ad)return Mr;Ad=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Events=void 0;const e=Ge(),t=bg();let r=class Tc{static setEventSource(n){if(!n)throw new e.ArgumentNullError("eventSource");Tc.privInstance=n}static get instance(){return Tc.privInstance}};return Mr.Events=r,r.privInstance=new t.EventSource,Mr}var sa={},Td;function pP(){return Td||(Td=1,Object.defineProperty(sa,"__esModule",{value:!0})),sa}var aa={},bd;function dP(){return bd||(bd=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionState=void 0,(function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"})(e.ConnectionState||(e.ConnectionState={}))})(aa)),aa}var ca={},Id;function lP(){return Id||(Id=1,Object.defineProperty(ca,"__esModule",{value:!0})),ca}var ua={},_d;function hP(){return _d||(_d=1,Object.defineProperty(ua,"__esModule",{value:!0})),ua}var pa={},Od;function vP(){return Od||(Od=1,Object.defineProperty(pa,"__esModule",{value:!0})),pa}var da={},Md;function fP(){return Md||(Md=1,Object.defineProperty(da,"__esModule",{value:!0})),da}var la={},Dd;function gP(){return Dd||(Dd=1,Object.defineProperty(la,"__esModule",{value:!0})),la}var ha={},kd;function mP(){return kd||(kd=1,Object.defineProperty(ha,"__esModule",{value:!0})),ha}var va={},Nd;function SP(){return Nd||(Nd=1,Object.defineProperty(va,"__esModule",{value:!0})),va}var fa={},jd;function CP(){return jd||(jd=1,Object.defineProperty(fa,"__esModule",{value:!0})),fa}var kr={},zd;function Ig(){if(zd)return kr;zd=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.List=void 0;const e=Ge();let t=class Qt{constructor(i){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],i)for(const n of i)this.privList.push(n)}get(i){return this.throwIfDisposed(),this.privList[i]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(i){this.throwIfDisposed(),this.insertAt(this.privList.length,i)}insertAt(i,n){this.throwIfDisposed(),i===0?this.privList.unshift(n):i===this.privList.length?this.privList.push(n):this.privList.splice(i,0,n),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(i){return this.throwIfDisposed(),this.remove(i,1)[0]}remove(i,n){this.throwIfDisposed();const s=this.privList.splice(i,n);return this.triggerSubscriptions(this.privRemoveSubscriptions),s}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(i){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[n]=i,{detach:()=>(delete this.privAddSubscriptions[n],Promise.resolve())}}onRemoved(i){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[n]=i,{detach:()=>(delete this.privRemoveSubscriptions[n],Promise.resolve())}}onDisposed(i){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[n]=i,{detach:()=>(delete this.privDisposedSubscriptions[n],Promise.resolve())}}join(i){return this.throwIfDisposed(),this.privList.join(i)}toArray(){const i=Array();return this.privList.forEach(n=>{i.push(n)}),i}any(i){return this.throwIfDisposed(),i?this.where(i).length()>0:this.length()>0}all(i){return this.throwIfDisposed(),this.where(i).length()===this.length()}forEach(i){this.throwIfDisposed();for(let n=0;n<this.length();n++)i(this.privList[n],n)}select(i){this.throwIfDisposed();const n=[];for(let s=0;s<this.privList.length;s++)n.push(i(this.privList[s],s));return new Qt(n)}where(i){this.throwIfDisposed();const n=new Qt;for(let s=0;s<this.privList.length;s++)i(this.privList[s],s)&&n.add(this.privList[s]);return n}orderBy(i){this.throwIfDisposed();const s=this.toArray().sort(i);return new Qt(s)}orderByDesc(i){return this.throwIfDisposed(),this.orderBy((n,s)=>i(s,n))}clone(){return this.throwIfDisposed(),new Qt(this.toArray())}concat(i){return this.throwIfDisposed(),new Qt(this.privList.concat(i.toArray()))}concatArray(i){return this.throwIfDisposed(),new Qt(this.privList.concat(i))}isDisposed(){return this.privList==null}dispose(i){this.isDisposed()||(this.privDisposeReason=i,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new e.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(i){if(i)for(const n in i)n&&i[n]()}};return kr.List=t,kr}var ga={},Ld;function _g(){return Ld||(Ld=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.marshalPromiseToCallbacks=e.Sink=e.Deferred=e.PromiseResultEventSource=e.PromiseResult=e.PromiseState=void 0;var t;(function(o){o[o.None=0]="None",o[o.Resolved=1]="Resolved",o[o.Rejected=2]="Rejected"})(t=e.PromiseState||(e.PromiseState={}));class r{constructor(c){this.throwIfError=()=>{if(this.isError)throw this.error},c.on(u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=u)},u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=u)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}e.PromiseResult=r;class i{constructor(){this.setResult=c=>{this.privOnSetResult(c)},this.setError=c=>{this.privOnSetError(c)},this.on=(c,u)=>{this.privOnSetResult=c,this.privOnSetError=u}}}e.PromiseResultEventSource=i;class n{constructor(){this.resolve=c=>(this.privResolve(c),this),this.reject=c=>(this.privReject(c),this),this.privPromise=new Promise((c,u)=>{this.privResolve=c,this.privReject=u})}get promise(){return this.privPromise}}e.Deferred=n;class s{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new i,this.privPromiseResult=new r(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(c){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(c);for(let u=0;u<this.privSuccessHandlers.length;u++)this.executeSuccessCallback(c,this.privSuccessHandlers[u],this.privErrorHandlers[u]);this.detachHandlers()}reject(c){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(c);for(const u of this.privErrorHandlers)this.executeErrorCallback(c,u);this.detachHandlers()}on(c,u){c==null&&(c=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(c),this.privErrorHandlers.push(u)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,c,u):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,u),this.detachHandlers())}executeSuccessCallback(c,u,p){try{u(c)}catch(d){this.executeErrorCallback(`'Unhandled callback error: ${d}'`,p)}}executeErrorCallback(c,u){if(u)try{u(c)}catch(p){throw new Error(`'Unhandled callback error: ${p}. InnerError: ${c}'`)}else throw new Error(`'Unhandled error: ${c}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}e.Sink=s;function a(o,c,u){o.then(p=>{try{c&&c(p)}catch(d){if(u)try{if(d instanceof Error){const h=d;u(h.name+": "+h.message)}else u(d)}catch{}}},p=>{if(u)try{if(p instanceof Error){const d=p;u(d.name+": "+d.message)}else u(p)}catch{}})}e.marshalPromiseToCallbacks=a})(ga)),ga}var Nr={},Fd;function Og(){if(Fd)return Nr;Fd=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.Queue=void 0;const e=Ge(),t=Ig(),r=_g();var i;(function(s){s[s.Dequeue=0]="Dequeue",s[s.Peek=1]="Peek"})(i||(i={}));let n=class{constructor(a){this.privPromiseStore=new t.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=a||new t.List,this.privDetachables=[],this.privSubscribers=new t.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(a){this.throwIfDispose(),this.enqueueFromPromise(new Promise(o=>o(a)))}enqueueFromPromise(a){this.throwIfDispose(),a.then(o=>{this.privList.add(o)},()=>{})}dequeue(){this.throwIfDispose();const a=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:a,type:i.Dequeue}),this.drain()),a.promise}peek(){this.throwIfDispose();const a=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:a,type:i.Peek}),this.drain()),a.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(a,o){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=o,this.privIsDisposing=!0;const c=this.privSubscribers;if(c){for(;c.length()>0;)c.removeFirst().deferral.resolve(void 0);this.privSubscribers===c&&(this.privSubscribers=c)}for(const u of this.privDetachables)await u.detach();if(this.privPromiseStore.length()>0&&a){const u=[];return this.privPromiseStore.toArray().forEach(p=>{u.push(p)}),Promise.all(u).finally(()=>{this.privSubscribers=null,this.privList.forEach(p=>{a(p)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(a){await this.drainAndDispose(null,a)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const a=this.privSubscribers,o=this.privList;if(a&&o){for(;o.length()>0&&a.length()>0&&!this.privIsDisposing;){const c=a.removeFirst();if(c.type===i.Peek)c.deferral.resolve(o.first());else{const u=o.removeFirst();c.deferral.resolve(u)}}this.privSubscribers===a&&(this.privSubscribers=a),this.privList===o&&(this.privList=o)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new e.InvalidOperationError(this.privDisposeReason):new e.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new e.InvalidOperationError("Queue disposing")}};return Nr.Queue=n,Nr}var jr={},qd;function yP(){if(qd)return jr;qd=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.RawWebsocketMessage=void 0;const e=Ag(),t=Ge(),r=Xt();let i=class{constructor(s,a,o){if(this.privPayload=null,!a)throw new t.ArgumentNullError("payload");if(s===e.MessageType.Binary&&Object.getPrototypeOf(a).constructor.name!=="ArrayBuffer")throw new t.InvalidOperationError("Payload must be ArrayBuffer");if(s===e.MessageType.Text&&typeof a!="string")throw new t.InvalidOperationError("Payload must be a string");this.privMessageType=s,this.privPayload=a,this.privId=o||(0,r.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===e.MessageType.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===e.MessageType.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return jr.RawWebsocketMessage=i,jr}var zr={},Bd;function PP(){if(Bd)return zr;Bd=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.RiffPcmEncoder=void 0;let e=class{constructor(r,i){this.privActualSampleRate=r,this.privDesiredSampleRate=i}encode(r){const i=this.downSampleAudioFrame(r,this.privActualSampleRate,this.privDesiredSampleRate);if(!i)return null;const n=i.length*2,s=new ArrayBuffer(n),a=new DataView(s);return this.floatTo16BitPCM(a,0,i),s}setString(r,i,n){for(let s=0;s<n.length;s++)r.setUint8(i+s,n.charCodeAt(s))}floatTo16BitPCM(r,i,n){for(let s=0;s<n.length;s++,i+=2){const a=Math.max(-1,Math.min(1,n[s]));r.setInt16(i,a<0?a*32768:a*32767,!0)}}downSampleAudioFrame(r,i,n){if(!r)return null;if(n===i||n>i)return r;const s=i/n,a=Math.round(r.length/s),o=new Float32Array(a);let c=0,u=0;for(;u<a;){const p=Math.round((u+1)*s);let d=0,h=0;for(;c<p&&c<r.length;)d+=r[c++],h++;o[u++]=d/h}return o}};return zr.RiffPcmEncoder=e,zr}var Lr={},Ud;function wP(){if(Ud)return Lr;Ud=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.Stream=void 0;const e=Ge(),t=Xt(),r=Og();let i=class{constructor(s){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=s||(0,t.createNoDashGuid)(),this.privReaderQueue=new r.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(s){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(s)}catch{}}read(){if(this.privIsReadEnded)throw new e.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async s=>((s===void 0||s.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),s))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new r.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new e.InvalidOperationError("Stream closed")}};return Lr.Stream=i,Lr}var ma={},xd;function Yu(){return xd||(xd=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,(function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"})(e.TranslationStatus||(e.TranslationStatus={}))})(ma)),ma}var Fr={},Hd;function RP(){if(Hd)return Fr;Hd=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.ChunkedArrayBufferStream=void 0;const e=F();let t=class extends e.Stream{constructor(i,n){super(n),this.privTargetChunkSize=Math.round(i),this.privNextBufferReadyBytes=0}writeStreamChunk(i){if(i.isEnd||this.privNextBufferReadyBytes===0&&i.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(i);return}let n=0;for(;n<i.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=i.timeReceived);const s=Math.min(i.buffer.byteLength-n,this.privTargetChunkSize-this.privNextBufferReadyBytes),a=new Uint8Array(this.privNextBufferToWrite),o=new Uint8Array(i.buffer.slice(n,s+n));a.set(o,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=s,n+=s,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return Fr.ChunkedArrayBufferStream=t,Fr}var Sa={},$d;function EP(){return $d||($d=1,Object.defineProperty(Sa,"__esModule",{value:!0})),Sa}var qr={},Wd;function AP(){if(Wd)return qr;Wd=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Timeout=void 0;let e=class ht{static load(){const r=new Map([[0,()=>{}]]),i=new Map,s="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),a=new Worker(s);return a.addEventListener("message",({data:u})=>{if(ht.isCallNotification(u)){const{params:{timerId:p}}=u,d=r.get(p);if(typeof d=="number"){const h=i.get(d);if(h===void 0||h!==p)throw new Error("The timer is in an undefined state.")}else if(typeof d<"u")d(),r.delete(p);else throw new Error("The timer is in an undefined state.")}else if(ht.isClearResponse(u)){const{id:p}=u,d=i.get(p);if(d===void 0)throw new Error("The timer is in an undefined state.");i.delete(p),r.delete(d)}else{const{error:{message:p}}=u;throw new Error(p)}}),{clearTimeout:u=>{const p=Math.random();i.set(p,u),r.set(u,p),a.postMessage({id:p,method:"clear",params:{timerId:u}})},setTimeout:(u,p)=>{const d=Math.random();return r.set(d,u),a.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:d}}),d}}}static loadWorkerTimers(){return()=>(ht.workerTimers!==null||(ht.workerTimers=ht.load()),ht.workerTimers)}static isCallNotification(r){return r.method!==void 0&&r.method==="call"}static isClearResponse(r){return r.error===null&&typeof r.id=="number"}};return qr.Timeout=e,e.workerTimers=null,e.clearTimeout=t=>e.timers().clearTimeout(t),e.setTimeout=(t,r)=>e.timers().setTimeout(t,r),e.timers=e.loadWorkerTimers(),qr}var H={},Vd;function TP(){if(Vd)return H;Vd=1,Object.defineProperty(H,"__esModule",{value:!0}),H.OCSPCacheUpdateErrorEvent=H.OCSPResponseRetrievedEvent=H.OCSPCacheFetchErrorEvent=H.OCSPVerificationFailedEvent=H.OCSPCacheHitEvent=H.OCSPCacheEntryNeedsRefreshEvent=H.OCSPCacheEntryExpiredEvent=H.OCSPWSUpgradeStartedEvent=H.OCSPStapleReceivedEvent=H.OCSPCacheUpdateCompleteEvent=H.OCSPDiskCacheStoreEvent=H.OCSPMemoryCacheStoreEvent=H.OCSPCacheUpdateNeededEvent=H.OCSPDiskCacheHitEvent=H.OCSPCacheMissEvent=H.OCSPMemoryCacheHitEvent=H.OCSPEvent=void 0;const e=bo();class t extends e.PlatformEvent{constructor(R,A,I){super(R,A),this.privSignature=I}}H.OCSPEvent=t;class r extends t{constructor(R){super("OCSPMemoryCacheHitEvent",e.EventType.Debug,R)}}H.OCSPMemoryCacheHitEvent=r;class i extends t{constructor(R){super("OCSPCacheMissEvent",e.EventType.Debug,R)}}H.OCSPCacheMissEvent=i;class n extends t{constructor(R){super("OCSPDiskCacheHitEvent",e.EventType.Debug,R)}}H.OCSPDiskCacheHitEvent=n;class s extends t{constructor(R){super("OCSPCacheUpdateNeededEvent",e.EventType.Debug,R)}}H.OCSPCacheUpdateNeededEvent=s;class a extends t{constructor(R){super("OCSPMemoryCacheStoreEvent",e.EventType.Debug,R)}}H.OCSPMemoryCacheStoreEvent=a;class o extends t{constructor(R){super("OCSPDiskCacheStoreEvent",e.EventType.Debug,R)}}H.OCSPDiskCacheStoreEvent=o;class c extends t{constructor(R){super("OCSPCacheUpdateCompleteEvent",e.EventType.Debug,R)}}H.OCSPCacheUpdateCompleteEvent=c;class u extends t{constructor(){super("OCSPStapleReceivedEvent",e.EventType.Debug,"")}}H.OCSPStapleReceivedEvent=u;class p extends t{constructor(R){super("OCSPWSUpgradeStartedEvent",e.EventType.Debug,R)}}H.OCSPWSUpgradeStartedEvent=p;class d extends t{constructor(R,A){super("OCSPCacheEntryExpiredEvent",e.EventType.Debug,R),this.privExpireTime=A}}H.OCSPCacheEntryExpiredEvent=d;class h extends t{constructor(R,A,I){super("OCSPCacheEntryNeedsRefreshEvent",e.EventType.Debug,R),this.privExpireTime=I,this.privStartTime=A}}H.OCSPCacheEntryNeedsRefreshEvent=h;class l extends t{constructor(R,A,I){super("OCSPCacheHitEvent",e.EventType.Debug,R),this.privExpireTime=I,this.privExpireTimeString=new Date(I).toLocaleDateString(),this.privStartTime=A,this.privStartTimeString=new Date(A).toLocaleTimeString()}}H.OCSPCacheHitEvent=l;class f extends t{constructor(R,A){super("OCSPVerificationFailedEvent",e.EventType.Debug,R),this.privError=A}}H.OCSPVerificationFailedEvent=f;class m extends t{constructor(R,A){super("OCSPCacheFetchErrorEvent",e.EventType.Debug,R),this.privError=A}}H.OCSPCacheFetchErrorEvent=m;class P extends t{constructor(R){super("OCSPResponseRetrievedEvent",e.EventType.Debug,R)}}H.OCSPResponseRetrievedEvent=P;class g extends t{constructor(R,A){super("OCSPCacheUpdateErrorEvent",e.EventType.Debug,R),this.privError=A}}return H.OCSPCacheUpdateErrorEvent=g,H}var Br={},Kd;function bP(){if(Kd)return Br;Kd=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.BackgroundEvent=void 0;const e=F();class t extends e.PlatformEvent{constructor(i){super("BackgroundEvent",e.EventType.Error),this.privError=i}get error(){return this.privError}}return Br.BackgroundEvent=t,Br}var Gd;function F(){return Gd||(Gd=1,(function(e){var t=Mt&&Mt.__createBinding||(Object.create?(function(n,s,a,o){o===void 0&&(o=a),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[a]}})}):(function(n,s,a,o){o===void 0&&(o=a),n[o]=s[a]})),r=Mt&&Mt.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,r(oP(),e),r(sP(),e),r(Ag(),e),r(aP(),e),r(cP(),e),r(Tg(),e),r(Ge(),e),r(uP(),e),r(bg(),e),r(Xt(),e),r(pP(),e),r(dP(),e),r(lP(),e),r(hP(),e),r(vP(),e),r(fP(),e),r(gP(),e),r(mP(),e),r(SP(),e),r(CP(),e),r(Ig(),e),r(bo(),e),r(_g(),e),r(Og(),e),r(yP(),e),r(PP(),e),r(wP(),e);var i=Yu();Object.defineProperty(e,"TranslationStatus",{enumerable:!0,get:function(){return i.TranslationStatus}}),r(RP(),e),r(EP(),e),r(AP(),e),r(TP(),e),r(bP(),e)})(Mt)),Mt}var Ur={},Jd;function Ee(){if(Jd)return Ur;Jd=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.HeaderNames=void 0;let e=class{};return Ur.HeaderNames=e,e.AuthKey="Ocp-Apim-Subscription-Key",e.Authorization="Authorization",e.SpIDAuthKey="Apim-Subscription-Id",e.ConnectionId="X-ConnectionId",e.ContentType="Content-Type",e.CustomCommandsAppId="X-CommandsAppId",e.Path="Path",e.RequestId="X-RequestId",e.RequestStreamId="X-StreamId",e.RequestTimestamp="X-Timestamp",Ur}var xr={},Qd;function Zu(){if(Qd)return xr;Qd=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.AuthInfo=void 0;class e{constructor(r,i){this.privHeaderName=r,this.privToken=i}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return xr.AuthInfo=e,xr}var Yd;function IP(){if(Yd)return gr;Yd=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.CognitiveSubscriptionKeyAuthentication=void 0;const e=F(),t=Ee(),r=Zu();let i=class{constructor(s){if(!s)throw new e.ArgumentNullError("subscriptionKey");this.privAuthInfo=new r.AuthInfo(t.HeaderNames.AuthKey,s)}fetch(s){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(s){return Promise.resolve(this.privAuthInfo)}};return gr.CognitiveSubscriptionKeyAuthentication=i,gr}var Hr={},Zd;function _P(){if(Zd)return Hr;Zd=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.CognitiveTokenAuthentication=void 0;const e=F(),t=Zu(),r=Ee();let i=class bc{constructor(s,a){if(!s)throw new e.ArgumentNullError("fetchCallback");if(!a)throw new e.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=s,this.privFetchOnExpiryCallback=a}fetch(s){return this.privFetchCallback(s).then(a=>new t.AuthInfo(r.HeaderNames.Authorization,a===void 0?void 0:bc.privTokenPrefix+a))}fetchOnExpiry(s){return this.privFetchOnExpiryCallback(s).then(a=>new t.AuthInfo(r.HeaderNames.Authorization,a===void 0?void 0:bc.privTokenPrefix+a))}};return Hr.CognitiveTokenAuthentication=i,i.privTokenPrefix="Bearer ",Hr}var Ca={},Xd;function OP(){return Xd||(Xd=1,Object.defineProperty(Ca,"__esModule",{value:!0})),Ca}var ya={},el;function MP(){return el||(el=1,Object.defineProperty(ya,"__esModule",{value:!0})),ya}var Pa={},tl;function Xu(){return tl||(tl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEndedEvent=e.RecognitionCompletionStatus=e.RecognitionStartedEvent=e.ConnectingToServiceEvent=e.ListeningStartedEvent=e.RecognitionTriggeredEvent=e.SpeechRecognitionEvent=void 0;const t=F();class r extends t.PlatformEvent{constructor(p,d,h,l=t.EventType.Info){super(p,l),this.privRequestId=d,this.privSessionId=h}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}e.SpeechRecognitionEvent=r;class i extends r{constructor(p,d,h,l){super("RecognitionTriggeredEvent",p,d),this.privAudioSourceId=h,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.RecognitionTriggeredEvent=i;class n extends r{constructor(p,d,h,l){super("ListeningStartedEvent",p,d),this.privAudioSourceId=h,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.ListeningStartedEvent=n;class s extends r{constructor(p,d,h){super("ConnectingToServiceEvent",p,h),this.privAuthFetchEventid=d}get authFetchEventid(){return this.privAuthFetchEventid}}e.ConnectingToServiceEvent=s;class a extends r{constructor(p,d,h,l,f){super("RecognitionStartedEvent",p,f),this.privAudioSourceId=d,this.privAudioNodeId=h,this.privAuthFetchEventId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}e.RecognitionStartedEvent=a;var o;(function(u){u[u.Success=0]="Success",u[u.AudioSourceError=1]="AudioSourceError",u[u.AudioSourceTimeout=2]="AudioSourceTimeout",u[u.AuthTokenFetchError=3]="AuthTokenFetchError",u[u.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",u[u.UnAuthorized=5]="UnAuthorized",u[u.ConnectTimeout=6]="ConnectTimeout",u[u.ConnectError=7]="ConnectError",u[u.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",u[u.UnknownError=9]="UnknownError"})(o=e.RecognitionCompletionStatus||(e.RecognitionCompletionStatus={}));class c extends r{constructor(p,d,h,l,f,m,P,g){super("RecognitionEndedEvent",p,f,P===o.Success?t.EventType.Info:t.EventType.Error),this.privAudioSourceId=d,this.privAudioNodeId=h,this.privAuthFetchEventId=l,this.privStatus=P,this.privError=g,this.privServiceTag=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}e.RecognitionEndedEvent=c})(Pa)),Pa}var $r={},Nt={},De={},wa={},rl;function Mg(){return rl||(rl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;const t=F();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.EventType}})})(wa)),wa}var Wr={},nl;function $(){if(nl)return Wr;nl=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Contracts=void 0;let e=class vt{static throwIfNullOrUndefined(r,i){if(r==null)throw new Error("throwIfNullOrUndefined:"+i)}static throwIfNull(r,i){if(r===null)throw new Error("throwIfNull:"+i)}static throwIfNullOrWhitespace(r,i){if(vt.throwIfNullOrUndefined(r,i),(""+r).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+i)}static throwIfNullOrTooLong(r,i,n){if(vt.throwIfNullOrUndefined(r,i),(""+r).length>n)throw new Error("throwIfNullOrTooLong:"+i+" (more than "+n.toString()+" characters)")}static throwIfNullOrTooShort(r,i,n){if(vt.throwIfNullOrUndefined(r,i),(""+r).length<n)throw new Error("throwIfNullOrTooShort:"+i+" (less than "+n.toString()+" characters)")}static throwIfDisposed(r){if(r)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(r,i){if(vt.throwIfNullOrUndefined(r,i),r.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+i);for(const n of r)vt.throwIfNullOrWhitespace(n,i)}static throwIfFileDoesNotExist(r,i){vt.throwIfNullOrWhitespace(r,i)}static throwIfNotUndefined(r,i){if(r!==void 0)throw new Error("throwIfNotUndefined:"+i)}static throwIfNumberOutOfRange(r,i,n,s){if(vt.throwIfNullOrUndefined(r,i),r<n||r>s)throw new Error("throwIfNumberOutOfRange:"+i+" (must be between "+n.toString()+" and "+s.toString()+")")}};return Wr.Contracts=e,Wr}var il;function DP(){if(il)return De;il=1;var e=De&&De.__createBinding||(Object.create?(function(o,c,u,p){p===void 0&&(p=u),Object.defineProperty(o,p,{enumerable:!0,get:function(){return c[u]}})}):(function(o,c,u,p){p===void 0&&(p=u),o[p]=c[u]})),t=De&&De.__setModuleDefault||(Object.create?(function(o,c){Object.defineProperty(o,"default",{enumerable:!0,value:c})}):function(o,c){o.default=c}),r=De&&De.__importStar||function(o){if(o&&o.__esModule)return o;var c={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&e(c,o,u);return t(c,o),c};Object.defineProperty(De,"__esModule",{value:!0}),De.ConsoleLoggingListener=void 0;const i=r(Yt),n=Mg(),s=$();let a=class{constructor(c=n.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=c}set logPath(c){s.Contracts.throwIfNullOrUndefined(i.openSync,`
File System access not available`),this.privLogPath=c}set enableConsoleOutput(c){this.privEnableConsoleOutput=c}onEvent(c){if(c.eventType>=this.privLogLevelFilter){const u=this.toString(c);if(this.logCallback&&this.logCallback(u),this.privLogPath&&i.writeFileSync(this.privLogPath,u+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(c.eventType){case n.LogLevel.Debug:console.debug(u);break;case n.LogLevel.Info:console.info(u);break;case n.LogLevel.Warning:console.warn(u);break;case n.LogLevel.Error:console.error(u);break;default:console.log(u);break}}}toString(c){const u=[`${c.eventTime}`,`${c.name}`],p=c;for(const d in p)if(d&&c.hasOwnProperty(d)&&d!=="eventTime"&&d!=="eventType"&&d!=="eventId"&&d!=="name"&&d!=="constructor"){const h=p[d];let l="<NULL>";h!=null&&(typeof h=="number"||typeof h=="string"?l=h.toString():l=JSON.stringify(h)),u.push(`${d}: ${l}`)}return u.join(" | ")}};return De.ConsoleLoggingListener=a,De}var Ra={},ol;function kP(){return ol||(ol=1,Object.defineProperty(Ra,"__esModule",{value:!0})),Ra}var Ea={},Aa={},sl;function er(){return sl||(sl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamFormatImpl=e.AudioStreamFormat=e.AudioFormatTag=void 0;var t;(function(n){n[n.PCM=1]="PCM",n[n.MuLaw=2]="MuLaw",n[n.Siren=3]="Siren",n[n.MP3=4]="MP3",n[n.SILKSkype=5]="SILKSkype",n[n.OGG_OPUS=6]="OGG_OPUS",n[n.WEBM_OPUS=7]="WEBM_OPUS",n[n.ALaw=8]="ALaw",n[n.FLAC=9]="FLAC",n[n.OPUS=10]="OPUS",n[n.AMR_WB=11]="AMR_WB",n[n.G722=12]="G722"})(t=e.AudioFormatTag||(e.AudioFormatTag={}));class r{static getDefaultInputFormat(){return i.getDefaultInputFormat()}static getWaveFormat(s,a,o,c){return new i(s,a,o,c)}static getWaveFormatPCM(s,a,o){return new i(s,a,o)}}e.AudioStreamFormat=r;class i extends r{constructor(s=16e3,a=16,o=1,c=t.PCM){super();let u=!0;switch(c){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:u=!1}if(this.bitsPerSample=a,this.samplesPerSec=s,this.channels=o,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),u){this.privHeader=new ArrayBuffer(44);const p=new DataView(this.privHeader);this.setString(p,0,"RIFF"),p.setUint32(4,0,!0),this.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,this.formatTag,!0),p.setUint16(22,this.channels,!0),p.setUint32(24,this.samplesPerSec,!0),p.setUint32(28,this.avgBytesPerSec,!0),p.setUint16(32,this.channels*(this.bitsPerSample/8),!0),p.setUint16(34,this.bitsPerSample,!0),this.setString(p,36,"data"),p.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new i}static getAudioContext(s){const a=window.AudioContext||window.webkitAudioContext||!1;if(a)return s!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new a({sampleRate:s}):new a;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(s,a,o){for(let c=0;c<o.length;c++)s.setUint8(a+c,o.charCodeAt(c))}}e.AudioStreamFormatImpl=i})(Aa)),Aa}var al;function NP(){return al||(al=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MicAudioSource=e.AudioWorkletSourceURLPropertyName=void 0;const t=L(),r=F(),i=er();e.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class n{constructor(a,o,c,u){this.privRecorder=a,this.deviceId=o,this.privStreams={},this.privOutputChunkSize=n.AUDIOFORMAT.avgBytesPerSec/10,this.privId=c||(0,r.createNoDashGuid)(),this.privEvents=new r.EventSource,this.privMediaStream=u||null,this.privIsClosing=!1}get format(){return Promise.resolve(n.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new r.Deferred;try{this.createAudioContext()}catch(c){if(c instanceof Error){const u=c;this.privInitializeDeferral.reject(u.name+": "+u.message)}else this.privInitializeDeferral.reject(c);return this.privInitializeDeferral.promise}const a=window.navigator;let o=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia;if(a.mediaDevices&&(o=(c,u,p)=>{a.mediaDevices.getUserMedia(c).then(u).catch(p)}),o){const c=()=>{this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):o({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},u=>{this.privMediaStream=u,this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},u=>{const p=`Error occurred during microphone initialization: ${u}`;this.privInitializeDeferral.reject(p),this.onEvent(new r.AudioSourceErrorEvent(this.privId,p))})};this.privContext.state==="suspended"?this.privContext.resume().then(c).catch(u=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${u}`)}):c()}else{const c="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(c),this.onEvent(new r.AudioSourceErrorEvent(c,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(a){return this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,a)),this.listen(a).then(o=>(this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,a)),{detach:async()=>(o.readEnded(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)),this.turnOff()),id:()=>a,read:()=>o.read()}))}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)))}async turnOff(){for(const a in this.privStreams)if(a){const o=this.privStreams[a];o&&o.close()}this.onEvent(new r.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(a=>({bitspersample:n.AUDIOFORMAT.bitsPerSample,channelcount:n.AUDIOFORMAT.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:a,samplerate:n.AUDIOFORMAT.samplesPerSec,type:t.type.Microphones}))}setProperty(a,o){if(a===e.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(o);else throw new Error("Property '"+a+"' is not supported on Microphone.")}getMicrophoneLabel(){const a="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(a);this.privMicrophoneLabel=a;const o=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(o===void 0)return Promise.resolve(this.privMicrophoneLabel);const c=new r.Deferred;return navigator.mediaDevices.enumerateDevices().then(u=>{for(const p of u)if(p.deviceId===o){this.privMicrophoneLabel=p.label;break}c.resolve(this.privMicrophoneLabel)},()=>c.resolve(this.privMicrophoneLabel)),c.promise}async listen(a){await this.turnOn();const o=new r.ChunkedArrayBufferStream(this.privOutputChunkSize,a);this.privStreams[a]=o;try{this.privRecorder.record(this.privContext,this.privMediaStream,o)}catch(u){throw this.onEvent(new r.AudioStreamNodeErrorEvent(this.privId,a,u)),u}return o}onEvent(a){this.privEvents.onEvent(a),r.Events.instance.onEvent(a)}createAudioContext(){this.privContext||(this.privContext=i.AudioStreamFormatImpl.getAudioContext(n.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let a=!1;"close"in this.privContext&&(a=!0),a?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}e.MicAudioSource=n,n.AUDIOFORMAT=i.AudioStreamFormat.getDefaultInputFormat()})(Ea)),Ea}var Vr={},cl;function jP(){if(cl)return Vr;cl=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.FileAudioSource=void 0;const e=L(),t=F(),r=er();let i=class{constructor(s,a,o){this.privStreams={},this.privHeaderEnd=44,this.privId=o||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privSource=s,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=s.name:this.privFilename=a||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const s=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new t.AudioSourceErrorEvent(s,"")),Promise.reject(s)}this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(s){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,s));const a=await this.upload(s);return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,s)),Promise.resolve({detach:async()=>{a.readEnded(),delete this.privStreams[s],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,s)),await this.turnOff()},id:()=>s,read:()=>a.read()})}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,s)))}turnOff(){for(const s in this.privStreams)if(s){const a=this.privStreams[s];a&&!a.isClosed&&a.close()}return this.onEvent(new t.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(s=>Promise.resolve({bitspersample:s.bitsPerSample,channelcount:s.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:s.samplesPerSec,type:e.type.File}))}readHeader(){const a=this.privSource.slice(0,4296),o=new t.Deferred,c=u=>{const p=new DataView(u),d=g=>String.fromCharCode(p.getUint8(g),p.getUint8(g+1),p.getUint8(g+2),p.getUint8(g+3));if(d(0)!=="RIFF"){o.reject("Invalid WAV header in file, RIFF was not found");return}if(d(8)!=="WAVE"||d(12)!=="fmt "){o.reject("Invalid WAV header in file, WAVEfmt was not found");return}const h=p.getInt32(16,!0),l=p.getUint16(22,!0),f=p.getUint32(24,!0),m=p.getUint16(34,!0);let P=36+Math.max(h-16,0);for(;d(P)!=="data";P+=2)if(P>4288){o.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=P+8,o.resolve(r.AudioStreamFormat.getWaveFormatPCM(f,m,l))};if(typeof window<"u"&&typeof Blob<"u"&&a instanceof Blob){const u=new FileReader;u.onload=p=>{const d=p.target.result;c(d)},u.readAsArrayBuffer(a)}else{const u=a;c(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength))}return o.promise}async upload(s){const a=o=>{const c=`Error occurred while processing '${this.privFilename}'. ${o}`;throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,s,c)),new Error(c)};try{await this.turnOn();const o=await this.privAudioFormatPromise,c=new t.ChunkedArrayBufferStream(o.avgBytesPerSec/10,s);this.privStreams[s]=c;const u=this.privSource.slice(this.privHeaderEnd),p=d=>{c.isClosed||(c.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()}),c.close())};if(typeof window<"u"&&typeof Blob<"u"&&u instanceof Blob){const d=new FileReader;d.onerror=h=>a(h.toString()),d.onload=h=>{const l=h.target.result;p(l)},d.readAsArrayBuffer(u)}else{const d=u;p(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength))}return c}catch(o){a(o)}}onEvent(s){this.privEvents.onEvent(s),t.Events.instance.onEvent(s)}};return Vr.FileAudioSource=i,Vr}var Kr={},ul;function zP(){if(ul)return Kr;ul=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.PcmRecorder=void 0;const e=F();class t{constructor(i){this.privStopInputOnRelease=i}record(i,n,s){const o=new e.RiffPcmEncoder(i.sampleRate,16e3),c=i.createMediaStreamSource(n),u=()=>{const d=(()=>{let h=0;try{return i.createScriptProcessor(h,1,1)}catch{h=2048;let f=i.sampleRate;for(;h<16384&&f>=32e3;)h<<=1,f>>=1;return i.createScriptProcessor(h,1,1)}})();d.onaudioprocess=h=>{const l=h.inputBuffer.getChannelData(0);if(s&&!s.isClosed){const f=o.encode(l);f&&s.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},c.connect(d),d.connect(i.destination),this.privMediaResources={scriptProcessorNode:d,source:c,stream:n}},p=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(i.audioWorklet&&!p){if(!this.privSpeechProcessorScript){const d=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,h=new Blob([d],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(h)}i.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const d=new AudioWorkletNode(i,"speech-processor");d.port.onmessage=h=>{const l=h.data;if(s&&!s.isClosed){const f=o.encode(l);f&&s.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},c.connect(d),d.connect(i.destination),this.privMediaResources={scriptProcessorNode:d,source:c,stream:n}}).catch(()=>{u()})}else try{u()}catch(d){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${d}`)}}releaseMediaResources(i){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(i.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(n=>n.stop()),this.privMediaResources.source=null))}setWorkletUrl(i){this.privSpeechProcessorScript=i}}return Kr.PcmRecorder=t,Kr}var Gr={},ye={},pl;function Dg(){if(pl)return ye;pl=1;var e=ye&&ye.__createBinding||(Object.create?(function(h,l,f,m){m===void 0&&(m=f),Object.defineProperty(h,m,{enumerable:!0,get:function(){return l[f]}})}):(function(h,l,f,m){m===void 0&&(m=f),h[m]=l[f]})),t=ye&&ye.__setModuleDefault||(Object.create?(function(h,l){Object.defineProperty(h,"default",{enumerable:!0,value:l})}):function(h,l){h.default=l}),r=ye&&ye.__importStar||function(h){if(h&&h.__esModule)return h;var l={};if(h!=null)for(var f in h)f!=="default"&&Object.prototype.hasOwnProperty.call(h,f)&&e(l,h,f);return t(l,h),l},i=ye&&ye.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.WebsocketMessageAdapter=void 0;const n=r(Yt),s=r(Yt),a=i(Yt),o=i(Yt),c=i(Yt),u=Ee(),p=F();let d=class Ic{constructor(l,f,m,P,g,w){if(!l)throw new p.ArgumentNullError("uri");if(!m)throw new p.ArgumentNullError("messageFormatter");this.proxyInfo=P,this.privConnectionEvents=new p.EventSource,this.privConnectionId=f,this.privMessageFormatter=m,this.privConnectionState=p.ConnectionState.None,this.privUri=l,this.privHeaders=g,this.privEnableCompression=w,this.privHeaders[u.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===p.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new p.Deferred,this.privCertificateValidatedDeferral=new p.Deferred,this.privConnectionState=p.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!Ic.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let f=new URL(this.privUri).protocol;(f==null?void 0:f.toLocaleLowerCase())==="wss:"?f="https:":(f==null?void 0:f.toLocaleLowerCase())==="ws:"&&(f="http:");const m={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:f.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),m.agent=this.getAgent(),m.agent.protocol=f,this.privWebsocketClient=new c.default(this.privUri,m),this.privWebsocketClient.on("redirect",P=>{const g=new p.ConnectionRedirectEvent(this.privConnectionId,P,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${P}'`);p.Events.instance.onEvent(g)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new p.Queue,this.privDisconnectDeferral=new p.Deferred,this.privSendMessageQueue=new p.Queue,this.processSendQueue().catch(l=>{p.Events.instance.onEvent(new p.BackgroundEvent(l))})}catch(l){return this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(500,l)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new p.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=p.ConnectionState.Connected,this.onEvent(new p.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(200,""))},l=>{this.privConnectionEstablishDeferral.reject(l)})},this.privWebsocketClient.onerror=l=>{this.onEvent(new p.ConnectionErrorEvent(this.privConnectionId,l.message,l.type)),this.privLastErrorReceived=l.message},this.privWebsocketClient.onclose=l=>{this.privConnectionState===p.ConnectionState.Connecting?(this.privConnectionState=p.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(l.code,l.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=p.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new p.ConnectionClosedEvent(this.privConnectionId,l.code,l.reason))),this.onClose(l.code,l.reason).catch(f=>{p.Events.instance.onEvent(new p.BackgroundEvent(f))})},this.privWebsocketClient.onmessage=l=>{const f=new Date().toISOString();if(this.privConnectionState===p.ConnectionState.Connected){const m=new p.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(m.promise),l.data instanceof ArrayBuffer){const P=new p.RawWebsocketMessage(p.MessageType.Binary,l.data);this.privMessageFormatter.toConnectionMessage(P).then(g=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,f,g)),m.resolve(g)},g=>{m.reject(`Invalid binary message format. Error: ${g}`)})}else{const P=new p.RawWebsocketMessage(p.MessageType.Text,l.data);this.privMessageFormatter.toConnectionMessage(P).then(g=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,f,g)),m.resolve(g)},g=>{m.reject(`Invalid text message format. Error: ${g}`)})}}},this.privConnectionEstablishDeferral.promise}send(l){if(this.privConnectionState!==p.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${p.ConnectionState[this.privConnectionState]} state`);const f=new p.Deferred,m=new p.Deferred;return this.privSendMessageQueue.enqueueFromPromise(m.promise),this.privMessageFormatter.fromConnectionMessage(l).then(P=>{m.resolve({Message:l,RawWebsocketMessage:P,sendStatusDeferral:f})},P=>{m.reject(`Error formatting the message. ${P}`)}),f.promise}read(){return this.privConnectionState!==p.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(l){if(this.privWebsocketClient)this.privConnectionState!==p.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,l||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(l){try{if(!l)return Promise.resolve();if(this.onEvent(new p.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),l.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(l.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+l.Message.id+" "+new Error().stack);return Promise.resolve()}catch(f){return Promise.reject(`websocket send error: ${f}`)}}async onClose(l,f){const m=`Connection closed. ${l}: ${f}`;this.privConnectionState=p.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},m),await this.privSendMessageQueue.drainAndDispose(P=>{P.sendStatusDeferral.reject(m)},m)}async processSendQueue(){for(;;){const f=await this.privSendMessageQueue.dequeue();if(!f)return;try{await this.sendRawMessage(f),f.sendStatusDeferral.resolve()}catch(m){f.sendStatusDeferral.reject(m)}}}onEvent(l){this.privConnectionEvents.onEvent(l),p.Events.instance.onEvent(l)}getAgent(){const l=new a.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(l.proxyInfo=this.proxyInfo),l}static GetProxyAgent(l){const f={host:l.HostName,port:l.Port};return l.UserName?f.headers={"Proxy-Authentication":"Basic "+Buffer.from(`${l.UserName}:${l.Password===void 0?"":l.Password}`).toString("base64")}:f.headers={},f.headers.requestOCSP="true",new o.default(f)}createConnection(l,f){let m;if(f={...f,requestOCSP:!0,servername:f.host},this.proxyInfo){const g=Ic.GetProxyAgent(this.proxyInfo);m=new Promise((w,R)=>{g.callback(l,f,(A,I)=>{A?R(A):w(I)})})}else f.secureEndpoint?m=Promise.resolve(s.connect(f)):m=Promise.resolve(n.connect(f));return m}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return ye.WebsocketMessageAdapter=d,d.forceNpmWebSocket=!1,ye}var dl;function LP(){if(dl)return Gr;dl=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.WebsocketConnection=void 0;const e=F(),t=Dg();let r=class{constructor(n,s,a,o,c,u=!1,p){if(this.privIsDisposed=!1,!n)throw new e.ArgumentNullError("uri");if(!o)throw new e.ArgumentNullError("messageFormatter");this.privMessageFormatter=o;let d="",h=0;if(s){for(const l in s)if(l){d+=h===0&&n.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(l);d+=f;let m=s[l];m&&(m=encodeURIComponent(m),d+=`=${m}`),h++}}if(a){for(const l in a)if(l){d+=h===0&&n.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(a[l]);d+=`${l}=${f}`,h++}}this.privUri=n+d,this.privId=p||(0,e.createNoDashGuid)(),this.privConnectionMessageAdapter=new t.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,c,a,u)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(n){return this.privConnectionMessageAdapter.send(n)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return Gr.WebsocketConnection=r,Gr}var Jr={},ll;function FP(){if(ll)return Jr;ll=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.ReplayableAudioNode=void 0;let e=class{constructor(i,n){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=i,this.privBytesPerSecond=n}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const i=this.privReplayOffset-this.privBufferStartOffset;let n=Math.round(i*this.privBytesPerSecond*1e-7);n%2!==0&&n++;let s=0;for(;s<this.privBuffers.length&&n>=this.privBuffers[s].chunk.buffer.byteLength;)n-=this.privBuffers[s++].chunk.buffer.byteLength;if(s<this.privBuffers.length){const a=this.privBuffers[s].chunk.buffer.slice(n);return this.privReplayOffset+=a.byteLength/this.privBytesPerSecond*1e7,s===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:a,isEnd:!1,timeReceived:this.privBuffers[s].chunk.timeReceived})}}return this.privAudioNode.read().then(i=>(i&&i.buffer&&this.privBuffers&&(this.privBuffers.push(new t(i,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=i.buffer.byteLength),i))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(i){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=i;const n=i-this.privBufferStartOffset;let s=Math.round(n*this.privBytesPerSecond*1e-7),a=0;for(;a<this.privBuffers.length&&s>=this.privBuffers[a].chunk.buffer.byteLength;)s-=this.privBuffers[a++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(i-s/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(a)}findTimeAtOffset(i){if(i<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const n of this.privBuffers){const s=n.byteOffset/this.privBytesPerSecond*1e7,a=s+n.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(i>=s&&i<=a)return n.chunk.timeReceived}return 0}};Jr.ReplayableAudioNode=e;class t{constructor(i,n,s){this.chunk=i,this.serial=n,this.byteOffset=s}}return Jr}var Qr={},Ta={},Ze={},ke={},hl;function kg(){if(hl)return ke;hl=1;var e=ke&&ke.__createBinding||(Object.create?(function(a,o,c,u){u===void 0&&(u=c),Object.defineProperty(a,u,{enumerable:!0,get:function(){return o[c]}})}):(function(a,o,c,u){u===void 0&&(u=c),a[u]=o[c]})),t=ke&&ke.__setModuleDefault||(Object.create?(function(a,o){Object.defineProperty(a,"default",{enumerable:!0,value:o})}):function(a,o){a.default=o}),r=ke&&ke.__importStar||function(a){if(a&&a.__esModule)return a;var o={};if(a!=null)for(var c in a)c!=="default"&&Object.prototype.hasOwnProperty.call(a,c)&&e(o,a,c);return t(o,a),o};Object.defineProperty(ke,"__esModule",{value:!0}),ke.AudioFileWriter=void 0;const i=r(Yt),n=$();let s=class{constructor(o){n.Contracts.throwIfNullOrUndefined(i.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=i.openSync(o,"w")}set format(o){n.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=o;let c=0;this.privAudioFormat.hasHeader&&(c=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=i.createWriteStream("",{fd:this.privFd,start:c,autoClose:!1}))}write(o){n.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(o.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),i.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),i.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return ke.AudioFileWriter=s,ke}var Pe={},vl;function Ng(){if(vl)return Pe;vl=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.PullAudioInputStreamImpl=Pe.PullAudioInputStream=Pe.PushAudioInputStreamImpl=Pe.PushAudioInputStream=Pe.AudioInputStream=void 0;const e=L(),t=F(),r=Xt(),i=O(),n=er();let s=class{constructor(){}static createPushStream(d){return a.create(d)}static createPullStream(d,h){return c.create(d,h)}};Pe.AudioInputStream=s;class a extends s{static create(d){return new o(d)}}Pe.PushAudioInputStream=a;class o extends a{constructor(d){super(),d===void 0?this.privFormat=n.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=d,this.privEvents=new t.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privStream=new t.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(d){this.privStream.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(d){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn();const h=this.privStream;return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:async()=>(this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>h.read()}}detach(d){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),t.Events.instance.onEvent(d)}toBuffer(d){const h=Buffer.alloc(d.byteLength),l=new Uint8Array(d);for(let f=0;f<h.length;++f)h[f]=l[f];return h}}Pe.PushAudioInputStreamImpl=o;class c extends s{constructor(){super()}static create(d,h){return new u(d,h)}}Pe.PullAudioInputStream=c;class u extends c{constructor(d,h){super(),h===void 0?this.privFormat=i.AudioStreamFormat.getDefaultInputFormat():this.privFormat=h,this.privEvents=new t.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privCallback=d,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(d){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn(),this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:()=>(this.privCallback.close(),this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>{let h=0,l;for(;h<this.privBufferSize;){const f=new ArrayBuffer(this.privBufferSize-h),m=this.privCallback.read(f);if(l===void 0?l=f:new Int8Array(l).set(new Int8Array(f),h),m===0)break;h+=m}return Promise.resolve({buffer:l.slice(0,h),isEnd:this.privIsClosed||h===0,timeReceived:Date.now()})}}}detach(d){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),t.Events.instance.onEvent(d)}}return Pe.PullAudioInputStreamImpl=u,Pe}var we={},Yr={},ba={},fl;function jg(){return fl||(fl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisOutputFormat=void 0,(function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(e.SpeechSynthesisOutputFormat||(e.SpeechSynthesisOutputFormat={}))})(ba)),ba}var gl;function Io(){if(gl)return Yr;gl=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.AudioOutputFormatImpl=void 0;const e=jg(),t=er();class r extends t.AudioStreamFormatImpl{constructor(n,s,a,o,c,u,p,d,h){super(a,u,s,n),this.formatTag=n,this.avgBytesPerSec=o,this.blockAlign=c,this.priAudioFormatString=p,this.priRequestAudioFormatString=d,this.priHasHeader=h}static fromSpeechSynthesisOutputFormat(n){return n===void 0?r.getDefaultOutputFormat():r.fromSpeechSynthesisOutputFormatString(r.SpeechSynthesisOutputFormatToString[n])}static fromSpeechSynthesisOutputFormatString(n){switch(n){case"raw-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,n,n,!1);case"riff-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,n,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,n,n,!1);case"audio-16khz-32kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,4096,2,16,n,n,!1);case"audio-16khz-128kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,16384,2,16,n,n,!1);case"audio-16khz-64kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,8192,2,16,n,n,!1);case"audio-24khz-48kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,6144,2,16,n,n,!1);case"audio-24khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,12288,2,16,n,n,!1);case"audio-24khz-160kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,20480,2,16,n,n,!1);case"raw-16khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,n,n,!1);case"riff-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,n,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,n,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,n,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,n,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,n,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,n,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,n,n,!1);case"ogg-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,n,n,!1);case"raw-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,n,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,n,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,12288,2,16,n,n,!1);case"audio-48khz-192kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,24576,2,16,n,n,!1);case"ogg-48khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,n,n,!1);case"webm-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,n,n,!1);case"webm-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,n,n,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,n,n,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,16e3,4e3,2,16,n,n,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,6e3,2,16,n,n,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,3e3,2,16,n,n,!1);case"audio-24khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,24e3,24e3,2,16,n,n,!1);case"audio-48khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,48e3,3e4,2,16,n,n,!1);case"raw-24khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,n,n,!1);case"raw-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,n,n,!1);case"riff-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,n,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,n,n,!1);case"riff-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,n,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,n,n,!1);case"riff-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,n,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new r(t.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,n,n,!1);case"g722-16khz-64kbps":return new r(t.AudioFormatTag.G722,1,16e3,8e3,2,16,n,n,!1);case"riff-16khz-16bit-mono-pcm":default:return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return r.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(n){if(this.priHasHeader){const s=new DataView(this.privHeader);s.setUint32(4,n+this.privHeader.byteLength-8,!0),s.setUint32(40,n,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(n){if(!this.hasHeader)return n;this.updateHeader(n.byteLength);const s=new Uint8Array(n.byteLength+this.header.byteLength);return s.set(new Uint8Array(this.header),0),s.set(new Uint8Array(n),this.header.byteLength),s.buffer}}return Yr.AudioOutputFormatImpl=r,r.SpeechSynthesisOutputFormatToString={[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[e.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},Yr}var ml;function lr(){if(ml)return we;ml=1,Object.defineProperty(we,"__esModule",{value:!0}),we.PushAudioOutputStreamImpl=we.PushAudioOutputStream=we.PullAudioOutputStreamImpl=we.PullAudioOutputStream=we.AudioOutputStream=void 0;const e=F(),t=$(),r=Io();let i=class{constructor(){}static createPullStream(){return n.create()}};we.AudioOutputStream=i;class n extends i{static create(){return new s}}we.PullAudioOutputStream=n;class s extends n{constructor(){super(),this.privId=(0,e.createNoDashGuid)(),this.privStream=new e.Stream}set format(u){u==null&&(this.privFormat=r.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=u}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(u){const p=new Int8Array(u);let d=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>u.byteLength)return p.set(this.privLastChunkView.slice(0,u.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(u.byteLength),Promise.resolve(u.byteLength);p.set(this.privLastChunkView),d=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;d<u.byteLength&&!this.privStream.isReadEnded;){const h=await this.privStream.read();if(h!==void 0&&!h.isEnd){let l;h.buffer.byteLength>u.byteLength-d?(l=h.buffer.slice(0,u.byteLength-d),this.privLastChunkView=new Int8Array(h.buffer.slice(u.byteLength-d))):l=h.buffer,p.set(new Int8Array(l),d),d+=l.byteLength}else this.privStream.readEnded()}return d}write(u){t.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:u,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}we.PullAudioOutputStreamImpl=s;class a extends i{constructor(){super()}static create(u){return new o(u)}}we.PushAudioOutputStream=a;class o extends a{constructor(u){super(),this.privId=(0,e.createNoDashGuid)(),this.privCallback=u}set format(u){}write(u){this.privCallback.write&&this.privCallback.write(u)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return we.PushAudioOutputStreamImpl=o,we}var Sl;function qP(){if(Sl)return Ze;Sl=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.AudioOutputConfigImpl=Ze.AudioConfigImpl=Ze.AudioConfig=void 0;const e=Se(),t=$(),r=O(),i=kg(),n=Ng(),s=lr();let a=class zg{static fromDefaultMicrophoneInput(){const p=new e.PcmRecorder(!0);return new o(new e.MicAudioSource(p))}static fromMicrophoneInput(p){const d=new e.PcmRecorder(!0);return new o(new e.MicAudioSource(d,p))}static fromWavFileInput(p,d="unnamedBuffer.wav"){return new o(new e.FileAudioSource(p,d))}static fromStreamInput(p){if(p instanceof r.PullAudioInputStreamCallback)return new o(new n.PullAudioInputStreamImpl(p));if(p instanceof r.AudioInputStream)return new o(p);if(typeof MediaStream<"u"&&p instanceof MediaStream){const d=new e.PcmRecorder(!1);return new o(new e.MicAudioSource(d,null,null,p))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new c(new r.SpeakerAudioDestination)}static fromSpeakerOutput(p){if(p===void 0)return zg.fromDefaultSpeakerOutput();if(p instanceof r.SpeakerAudioDestination)return new c(p);throw new Error("Not Supported Type")}static fromAudioFileOutput(p){return new c(new i.AudioFileWriter(p))}static fromStreamOutput(p){if(p instanceof r.PushAudioOutputStreamCallback)return new c(new s.PushAudioOutputStreamImpl(p));if(p instanceof r.PushAudioOutputStream)return new c(p);if(p instanceof r.PullAudioOutputStream)return new c(p);throw new Error("Not Supported Type")}};Ze.AudioConfig=a;class o extends a{constructor(p){super(),this.privSource=p}get format(){return this.privSource.format}close(p,d){this.privSource.turnOff().then(()=>{p&&p()},h=>{d&&d(h)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(p){return this.privSource.attach(p)}detach(p){return this.privSource.detach(p)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(p,d){if(t.Contracts.throwIfNull(d,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,d);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(p,d){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,d);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}Ze.AudioConfigImpl=o;class c extends a{constructor(p){super(),this.privDestination=p}set format(p){this.privDestination.format=p}write(p){this.privDestination.write(p)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return Ze.AudioOutputConfigImpl=c,Ze}var Ia={},Cl;function BP(){return Cl||(Cl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationReason=void 0,(function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"})(e.CancellationReason||(e.CancellationReason={}))})(Ia)),Ia}var Zr={},yl;function UP(){if(yl)return Zr;yl=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.PullAudioInputStreamCallback=void 0;let e=class{};return Zr.PullAudioInputStreamCallback=e,Zr}var Xr={},Pl;function xP(){if(Pl)return Xr;Pl=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.PushAudioOutputStreamCallback=void 0;let e=class{};return Xr.PushAudioOutputStreamCallback=e,Xr}var en={},wl;function HP(){if(wl)return en;wl=1,Object.defineProperty(en,"__esModule",{value:!0}),en.KeywordRecognitionModel=void 0;const e=$();let t=class{constructor(){this.privDisposed=!1}static fromFile(i){throw e.Contracts.throwIfFileDoesNotExist(i,"fileName"),new Error("Not yet implemented.")}static fromStream(i){throw e.Contracts.throwIfNull(i,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return en.KeywordRecognitionModel=t,en}var tn={},Rl;function $P(){if(Rl)return tn;Rl=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.SessionEventArgs=void 0;let e=class{constructor(r){this.privSessionId=r}get sessionId(){return this.privSessionId}};return tn.SessionEventArgs=e,tn}var rn={},El;function WP(){if(El)return rn;El=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.RecognitionEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{constructor(i,n){super(n),this.privOffset=i}get offset(){return this.privOffset}};return rn.RecognitionEventArgs=t,rn}var _a={},Al;function VP(){return Al||(Al=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OutputFormat=void 0,(function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"})(e.OutputFormat||(e.OutputFormat={}))})(_a)),_a}var nn={},Tl;function KP(){if(Tl)return nn;Tl=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.RecognitionResult=void 0;let e=class{constructor(r,i,n,s,a,o,c,u,p,d){this.privResultId=r,this.privReason=i,this.privText=n,this.privDuration=s,this.privOffset=a,this.privLanguage=o,this.privLanguageDetectionConfidence=c,this.privErrorDetails=u,this.privJson=p,this.privProperties=d}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return nn.RecognitionResult=e,nn}var on={},bl;function GP(){if(bl)return on;bl=1,Object.defineProperty(on,"__esModule",{value:!0}),on.SpeechRecognitionResult=void 0;const e=O();let t=class extends e.RecognitionResult{constructor(i,n,s,a,o,c,u,p,d,h,l){super(i,n,s,a,o,c,u,d,h,l),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return on.SpeechRecognitionResult=t,on}var Xe={},Il;function JP(){if(Il)return Xe;Il=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.MeetingTranscriptionEventArgs=Xe.ConversationTranscriptionEventArgs=Xe.SpeechRecognitionEventArgs=void 0;const e=O();let t=class extends e.RecognitionEventArgs{constructor(s,a,o){super(a,o),this.privResult=s}get result(){return this.privResult}};Xe.SpeechRecognitionEventArgs=t;class r extends e.RecognitionEventArgs{constructor(s,a,o){super(a,o),this.privResult=s}get result(){return this.privResult}}Xe.ConversationTranscriptionEventArgs=r;class i extends t{}return Xe.MeetingTranscriptionEventArgs=i,Xe}var sn={},an={},_l;function _o(){if(_l)return an;_l=1,Object.defineProperty(an,"__esModule",{value:!0}),an.CancellationEventArgsBase=void 0;const e=O();let t=class extends e.RecognitionEventArgs{constructor(i,n,s,a,o){super(a,o),this.privReason=i,this.privErrorDetails=n,this.privErrorCode=s}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return an.CancellationEventArgsBase=t,an}var Ol;function QP(){if(Ol)return sn;Ol=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.SpeechRecognitionCanceledEventArgs=void 0;const e=_o();let t=class extends e.CancellationEventArgsBase{};return sn.SpeechRecognitionCanceledEventArgs=t,sn}var cn={},Ml;function YP(){if(Ml)return cn;Ml=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.TranslationRecognitionEventArgs=void 0;const e=O();let t=class extends e.RecognitionEventArgs{constructor(i,n,s){super(n,s),this.privResult=i}get result(){return this.privResult}};return cn.TranslationRecognitionEventArgs=t,cn}var un={},Dl;function ZP(){if(Dl)return un;Dl=1,Object.defineProperty(un,"__esModule",{value:!0}),un.TranslationSynthesisEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{constructor(i,n){super(n),this.privResult=i}get result(){return this.privResult}};return un.TranslationSynthesisEventArgs=t,un}var pn={},kl;function Fg(){if(kl)return pn;kl=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.TranslationRecognitionResult=void 0;const e=O();let t=class Lg extends e.SpeechRecognitionResult{constructor(i,n,s,a,o,c,u,p,d,h,l){super(n,s,a,o,c,u,p,void 0,d,h,l),this.privTranslations=i}static fromSpeechRecognitionResult(i){return new Lg(void 0,i.resultId,i.reason,i.text,i.duration,i.offset,i.language,i.languageDetectionConfidence,i.errorDetails,i.json,i.properties)}get translations(){return this.privTranslations}};return pn.TranslationRecognitionResult=t,pn}var dn={},Nl;function XP(){if(Nl)return dn;Nl=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.TranslationSynthesisResult=void 0;let e=class{constructor(r,i){this.privReason=r,this.privAudio=i}get audio(){return this.privAudio}get reason(){return this.privReason}};return dn.TranslationSynthesisResult=e,dn}var Oa={},jl;function ew(){return jl||(jl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultReason=void 0,(function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.TranslatingSpeech=5]="TranslatingSpeech",t[t.TranslatedSpeech=6]="TranslatedSpeech",t[t.SynthesizingAudio=7]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=8]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=9]="SynthesizingAudioStarted",t[t.VoicesListRetrieved=10]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=11]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=12]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=13]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=14]="TranslatedParticipantInstantMessage"})(e.ResultReason||(e.ResultReason={}))})(Oa)),Oa}var jt={},zl;function tw(){if(zl)return jt;zl=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.SpeechConfigImpl=jt.SpeechConfig=void 0;const e=L(),t=$(),r=O();let i=class{constructor(){}static fromSubscription(a,o){t.Contracts.throwIfNullOrWhitespace(a,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(o,"region");const c=new n;return c.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),c}static fromEndpoint(a,o){t.Contracts.throwIfNull(a,"endpoint");const c=typeof o=="string"&&o.trim().length>0,u=typeof o=="object"&&o!==null&&typeof o.getToken=="function",p=typeof o=="object"&&o!==null&&typeof o.key=="string";if(o!==void 0&&!c&&!u&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let d;return typeof o=="string"?(d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Key,o)):typeof o=="object"&&typeof o.getToken=="function"?d=new n(o):typeof o=="object"&&typeof o.key=="string"?(d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Key,o.key)):d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.href),d}static fromHost(a,o){t.Contracts.throwIfNull(a,"hostName");const c=new n;return c.setProperty(r.PropertyId.SpeechServiceConnection_Host,a.protocol+"//"+a.hostname+(a.port===""?"":":"+a.port)),c.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),o!==void 0&&c.setProperty(r.PropertyId.SpeechServiceConnection_Key,o),c}static fromAuthorizationToken(a,o){t.Contracts.throwIfNull(a,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(o,"region");const c=new n;return c.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c.authorizationToken=a,c}close(){}};jt.SpeechConfig=i;class n extends i{constructor(a){super(),this.privProperties=new r.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=a}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,a)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,a)}get outputFormat(){return r.OutputFormat[this.privProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(a){this.privProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[a])}get endpointId(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,a)}get tokenCredential(){return this.privTokenCredential}setProperty(a,o){t.Contracts.throwIfNull(o,"value"),this.privProperties.setProperty(a,o)}getProperty(a,o){return this.privProperties.getProperty(a,o)}setProxy(a,o,c,u){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],a),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],o),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],c),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],u)}setServiceProperty(a,o){const c=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));c[a]=o,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(c))}setProfanity(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[a])}enableAudioLogging(){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(e.ForceDictationPropertyName,"true")}clone(){const a=new n(this.tokenCredential);return a.privProperties=this.privProperties.clone(),a}get speechSynthesisLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,a)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,a)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[a])}}return jt.SpeechConfigImpl=n,jt}var zt={},Ll;function rw(){if(Ll)return zt;Ll=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.SpeechTranslationConfigImpl=zt.SpeechTranslationConfig=void 0;const e=L(),t=$(),r=O();let i=class extends r.SpeechConfig{constructor(){super()}static fromSubscription(a,o){t.Contracts.throwIfNullOrWhitespace(a,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(o,"region");const c=new n;return c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c}static fromAuthorizationToken(a,o){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(o,"region");const c=new n;return c.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c}static fromHost(a,o){t.Contracts.throwIfNull(a,"hostName");const c=new n;return c.setProperty(r.PropertyId.SpeechServiceConnection_Host,a.protocol+"//"+a.hostname+(a.port===""?"":":"+a.port)),o!==void 0&&c.setProperty(r.PropertyId.SpeechServiceConnection_Key,o),c}static fromEndpoint(a,o){t.Contracts.throwIfNull(a,"endpoint");const c=typeof o=="string"&&o.trim().length>0,u=typeof o=="object"&&o!==null&&typeof o.getToken=="function",p=typeof o=="object"&&o!==null&&typeof o.key=="string";if(o!==void 0&&!c&&!u&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let d;return typeof o=="string"?(d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Key,o)):typeof o=="object"&&typeof o.getToken=="function"?d=new n(o):typeof o=="object"&&typeof o.key=="string"?(d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Key,o.key)):d=new n,d.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.href),d}};zt.SpeechTranslationConfig=i;class n extends i{constructor(a){super(),this.privSpeechProperties=new r.PropertyCollection,this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=a}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}set speechRecognitionLanguage(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,a)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return r.OutputFormat[this.privSpeechProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(a){this.privSpeechProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[a])}get endpointId(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,a)}addTargetLanguage(a){t.Contracts.throwIfNullOrWhitespace(a,"value");const o=this.targetLanguages;o.includes(a)||(o.push(a),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,o.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,a)}get region(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(a,o,c,u){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],a),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],o),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],c),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],u)}getProperty(a,o){return this.privSpeechProperties.getProperty(a,o)}setProperty(a,o){this.privSpeechProperties.setProperty(a,o)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(a,o){const c=JSON.parse(this.privSpeechProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));c[a]=o,this.privSpeechProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(c))}setProfanity(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[a])}enableAudioLogging(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(e.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,a)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,a)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[a])}}return zt.SpeechTranslationConfigImpl=n,zt}var ln={},Fl;function Bg(){if(Fl)return ln;Fl=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.PropertyCollection=void 0;const e=O();let t=class qg{constructor(){this.privKeys=[],this.privValues=[]}getProperty(i,n){let s;typeof i=="string"?s=i:s=e.PropertyId[i];for(let a=0;a<this.privKeys.length;a++)if(this.privKeys[a]===s)return this.privValues[a];if(n!==void 0)return String(n)}setProperty(i,n){let s;typeof i=="string"?s=i:s=e.PropertyId[i];for(let a=0;a<this.privKeys.length;a++)if(this.privKeys[a]===s){this.privValues[a]=n;return}this.privKeys.push(s),this.privValues.push(n)}clone(){const i=new qg;for(let n=0;n<this.privKeys.length;n++)i.privKeys.push(this.privKeys[n]),i.privValues.push(this.privValues[n]);return i}mergeTo(i){this.privKeys.forEach(n=>{if(i.getProperty(n,void 0)===void 0){const s=this.getProperty(n);i.setProperty(n,s)}})}get keys(){return this.privKeys}};return ln.PropertyCollection=t,ln}var Ma={},ql;function ep(){return ql||(ql=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyId=void 0,(function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.SpeechServiceConnection_Url=28]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=29]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=30]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=31]="Speech_SegmentationSilenceTimeoutMs",t[t.Speech_SegmentationMaximumTimeMs=32]="Speech_SegmentationMaximumTimeMs",t[t.Speech_SegmentationStrategy=33]="Speech_SegmentationStrategy",t[t.Speech_StartEventSensitivity=34]="Speech_StartEventSensitivity",t[t.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceResponse_ProfanityOption=38]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=39]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=40]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=41]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=42]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=43]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=44]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=45]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=46]="SpeechServiceResponse_RequestSentenceBoundary",t[t.SpeechServiceResponse_DiarizeIntermediateResults=47]="SpeechServiceResponse_DiarizeIntermediateResults",t[t.Conversation_ApplicationId=48]="Conversation_ApplicationId",t[t.Conversation_DialogType=49]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=50]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=51]="Conversation_From_Id",t[t.Conversation_Conversation_Id=52]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=53]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=54]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=55]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=56]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=57]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=58]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=59]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=60]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=61]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=62]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=63]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=64]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=65]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=66]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=67]="PronunciationAssessment_Params",t[t.WebWorkerLoadType=68]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=69]="TalkingAvatarService_WebRTC_SDP"})(e.PropertyId||(e.PropertyId={}))})(Ma)),Ma}var hn={},Bl;function nw(){if(Bl)return hn;Bl=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.Recognizer=void 0;const e=L(),t=F(),r=$(),i=O();let n=class Ug{constructor(a,o,c,u){this.audioConfig=a!==void 0?a:i.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=o.clone(),this.privConnectionFactory=c,this.tokenCredential=u,this.implCommonRecognizerSetup()}close(a,o){r.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,o)}get internalData(){return this.privReco}async dispose(a){this.privDisposed||(this.privDisposed=!0,a&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return e.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(a){e.ServiceRecognizerBase.telemetryDataEnabled=a}implCommonRecognizerSetup(){let a=typeof window<"u"?"Browser":"Node",o="unknown",c="unknown";typeof navigator<"u"&&(a=a+"/"+navigator.platform,o=navigator.userAgent,c=navigator.appVersion);const u=this.createRecognizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(a,o,c))));this.privReco=this.createServiceRecognizer(Ug.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,u)}async recognizeOnceAsyncImpl(a){r.Contracts.throwIfDisposed(this.privDisposed);const o=new t.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(a,o.resolve,o.reject);const c=await o.promise;return await this.implRecognizerStop(),c}async startContinuousRecognitionAsyncImpl(a){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(a,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(a,o){const c=a.getProperty(i.PropertyId.SpeechServiceConnection_Key,void 0);return c&&c!==""?new e.CognitiveSubscriptionKeyAuthentication(c):o?new e.CognitiveTokenAuthentication(async()=>{try{const u=await o.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}},async()=>{try{const u=await o.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}}):new e.CognitiveTokenAuthentication(()=>{const u=a.getProperty(i.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)},()=>{const u=a.getProperty(i.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)})}};return hn.Recognizer=n,hn}var vn={},Da={},Ul;function Be(){return Ul||(Ul=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechStartEventSensitivity=e.RecognitionMode=void 0,(function(t){t.Interactive="Interactive",t.Dictation="Dictation",t.Conversation="Conversation",t.None="None"})(e.RecognitionMode||(e.RecognitionMode={})),(function(t){t.Low="low",t.Medium="medium",t.High="high"})(e.SpeechStartEventSensitivity||(e.SpeechStartEventSensitivity={}))})(Da)),Da}var xl;function iw(){if(xl)return vn;xl=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.SpeechRecognizer=void 0;const e=L(),t=Be(),r=F(),i=$(),n=O();let s=class xg extends n.Recognizer{constructor(o,c){const u=o;i.Contracts.throwIfNull(u,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage),n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new e.SpeechConnectionFactory,o.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(o,c,u){const p=o;return c.properties.mergeTo(p.properties),new xg(o,u)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){i.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple])===n.OutputFormat[n.OutputFormat.Simple]?n.OutputFormat.Simple:n.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(o,c){(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),o,c)}startContinuousRecognitionAsync(o,c){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(e.ForceDictationPropertyName,void 0)===void 0?t.RecognitionMode.Conversation:t.RecognitionMode.Dictation),o,c)}stopContinuousRecognitionAsync(o,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),o,c)}startKeywordRecognitionAsync(o,c,u){i.Contracts.throwIfNull(o,"model"),u&&u("Not yet implemented.")}stopKeywordRecognitionAsync(o){o&&o()}close(o,c){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),o,c)}async dispose(o){this.privDisposedRecognizer||(o&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(o))}createRecognizerConfig(o){return new e.RecognizerConfig(o,this.privProperties)}createServiceRecognizer(o,c,u,p){const d=u;return new e.SpeechServiceRecognizer(o,c,d,p,this)}};return vn.SpeechRecognizer=s,vn}var fn={},gn={},Lt={},Hl;function Hg(){if(Hl)return Lt;Hl=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.ConnectionMessageImpl=Lt.ConnectionMessage=void 0;const e=Ee(),t=F(),r=Bg(),i=ep();let n=class{};Lt.ConnectionMessage=n;class s{constructor(o){this.privConnectionMessage=o,this.privProperties=new r.PropertyCollection,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]&&this.privProperties.setProperty(i.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(c=>{this.privProperties.setProperty(c,this.privConnectionMessage.headers[c])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(o=>o.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===t.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===t.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return Lt.ConnectionMessageImpl=s,Lt}var $l;function $g(){if($l)return gn;$l=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.Connection=void 0;const e=L(),t=F(),r=Hg(),i=$(),n=O();let s=class _c{static fromRecognizer(o){const c=o.internalData,u=new _c;return u.privInternalData=c,u.setupEvents(),u}static fromSynthesizer(o){const c=o.internalData,u=new _c;return u.privInternalData=c,u.setupEvents(),u}openConnection(o,c){(0,t.marshalPromiseToCallbacks)(this.privInternalData.connect(),o,c)}closeConnection(o,c){if(this.privInternalData instanceof e.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,t.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),o,c)}setMessageProperty(o,c,u){if(i.Contracts.throwIfNullOrWhitespace(c,"propertyName"),this.privInternalData instanceof e.ServiceRecognizerBase){if(o.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const p=this.privInternalData.speechContext.getContext();p[c]=u}}else if(this.privInternalData instanceof e.SynthesisAdapterBase){if(o.toLowerCase()!=="speech.config"&&o.toLowerCase()!=="synthesis.context")throw new Error("Only speech.config and synthesis.context message paths are currently supported for synthesizer");if(o.toLowerCase()==="speech.config"){if(c.toLowerCase()!=="context")throw new Error("Only context property is currently supported for speech.config message path for synthesizer");this.privInternalData.synthesizerConfig.setContextFromJson(u)}else this.privInternalData.synthesisContext.setSection(c,u)}}sendMessageAsync(o,c,u,p){(0,t.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(o,c),u,p)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(o=>{o.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new n.ConnectionEventArgs(o.connectionId)):o.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new n.ConnectionEventArgs(o.connectionId)):o.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new n.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(o.message))):o.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new n.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(o.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(o=>{this.receivedServiceMessage&&this.receivedServiceMessage(new n.ServiceEventArgs(o.jsonString,o.name))})}};return gn.Connection=s,gn}var Wl;function ow(){if(Wl)return fn;Wl=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.TranslationRecognizer=void 0;const e=L(),t=Be(),r=F(),i=$g(),n=$(),s=O();let a=class Wg extends s.Recognizer{constructor(c,u,p){const d=c;n.Contracts.throwIfNull(d,"speechConfig"),super(u,d.properties,p||new e.TranslationConnectionFactory,c.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationVoice]),n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationToLanguages]),n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(c,u,p){const d=c;return u.properties.mergeTo(d.properties),u.properties.getProperty(s.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===e.AutoDetectSourceLanguagesOpenRangeOptionName&&d.properties.setProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new Wg(c,p)}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,c)}recognizeOnceAsync(c,u){n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),c,u)}startContinuousRecognitionAsync(c,u){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),c,u)}stopContinuousRecognitionAsync(c,u){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),c,u)}removeTargetLanguage(c){if(n.Contracts.throwIfNullOrUndefined(c,"language to be removed"),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),p=u.indexOf(c);p>-1&&(u.splice(p,1),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")),this.updateLanguages(u))}}addTargetLanguage(c){n.Contracts.throwIfNullOrUndefined(c,"language to be added");let u=[];this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u.includes(c)||(u.push(c),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")))):(this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,c),u=[c]),this.updateLanguages(u)}close(c,u){n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),c,u)}onConnection(){}async dispose(c){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,c&&(await this.implRecognizerStop(),await super.dispose(c)))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,p,d){const h=p;return new e.TranslationServiceRecognizer(c,u,h,d,this)}updateLanguages(c){const u=i.Connection.fromRecognizer(this);u&&(u.setMessageProperty("speech.context","translationcontext",{to:c}),u.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:c})))}};return fn.TranslationRecognizer=a,fn}var mn={},Vl;function sw(){if(Vl)return mn;Vl=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.Translations=void 0;const e=O();let t=class{constructor(){this.privMap=new e.PropertyCollection}get languages(){return this.privMap.keys}get(i,n){return this.privMap.getProperty(i,n)}set(i,n){this.privMap.setProperty(i,n)}};return mn.Translations=t,mn}var ka={},Kl;function aw(){return Kl||(Kl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchReason=void 0,(function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(e.NoMatchReason||(e.NoMatchReason={}))})(ka)),ka}var Sn={},Gl;function cw(){if(Gl)return Sn;Gl=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.NoMatchDetails=void 0;const e=L(),t=O();let r=class Vg{constructor(n){this.privReason=n}static fromResult(n){const s=e.SimpleSpeechPhrase.fromJSON(n.json,0);let a=t.NoMatchReason.NotRecognized;switch(s.RecognitionStatus){case e.RecognitionStatus.BabbleTimeout:a=t.NoMatchReason.InitialBabbleTimeout;break;case e.RecognitionStatus.InitialSilenceTimeout:a=t.NoMatchReason.InitialSilenceTimeout;break;default:a=t.NoMatchReason.NotRecognized;break}return new Vg(a)}get reason(){return this.privReason}};return Sn.NoMatchDetails=r,Sn}var Cn={},Jl;function uw(){if(Jl)return Cn;Jl=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.TranslationRecognitionCanceledEventArgs=void 0;let e=class{constructor(r,i,n,s,a){this.privCancelReason=i,this.privErrorDetails=n,this.privResult=a,this.privSessionId=r,this.privErrorCode=s}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Cn.TranslationRecognitionCanceledEventArgs=e,Cn}var yn={},Ql;function Kg(){if(Ql)return yn;Ql=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.CancellationDetailsBase=void 0;let e=class{constructor(r,i,n){this.privReason=r,this.privErrorDetails=i,this.privErrorCode=n}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return yn.CancellationDetailsBase=e,yn}var Pn={},Yl;function pw(){if(Yl)return Pn;Yl=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.CancellationDetails=void 0;const e=L(),t=Kg(),r=O();let i=class Gg extends t.CancellationDetailsBase{constructor(s,a,o){super(s,a,o)}static fromResult(s){let a=r.CancellationReason.Error,o=r.CancellationErrorCode.NoError;if(s instanceof r.RecognitionResult&&s.json){const c=e.SimpleSpeechPhrase.fromJSON(s.json,0);a=e.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus)}return s.properties&&(o=r.CancellationErrorCode[s.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new Gg(a,s.errorDetails||e.EnumTranslation.implTranslateErrorDetails(o),o)}};return Pn.CancellationDetails=i,Pn}var Na={},Zl;function dw(){return Zl||(Zl=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationErrorCode=void 0,(function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"})(e.CancellationErrorCode||(e.CancellationErrorCode={}))})(Na)),Na}var wn={},Xl;function lw(){if(Xl)return wn;Xl=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.ConnectionEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{};return wn.ConnectionEventArgs=t,wn}var Rn={},eh;function hw(){if(eh)return Rn;eh=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.ServiceEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{constructor(i,n,s){super(s),this.privJsonResult=i,this.privEventName=n}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Rn.ServiceEventArgs=t,Rn}var En={},th;function vw(){if(th)return En;th=1,Object.defineProperty(En,"__esModule",{value:!0}),En.PhraseListGrammar=void 0;const e=$();let t=class Jg{constructor(i){this.privGrammerBuilder=i.dynamicGrammar}static fromRecognizer(i){const n=i.internalData;return new Jg(n)}addPhrase(i){this.privGrammerBuilder.addPhrase(i)}addPhrases(i){this.privGrammerBuilder.addPhrase(i)}clear(){this.privGrammerBuilder.clearPhrases()}setWeight(i){e.Contracts.throwIfNumberOutOfRange(i,"weight",0,2),this.privGrammerBuilder.setWeight(i)}};return En.PhraseListGrammar=t,En}var Ft={},rh;function tp(){if(rh)return Ft;rh=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.DialogServiceConfigImpl=Ft.DialogServiceConfig=void 0;const e=$(),t=O();let r=class{constructor(){}set applicationId(s){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};Ft.DialogServiceConfig=r;class i extends r{constructor(){super(),this.privSpeechConfig=new t.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(s){e.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechConfig.speechRecognitionLanguage=s}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(s){this.privSpeechConfig.outputFormat=s}setProperty(s,a){this.privSpeechConfig.setProperty(s,a)}getProperty(s,a){return this.privSpeechConfig.getProperty(s)}setProxy(s,a,o,c){this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName,s),this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPort,`${a}`),o&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName,o),c&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword,c)}setServiceProperty(s,a,o){this.privSpeechConfig.setServiceProperty(s,a)}close(){}}return Ft.DialogServiceConfigImpl=i,Ft}var An={},nh;function fw(){if(nh)return An;nh=1,Object.defineProperty(An,"__esModule",{value:!0}),An.BotFrameworkConfig=void 0;const e=$(),t=tp(),r=O();let i=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,a,o){e.Contracts.throwIfNullOrWhitespace(s,"subscription"),e.Contracts.throwIfNullOrWhitespace(a,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,a),o&&c.setProperty(r.PropertyId.Conversation_ApplicationId,o),c}static fromAuthorizationToken(s,a,o){e.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,s),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,a),o&&c.setProperty(r.PropertyId.Conversation_ApplicationId,o),c}static fromHost(s,a,o){e.Contracts.throwIfNullOrUndefined(s,"host");const c=s instanceof URL?s:new URL(`wss://${s}.convai.speech.azure.us`);e.Contracts.throwIfNullOrUndefined(c,"resolvedHost");const u=new t.DialogServiceConfigImpl;return u.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),u.setProperty(r.PropertyId.SpeechServiceConnection_Host,c.toString()),a!==void 0&&u.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),u}static fromEndpoint(s,a){e.Contracts.throwIfNull(s,"endpoint");const o=new t.DialogServiceConfigImpl;return o.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),o.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,s.toString()),a!==void 0&&o.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),o}};return An.BotFrameworkConfig=i,An}var Tn={},ih;function gw(){if(ih)return Tn;ih=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.CustomCommandsConfig=void 0;const e=$(),t=tp(),r=O();let i=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,a,o){e.Contracts.throwIfNullOrWhitespace(s,"applicationId"),e.Contracts.throwIfNullOrWhitespace(a,"subscription"),e.Contracts.throwIfNullOrWhitespace(o,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),c.setProperty(r.PropertyId.Conversation_ApplicationId,s),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c}static fromAuthorizationToken(s,a,o){e.Contracts.throwIfNullOrWhitespace(s,"applicationId"),e.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(o,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),c.setProperty(r.PropertyId.Conversation_ApplicationId,s),c.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,o),c}set applicationId(s){e.Contracts.throwIfNullOrWhitespace(s,"value"),this.setProperty(r.PropertyId.Conversation_ApplicationId,s)}get applicationId(){return this.getProperty(r.PropertyId.Conversation_ApplicationId)}};return Tn.CustomCommandsConfig=i,Tn}var bn={},In={},_n={},On={},oh;function Pt(){if(oh)return On;oh=1,Object.defineProperty(On,"__esModule",{value:!0}),On.QueryParameterNames=void 0;let e=class{};return On.QueryParameterNames=e,e.BotId="botid",e.CustomSpeechDeploymentId="cid",e.CustomVoiceDeploymentId="deploymentId",e.EnableAudioLogging="storeAudio",e.EnableLanguageId="lidEnabled",e.EnableWordLevelTimestamps="wordLevelTimestamps",e.EndSilenceTimeoutMs="endSilenceTimeoutMs",e.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",e.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",e.SegmentationStrategy="segmentationStrategy",e.Format="format",e.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",e.Language="language",e.Profanity="profanity",e.RequestBotStatusMessages="enableBotMessageStatus",e.StableIntermediateThreshold="stableIntermediateThreshold",e.StableTranslation="stableTranslation",e.TestHooks="testhooks",e.Postprocessing="postprocessing",e.CtsMeetingId="meetingId",e.CtsDeviceId="deviceId",e.CtsIsParticipant="isParticipant",e.EnableAvatar="enableTalkingAvatar",On}var sh;function st(){if(sh)return _n;sh=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.ConnectionFactoryBase=void 0;const e=L(),t=F(),r=O(),i=Pt();let n=class{static getHostSuffix(a){if(a){if(a.toLowerCase().startsWith("china"))return".azure.cn";if(a.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(a,o,c){new Map([[r.PropertyId.Speech_SegmentationSilenceTimeoutMs,i.QueryParameterNames.SegmentationSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_EnableAudioLogging,i.QueryParameterNames.EnableAudioLogging],[r.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,i.QueryParameterNames.EndSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,i.QueryParameterNames.InitialSilenceTimeoutMs],[r.PropertyId.SpeechServiceResponse_PostProcessingOption,i.QueryParameterNames.Postprocessing],[r.PropertyId.SpeechServiceResponse_ProfanityOption,i.QueryParameterNames.Profanity],[r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,i.QueryParameterNames.EnableWordLevelTimestamps],[r.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,i.QueryParameterNames.StableIntermediateThreshold]]).forEach((d,h)=>{this.setUrlParameter(h,d,a,o,c)});const p=JSON.parse(a.parameters.getProperty(e.ServicePropertiesPropertyName,"{}"));Object.keys(p).forEach(d=>{o[d]=p[d]})}setUrlParameter(a,o,c,u,p){const d=c.parameters.getProperty(a,void 0);d&&(!p||p.search(o)===-1)&&(u[o]=d.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(a){const o=new URL(a);o.protocol="https:",o.port="443",o.searchParams.append("GenerateRedirectResponse","true");const u=o.toString();t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",u,void 0,"ConnectionFactoryBase: redirectUrl request"));const p=await fetch(u);if(p.status!==200)return a;const d=await p.text();t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",d,a,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(d.trim()).toString()}catch{return a}}};return _n.ConnectionFactoryBase=n,_n}var ah;function mw(){if(ah)return In;ah=1,Object.defineProperty(In,"__esModule",{value:!0}),In.DialogConnectionFactory=void 0;const e=Se(),t=L(),r=O(),i=st(),n=L(),s=Ee(),a=Pt();class o extends i.ConnectionFactoryBase{create(u,p,d){const h=u.parameters.getProperty(r.PropertyId.Conversation_ApplicationId,""),l=u.parameters.getProperty(r.PropertyId.Conversation_DialogType),f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),m=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),P=u.parameters.getProperty(r.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),g={};g[s.HeaderNames.ConnectionId]=d,g[a.QueryParameterNames.Format]=u.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase(),g[a.QueryParameterNames.Language]=m,g[a.QueryParameterNames.RequestBotStatusMessages]=P,h&&(g[a.QueryParameterNames.BotId]=h,l===r.DialogServiceConfig.DialogTypes.CustomCommands&&(g[s.HeaderNames.CustomCommandsAppId]=h));const w=l===r.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",R=l===r.DialogServiceConfig.DialogTypes.CustomCommands?"v1":l===r.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",A={};p.token!=null&&p.token!==""&&(A[p.headerName]=p.token);let I=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,"");if(!I){const q=i.ConnectionFactoryBase.getHostSuffix(f),M=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`wss://${f}.${o.BaseUrl}${q}`);I=`${M.endsWith("/")?M:M+"/"}${w}${o.ApiKey}/${R}`}this.setCommonUrlParams(u,g,I);const D=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(I,g,A,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),D,d))}}return In.DialogConnectionFactory=o,o.ApiKey="api",o.BaseUrl="convai.speech",In}var ch;function Sw(){if(ch)return bn;ch=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.DialogServiceConnector=void 0;const e=mw(),t=L(),r=Be(),i=F(),n=$(),s=O(),a=ep();let o=class extends s.Recognizer{constructor(u,p){const d=u;n.Contracts.throwIfNull(u,"dialogConfig"),super(p,d.properties,new e.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=d.properties.clone();const h=this.buildAgentConfig();this.privReco.agentConfig.set(h)}connect(u,p){(0,i.marshalPromiseToCallbacks)(this.privReco.connect(),u,p)}disconnect(u,p){(0,i.marshalPromiseToCallbacks)(this.privReco.disconnect(),u,p)}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(u){n.Contracts.throwIfNullOrWhitespace(u,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,u)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(a.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(u){this.properties.setProperty(a.PropertyId.Conversation_Speech_Activity_Template,u)}listenOnceAsync(u,p){if(this.isTurnComplete){n.Contracts.throwIfDisposed(this.privIsDisposed);const h=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const l=new i.Deferred;await this.privReco.recognize(r.RecognitionMode.Conversation,l.resolve,l.reject);const f=await l.promise;return await this.implRecognizerStop(),f})();h.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,i.marshalPromiseToCallbacks)(h.finally(()=>{this.isTurnComplete=!0}),u,p)}}sendActivityAsync(u,p,d){(0,i.marshalPromiseToCallbacks)(this.privReco.sendMessage(u),p,d)}close(u,p){n.Contracts.throwIfDisposed(this.privIsDisposed),(0,i.marshalPromiseToCallbacks)(this.dispose(!0),u,p)}async dispose(u){this.privIsDisposed||u&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(u))}createRecognizerConfig(u){return new t.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,p,d,h){const l=d;return new t.DialogServiceAdapter(u,p,l,h,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(a.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(a.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(a.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return bn.DialogServiceConnector=o,bn}var Mn={},uh;function Cw(){if(uh)return Mn;uh=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.ActivityReceivedEventArgs=void 0;let e=class{constructor(r,i){this.privActivity=r,this.privAudioStream=i}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return Mn.ActivityReceivedEventArgs=e,Mn}var Dn={},kn={},ph;function yw(){if(ph)return kn;ph=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.TurnStatusResponsePayload=void 0;class e{constructor(r){this.privMessageStatusResponse=JSON.parse(r)}static fromJSON(r){return new e(r)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return kn.TurnStatusResponsePayload=e,kn}var dh;function Pw(){if(dh)return Dn;dh=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.TurnStatusReceivedEventArgs=void 0;const e=yw();let t=class{constructor(i){this.privTurnStatus=e.TurnStatusResponsePayload.fromJSON(i)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return Dn.TurnStatusReceivedEventArgs=t,Dn}var ja={},lh;function ww(){return lh||(lh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServicePropertyChannel=void 0,(function(t){t[t.UriQueryParameter=0]="UriQueryParameter"})(e.ServicePropertyChannel||(e.ServicePropertyChannel={}))})(ja)),ja}var za={},hh;function Rw(){return hh||(hh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProfanityOption=void 0,(function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"})(e.ProfanityOption||(e.ProfanityOption={}))})(za)),za}var Nn={},vh;function Ew(){if(vh)return Nn;vh=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.BaseAudioPlayer=void 0;const e=Ge(),t=O(),r=er();let i=class{constructor(s){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,s===void 0&&(s=t.AudioStreamFormat.getDefaultInputFormat()),this.init(s)}playAudioSample(s,a,o){try{this.ensureInitializedContext();const c=this.formatAudioData(s),u=new Float32Array(this.samples.length+c.length);u.set(this.samples,0),u.set(c,this.samples.length),this.samples=u,a&&a()}catch(c){o&&o(c)}}stopAudio(s,a){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{s&&s()},o=>{a&&a(o)}),this.audioContext=null)}init(s){this.audioFormat=s,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const s=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},s)}}createAudioContext(){this.audioContext=r.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(s){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(s),128);case 16:return this.formatArrayBuffer(new Int16Array(s),32768);case 32:return this.formatArrayBuffer(new Int32Array(s),2147483648);default:throw new e.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(s,a){const o=new Float32Array(s.length);for(let c=0;c<s.length;c++)o[c]=s[c]/a;return o}updateAudioBuffer(){if(this.samples.length===0)return;const s=this.audioFormat.channels,a=this.audioContext.createBufferSource(),o=this.samples.length/s,c=this.audioContext.createBuffer(s,o,this.audioFormat.samplesPerSec);for(let u=0;u<s;u++){let p=u;const d=c.getChannelData(u);for(let h=0;h<this.samples.length;h++,p+=s)d[h]=this.samples[p]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),a.buffer=c,a.connect(this.gainNode),a.start(this.startTime),this.startTime+=c.duration,this.samples=new Float32Array}async playAudio(s){this.audioContext===null&&this.createAudioContext();const a=this.audioContext.createBufferSource(),o=this.audioContext.destination;await this.audioContext.decodeAudioData(s,c=>{a.buffer=c,a.connect(o),a.start(0)})}};return Nn.BaseAudioPlayer=i,Nn}var jn={},fh;function Aw(){if(fh)return jn;fh=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.ConnectionMessageEventArgs=void 0;let e=class{constructor(r){this.privConnectionMessage=r}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return jn.ConnectionMessageEventArgs=e,jn}var zn={},La={},gh;function Qg(){return gh||(gh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdMode=void 0,(function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"})(e.LanguageIdMode||(e.LanguageIdMode={}))})(La)),La}var mh;function Tw(){if(mh)return zn;mh=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.AutoDetectSourceLanguageConfig=void 0;const e=L(),t=$(),r=O(),i=Qg();let n=class Ko{constructor(){this.privProperties=new r.PropertyCollection,this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=i.LanguageIdMode.AtStart}static fromOpenRange(){const a=new Ko;return a.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.AutoDetectSourceLanguagesOpenRangeOptionName),a.properties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),a}static fromLanguages(a){t.Contracts.throwIfArrayEmptyOrWhitespace(a,"languages");const o=new Ko;return o.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,a.join()),o}static fromSourceLanguageConfigs(a){if(a.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const o=new Ko,c=[];return a.forEach(u=>{if(c.push(u.language),u.endpointId!==void 0&&u.endpointId!==""){const p=u.language+r.PropertyId.SpeechServiceConnection_EndpointId.toString();o.properties.setProperty(p,u.endpointId)}}),o.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,c.join()),o}get properties(){return this.privProperties}set mode(a){a===i.LanguageIdMode.Continuous?(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=a}};return zn.AutoDetectSourceLanguageConfig=n,zn}var Ln={},Sh;function bw(){if(Sh)return Ln;Sh=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.AutoDetectSourceLanguageResult=void 0;const e=$();let t=class Oc{constructor(i,n){e.Contracts.throwIfNullOrUndefined(i,"language"),e.Contracts.throwIfNullOrUndefined(n,"languageDetectionConfidence"),this.privLanguage=i,this.privLanguageDetectionConfidence=n}static fromResult(i){return new Oc(i.language,i.languageDetectionConfidence)}static fromConversationTranscriptionResult(i){return new Oc(i.language,i.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return Ln.AutoDetectSourceLanguageResult=t,Ln}var Fn={},Ch;function Iw(){if(Ch)return Fn;Ch=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.SourceLanguageConfig=void 0;const e=$();let t=class Yg{constructor(i,n){e.Contracts.throwIfNullOrUndefined(i,"language"),this.privLanguage=i,this.privEndpointId=n}static fromLanguage(i,n){return new Yg(i,n)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return Fn.SourceLanguageConfig=t,Fn}var Fa={},qt={},yh;function Zg(){if(yh)return qt;yh=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.ConversationImpl=qt.Conversation=void 0;const e=L(),t=F(),r=$(),i=O();let n=class{constructor(){}static createConversationAsync(o,c,u,p){r.Contracts.throwIfNullOrUndefined(o,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(o.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!o.subscriptionKey&&!o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(o.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let d,h,l;return typeof c=="string"?(d=new s(o,c),(0,t.marshalPromiseToCallbacks)((async()=>{})(),u,p)):(d=new s(o),h=c,l=u,d.createConversationAsync((()=>{h&&h()}),f=>{l&&l(f)})),d}};qt.Conversation=n;class s extends n{constructor(o,c){if(super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var h;this.privIsConnected=!0;try{(h=this.privConversationTranslator)!=null&&h.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var h;try{(h=this.privConversationTranslator)!=null&&h.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,h)=>{var l;try{(l=this.privConversationTranslator)!=null&&l.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,h)}catch{}},this.onParticipantUpdateCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.id);if(l!==void 0){switch(h.key){case e.ConversationTranslatorCommandTypes.changeNickname:l.displayName=h.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=h.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=h.value;break;case e.ConversationTranslatorCommandTypes.setMute:l.isMuted=h.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=h.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.Updated,[this.toParticipant(l)],h.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,h)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:h.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.Updated,this.toParticipants(!1),h.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,h)=>{try{const l=this.privParticipants.addOrUpdateParticipant(h.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],h.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(h.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],h.sessionId)))}catch{}},this.onTranslationReceived=(d,h)=>{try{switch(h.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,h)=>{var l;try{if(h.sessionToken!==void 0&&h.sessionToken!==null&&(this.privRoom.token=h.sessionToken),this.privParticipants.participants=[...h.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),h.sessionId)),this.me.isHost){const f=(l=this.privConversationTranslator)==null?void 0:l.properties.getProperty(i.PropertyId.ConversationTranslator_Name);f!==void 0&&f.length>0&&f!==this.me.displayName&&this.changeNicknameAsync(f)}}catch{}},this.onConversationExpiration=(d,h)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,h)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new i.PropertyCollection,this.privManager=new e.ConversationManager,o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])||o.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),c)this.privConversationId=c;else{o.targetLanguages.length===0&&o.addTargetLanguage(this.privLanguage),o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceResponse_ProfanityOption])||o.setProfanity(i.ProfanityOption.Masked);let h=o.getProperty(i.PropertyId[i.PropertyId.ConversationTranslator_Name]);h==null&&(h="Host"),r.Contracts.throwIfNullOrTooLong(h,"nickname",50),r.Contracts.throwIfNullOrTooShort(h,"nickname",2),o.setProperty(i.PropertyId[i.PropertyId.ConversationTranslator_Name],h)}this.privConfig=o;const p=o;r.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var o,c;return(o=this.privParticipants.me)!=null&&o.isHost?!1:(c=this.privParticipants.me)==null?void 0:c.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const o=this.conversationId,c=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),u={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const h=this.properties.getProperty(d,"");h!==""&&(u[d]=h)}return{id:o,participants:c,conversationProperties:u}}get canSend(){var o;return this.privIsConnected&&!((o=this.privParticipants.me)!=null&&o.isMuted)}get canSendAsHost(){var o;return this.privIsConnected&&((o=this.privParticipants.me)==null?void 0:o.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(o){r.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),this.privToken=o}set conversationTranslator(o){this.privConversationTranslator=o}onToken(o){this.privConversationTranslator.onToken(o)}createConversationAsync(o,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),c),this.privRoom=u,this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}startConversationAsync(o,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=e.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}addParticipantAsync(o,c,u){r.Contracts.throwIfNullOrUndefined(o,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(o),c,u)}joinConversationAsync(o,c,u,p,d){try{r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,o,(h=>{r.Contracts.throwIfNullOrUndefined(h,this.privErrors.permissionDeniedConnect),this.privRoom=h,this.privConfig.authorizationToken=h.cognitiveSpeechAuthToken,p&&p(h.cognitiveSpeechAuthToken)}),(h=>{this.handleError(h,d)}))}catch(h){this.handleError(h,d)}}deleteConversationAsync(o,c){(0,t.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),o,c)}async deleteConversationImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(o,c){(0,t.marshalPromiseToCallbacks)(this.endConversationImplAsync(),o,c)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}muteAllParticipantsAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}muteParticipantAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==o&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(o)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(o,!0),(()=>{this.handleCallback(c,u)}),(d=>{this.handleError(d,u)}))}catch(p){this.handleError(p,u)}}removeParticipantAsync(o,c,u){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&o.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(o),c,u);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let p="";typeof o=="string"?p=o:o.hasOwnProperty("id")?p=o.id:o.hasOwnProperty("userId")&&(p=o.userId),r.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(h=>h.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(c,u)}),(h=>{this.handleError(h,u)}))}}catch(p){this.handleError(p,u)}}unlockConversationAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}unmuteAllParticipantsAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}unmuteParticipantAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==o&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(o)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(o,!1),(()=>{this.handleCallback(c,u)}),(d=>{this.handleError(d,u)}))}catch(p){this.handleError(p,u)}}sendTextMessageAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),o.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}setTranslatedLanguagesAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}changeNicknameAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(o){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await o.enforceAudioGating(),this.privTranscriberRecognizer=o,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const o=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:o,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(o){if(this.privParticipants.addOrUpdateParticipant(o)!==void 0&&this.privTranscriberRecognizer){const u=this.conversationInfo;return u.participants=[o],this.privTranscriberRecognizer.pushConversationEvent(u,"join")}}removeParticipantImplAsync(o){this.privParticipants.deleteParticipant(o.id);const c=this.conversationInfo;return c.participants=[o],this.privTranscriberRecognizer.pushConversationEvent(c,"leave")}async close(o){var c;try{this.privIsConnected=!1,await((c=this.privConversationRecognizer)==null?void 0:c.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}o&&this.dispose()}handleCallback(o,c){if(o){try{o()}catch(u){c&&c(u)}o=void 0}}handleError(o,c){if(c)if(o instanceof Error){const u=o;c(u.name+": "+u.message)}else c(o)}toParticipants(o){const c=this.privParticipants.participants.map(u=>this.toParticipant(u));return o?c:c.filter(u=>u.isHost===!1)}toParticipant(o){return new i.Participant(o.id,o.avatar,o.displayName,o.isHost,o.isMuted,o.isUsingTts,o.preferredLanguage,o.voice)}getMuteAllCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getMuteCommand(o,c){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(o,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:o,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:c})}getLockCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getEjectCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(o,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:o,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getChangeNicknameCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(o,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:o,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getMessageCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(o,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:o,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return qt.ConversationImpl=s,qt}var qn={},Ph;function _w(){if(Ph)return qn;Ph=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.ConversationCommon=void 0;let e=class{constructor(r){this.privAudioConfig=r}handleCallback(r,i){if(r){try{r()}catch(n){i&&i(n)}r=void 0}}handleError(r,i){if(i)if(r instanceof Error){const n=r;i(n.name+": "+n.message)}else i(r)}};return qn.ConversationCommon=e,qn}var Bn={},wh;function Ow(){if(wh)return Bn;wh=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.ConversationExpirationEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{constructor(i,n){super(n),this.privExpirationTime=i}get expirationTime(){return this.privExpirationTime}};return Bn.ConversationExpirationEventArgs=t,Bn}var Un={},Rh;function Mw(){if(Rh)return Un;Rh=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.ConversationParticipantsChangedEventArgs=void 0;const e=O();let t=class extends e.SessionEventArgs{constructor(i,n,s){super(s),this.privReason=i,this.privParticipant=n}get reason(){return this.privReason}get participants(){return this.privParticipant}};return Un.ConversationParticipantsChangedEventArgs=t,Un}var xn={},Eh;function Dw(){if(Eh)return xn;Eh=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.ConversationTranslationCanceledEventArgs=void 0;const e=_o();let t=class extends e.CancellationEventArgsBase{};return xn.ConversationTranslationCanceledEventArgs=t,xn}var Hn={},Ah;function kw(){if(Ah)return Hn;Ah=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ConversationTranslationEventArgs=void 0;const e=O();let t=class extends e.RecognitionEventArgs{constructor(i,n,s){super(n,s),this.privResult=i}get result(){return this.privResult}};return Hn.ConversationTranslationEventArgs=t,Hn}var $n={},Th;function Nw(){if(Th)return $n;Th=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.ConversationTranslationResult=void 0;const e=Fg();let t=class extends e.TranslationRecognitionResult{constructor(i,n,s,a,o,c,u,p,d,h,l){super(n,a,o,c,u,p,void 0,void 0,d,h,l),this.privId=i,this.privOrigLang=s}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return $n.ConversationTranslationResult=t,$n}var qa={},Wn={},Vn={},bh;function Xg(){if(bh)return Vn;bh=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.StringUtils=void 0;let e=class{static formatString(r,i){if(!r)return"";if(!i)return r;let n="",s="";const a=u=>{n+=u},o=u=>{s+=u};let c=a;for(let u=0;u<r.length;u++){const p=r[u],d=u+1<r.length?r[u+1]:"";switch(p){case"{":d==="{"?(c("{"),u++):c=o;break;case"}":d==="}"?(c("}"),u++):(i.hasOwnProperty(s)&&(n+=i[s]),c=a,s="");break;default:c(p);break}}return n}};return Vn.StringUtils=e,Vn}var Ih;function jw(){if(Ih)return Wn;Ih=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.ConversationTranslatorConnectionFactory=void 0;const e=Se(),t=Xg(),r=$(),i=O(),n=Ee(),s=Pt(),a=st(),o=L();let c=class em extends a.ConnectionFactoryBase{constructor(p){super(),r.Contracts.throwIfNullOrUndefined(p,"convGetter"),this.privConvGetter=p}create(p,d,h){const l=p.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",f=this.privConvGetter().room,m=f.cognitiveSpeechRegion||p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,""),P={hostSuffix:a.ConnectionFactoryBase.getHostSuffix(m),path:em.CTS_VIRT_MIC_PATH,region:encodeURIComponent(m)};P[s.QueryParameterNames.Language]=encodeURIComponent(p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"")),P[s.QueryParameterNames.CtsMeetingId]=encodeURIComponent(f.roomId),P[s.QueryParameterNames.CtsDeviceId]=encodeURIComponent(f.participantId),P[s.QueryParameterNames.CtsIsParticipant]=f.isHost?"":"&"+s.QueryParameterNames.CtsIsParticipant;let g="";const w={},R={};if(l){g=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint),g||(g="wss://"+p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),g=t.StringUtils.formatString(g,P);const I=new URL(g);I.searchParams.forEach((q,M)=>{w[M]=q}),new o.TranscriberConnectionFactory().setQueryParams(w,p,g),w[s.QueryParameterNames.CtsMeetingId]=P[s.QueryParameterNames.CtsMeetingId],w[s.QueryParameterNames.CtsDeviceId]=P[s.QueryParameterNames.CtsDeviceId],f.isHost||(w[s.QueryParameterNames.CtsIsParticipant]=""),s.QueryParameterNames.Format in w||(w[s.QueryParameterNames.Format]="simple"),I.searchParams.forEach((q,M)=>{I.searchParams.set(M,w[M]),delete w[M]}),g=I.toString()}else{const I=new o.TranslationConnectionFactory;g=I.getEndpointUrl(p,!0),g=t.StringUtils.formatString(g,P),I.setQueryParams(w,p,g)}R[n.HeaderNames.ConnectionId]=h,R[e.RestConfigBase.configParams.token]=f.token,d.token&&(R[d.headerName]=d.token);const A=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new e.WebsocketConnection(g,w,R,new o.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),A,h))}};return Wn.ConversationTranslatorConnectionFactory=c,c.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Wn}var _h;function zw(){return _h||(_h=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslator=e.SpeechState=void 0;const t=L(),r=jw(),i=F(),n=$(),s=O(),a=Zg(),o=rp();var c;(function(d){d[d.Inactive=0]="Inactive",d[d.Connecting=1]="Connecting",d[d.Connected=2]="Connected"})(c=e.SpeechState||(e.SpeechState={}));class u extends s.TranslationRecognizer{constructor(h,l,f,m){super(h,l,new r.ConversationTranslatorConnectionFactory(m)),this.privSpeechState=c.Inactive,f&&(this.privTranslator=f,this.sessionStarted=()=>{this.privSpeechState=c.Connected},this.sessionStopped=()=>{this.privSpeechState=c.Inactive},this.recognizing=(P,g)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,g)},this.recognized=async(P,g)=>{var w;(w=g.result)!=null&&w.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(g.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,g)},this.canceled=async()=>{if(this.privSpeechState!==c.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=c.Inactive}})}get state(){return this.privSpeechState}set state(h){this.privSpeechState=h}set authentication(h){this.privReco.authentication=h}onConnection(){this.privSpeechState=c.Connected}async onCancelSpeech(){this.privSpeechState=c.Inactive,await this.cancelSpeech()}fireCancelEvent(h){try{if(this.privTranslator.canceled){const l=new o.ConversationTranslationCanceledEventArgs(s.CancellationReason.Error,h,s.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,l)}}catch{}}async cancelSpeech(){var h;try{this.stopContinuousRecognitionAsync(),await((h=this.privReco)==null?void 0:h.disconnect()),this.privSpeechState=c.Inactive}catch{}}}class p extends o.ConversationCommon{constructor(h){super(h),this.privErrors=t.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new s.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var h;return(h=this.privConversation)==null?void 0:h.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===c.Connected||this.privCTRecognizer.state===c.Connecting||this.privConversation.isMutedByHost)}onToken(h){this.privCTRecognizer.authentication=h}setServiceProperty(h,l){const f=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));f[h]=l,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(f))}joinConversationAsync(h,l,f,m,P){try{if(typeof h=="string"){n.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),n.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),P);let g=f;(g==null||g==="")&&(g=t.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(g),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],g),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],l);const w=[s.PropertyId.SpeechServiceConnection_Host,s.PropertyId.ConversationTranslator_Host,s.PropertyId.SpeechServiceConnection_Endpoint,s.PropertyId.SpeechServiceConnection_ProxyHostName,s.PropertyId.SpeechServiceConnection_ProxyPassword,s.PropertyId.SpeechServiceConnection_ProxyPort,s.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const A of w){const I=this.privProperties.getProperty(A);if(I){const D=typeof A=="string"?A:s.PropertyId[A];this.privSpeechTranslationConfig.setProperty(D,I)}}const R=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));for(const A of Object.keys(R))this.privSpeechTranslationConfig.setServiceProperty(A,R[A],s.ServicePropertyChannel.UriQueryParameter);this.privConversation=new a.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(h,l,g,(A=>{A||this.handleError(new Error(this.privErrors.permissionDeniedConnect),P),this.privSpeechTranslationConfig.authorizationToken=A,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(m,P)}),(I=>{this.handleError(I,P)}))}),(A=>{this.handleError(A,P)}))}else typeof h=="object"?(n.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),n.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,l),this.privConversation=h,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),n.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=h.config,this.handleCallback(f,m)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),m)}catch(g){this.handleError(g,typeof f=="string"?P:m)}}leaveConversationAsync(h,l){(0,i.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),h,l)}sendTextMessageAsync(h,l,f){try{n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}",h)),this.privConversation.sendTextMessageAsync(h,l,f)}catch(m){this.handleError(m,f)}}startTranscribingAsync(h,l){(0,i.marshalPromiseToCallbacks)((async()=>{try{n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),n.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),l),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(f){throw this.privIsSpeaking=!1,await this.cancelSpeech(),f}})(),h,l)}stopTranscribingAsync(h,l){(0,i.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((f,m)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(f,m)})}catch{await this.cancelSpeech()}})(),h,l)}isDisposed(){return this.privIsDisposed}dispose(h,l,f){(0,i.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),l,f)}async cancelSpeech(){var h;try{this.privIsSpeaking=!1,await((h=this.privCTRecognizer)==null?void 0:h.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");const h=()=>this.privConversation;this.privCTRecognizer=new u(this.privSpeechTranslationConfig,this.privAudioConfig,this,h)}catch(h){throw await this.cancelSpeech(),h}}startContinuousRecognition(){return new Promise((h,l)=>{this.privCTRecognizer.startContinuousRecognitionAsync(h,l)})}}e.ConversationTranslator=p})(qa)),qa}var Kn={},Oh;function Lw(){if(Oh)return Kn;Oh=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.ConversationTranscriber=void 0;const e=L(),t=Be(),r=F(),i=$(),n=O();let s=class tm extends n.Recognizer{constructor(o,c){const u=o;i.Contracts.throwIfNull(u,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage),n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new e.ConversationTranscriberConnectionFactory,o.tokenCredential),this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(o,c,u){const p=o;return c.properties.mergeTo(p.properties),new tm(o,u)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){i.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple])===n.OutputFormat[n.OutputFormat.Simple]?n.OutputFormat.Simple:n.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(o,c){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),o,c)}stopTranscribingAsync(o,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),o,c)}close(o,c){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),o,c)}async dispose(o){this.privDisposedRecognizer||(o&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(o))}createRecognizerConfig(o){return new e.RecognizerConfig(o,this.privProperties)}createServiceRecognizer(o,c,u,p){const d=u;return p.isSpeakerDiarizationEnabled=!0,new e.ConversationTranscriptionServiceRecognizer(o,c,d,p,this)}};return Kn.ConversationTranscriber=s,Kn}var Bt={},Mh;function Fw(){if(Mh)return Bt;Mh=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.Participant=Bt.User=void 0;const e=O();class t{constructor(n){this.privUserId=n}get userId(){return this.privUserId}}Bt.User=t;class r{constructor(n,s,a,o,c,u,p,d){this.privId=n,this.privAvatar=s,this.privDisplayName=a,this.privIsHost=o,this.privIsMuted=c,this.privIsUsingTts=u,this.privPreferredLanguage=p,this.privVoice=d,this.privProperties=new e.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(n,s,a){return new r(n,"",n,!1,!1,!1,s,a)}}return Bt.Participant=r,Bt}var Ba={},Dh;function qw(){return Dh||(Dh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantChangedReason=void 0,(function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"})(e.ParticipantChangedReason||(e.ParticipantChangedReason={}))})(Ba)),Ba}var Ut={},kh;function Bw(){if(kh)return Ut;kh=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.MeetingImpl=Ut.Meeting=void 0;const e=L(),t=F(),r=$(),i=O();let n=class{constructor(){}static createMeetingAsync(o,c,u,p){if(r.Contracts.throwIfNullOrUndefined(o,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(o.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),r.Contracts.throwIfNull(c,"meetingId"),c.length===0)throw new Error("meetingId cannot be empty");!o.subscriptionKey&&!o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(o.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const d=new s(o,c);return(0,t.marshalPromiseToCallbacks)((async()=>{})(),u,p),d}};Ut.Meeting=n;class s extends n{constructor(o,c){super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var h;this.privIsConnected=!0;try{(h=this.privConversationTranslator)!=null&&h.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var h;try{(h=this.privConversationTranslator)!=null&&h.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,h)=>{var l;try{(l=this.privConversationTranslator)!=null&&l.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,h)}catch{}},this.onParticipantUpdateCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.id);if(l!==void 0){switch(h.key){case e.ConversationTranslatorCommandTypes.changeNickname:l.displayName=h.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=h.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=h.value;break;case e.ConversationTranslatorCommandTypes.setMute:l.isMuted=h.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=h.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.Updated,[this.toParticipant(l)],h.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,h)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:h.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.Updated,this.toParticipants(!1),h.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,h)=>{try{const l=this.privParticipants.addOrUpdateParticipant(h.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],h.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(h.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],h.sessionId)))}catch{}},this.onTranslationReceived=(d,h)=>{try{switch(h.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new i.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,h)=>{var l;try{if(h.sessionToken!==void 0&&h.sessionToken!==null&&(this.privRoom.token=h.sessionToken),this.privParticipants.participants=[...h.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new i.ConversationParticipantsChangedEventArgs(i.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),h.sessionId)),this.me.isHost){const f=(l=this.privConversationTranslator)==null?void 0:l.properties.getProperty(i.PropertyId.ConversationTranslator_Name);f!==void 0&&f.length>0&&f!==this.me.displayName&&this.changeNicknameAsync(f)}}catch{}},this.onConversationExpiration=(d,h)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,h)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new i.PropertyCollection,this.privManager=new e.ConversationManager,o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])||o.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=o.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=c,this.privConfig=o;const p=o;r.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var o,c;return(o=this.privParticipants.me)!=null&&o.isHost?!1:(c=this.privParticipants.me)==null?void 0:c.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const o=this.meetingId,c=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),u={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const h=this.properties.getProperty(d,"");h!==""&&(u[d]=h)}return{id:o,participants:c,meetingProperties:u}}get canSend(){var o;return this.privIsConnected&&!((o=this.privParticipants.me)!=null&&o.isMuted)}get canSendAsHost(){var o;return this.privIsConnected&&((o=this.privParticipants.me)==null?void 0:o.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(o){r.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),this.privToken=o}createMeetingAsync(o,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),c),this.privRoom=u,this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}startMeetingAsync(o,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}addParticipantAsync(o,c,u){r.Contracts.throwIfNullOrUndefined(o,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(o),c,u)}joinMeetingAsync(o,c,u,p,d){try{r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,o,(h=>{r.Contracts.throwIfNullOrUndefined(h,this.privErrors.permissionDeniedConnect),this.privRoom=h,this.privConfig.authorizationToken=h.cognitiveSpeechAuthToken,p&&p(h.cognitiveSpeechAuthToken)}),(h=>{this.handleError(h,d)}))}catch(h){this.handleError(h,d)}}deleteMeetingAsync(o,c){(0,t.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),o,c)}async deleteMeetingImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(o,c){(0,t.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),o,c)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}muteAllParticipantsAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}muteParticipantAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==o&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(o)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(o,!0),(()=>{this.handleCallback(c,u)}),(d=>{this.handleError(d,u)}))}catch(p){this.handleError(p,u)}}removeParticipantAsync(o,c,u){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&o.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(o),c,u);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let p="";typeof o=="string"?p=o:o.hasOwnProperty("id")?p=o.id:o.hasOwnProperty("userId")&&(p=o.userId),r.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(h=>h.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(c,u)}),(h=>{this.handleError(h,u)}))}}catch(p){this.handleError(p,u)}}unlockMeetingAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}unmuteAllParticipantsAsync(o,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(o,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}unmuteParticipantAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==o&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(o)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(o,!1),(()=>{this.handleCallback(c,u)}),(d=>{this.handleError(d,u)}))}catch(p){this.handleError(p,u)}}sendTextMessageAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),o.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}setTranslatedLanguagesAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}changeNicknameAsync(o,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(o),(()=>{this.handleCallback(c,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(o){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await o.enforceAudioGating(),this.privTranscriberRecognizer=o,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const o=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:o,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(o){if(this.privParticipants.addOrUpdateParticipant(o)!==void 0&&this.privTranscriberRecognizer){const u=this.meetingInfo;return u.participants=[o],this.privTranscriberRecognizer.pushMeetingEvent(u,"join")}}removeParticipantImplAsync(o){this.privParticipants.deleteParticipant(o.id);const c=this.meetingInfo;return c.participants=[o],this.privTranscriberRecognizer.pushMeetingEvent(c,"leave")}async close(o){var c;try{this.privIsConnected=!1,await((c=this.privConversationRecognizer)==null?void 0:c.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}o&&this.dispose()}handleCallback(o,c){if(o){try{o()}catch(u){c&&c(u)}o=void 0}}handleError(o,c){if(c)if(o instanceof Error){const u=o;c(u.name+": "+u.message)}else c(o)}toParticipants(o){const c=this.privParticipants.participants.map(u=>this.toParticipant(u));return o?c:c.filter(u=>u.isHost===!1)}toParticipant(o){return new i.Participant(o.id,o.avatar,o.displayName,o.isHost,o.isMuted,o.isUsingTts,o.preferredLanguage,o.voice)}getMuteAllCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getMuteCommand(o,c){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(o,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:o,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:c})}getLockCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getEjectCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(o,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:o,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getChangeNicknameCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(o,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:o,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getMessageCommand(o){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(o,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:o,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return Ut.MeetingImpl=s,Ut}var Gn={},Nh;function Uw(){if(Nh)return Gn;Nh=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.MeetingTranscriptionCanceledEventArgs=void 0;const e=_o();class t extends e.CancellationEventArgsBase{}return Gn.MeetingTranscriptionCanceledEventArgs=t,Gn}var Jn={},jh;function xw(){if(jh)return Jn;jh=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.MeetingTranscriber=void 0;const e=L(),t=F(),r=$(),i=O(),n=rp();let s=class{constructor(o){this.privAudioConfig=o,this.privProperties=new i.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return i.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){r.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,o)}joinMeetingAsync(o,c,u){const p=o;r.Contracts.throwIfNullOrUndefined(n.MeetingImpl,"Meeting"),this.privRecognizer=new e.TranscriberRecognizer(o.config,this.privAudioConfig),r.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,t.marshalPromiseToCallbacks)(p.connectTranscriberRecognizer(this.privRecognizer),c,u)}startTranscribingAsync(o,c){this.privRecognizer.startContinuousRecognitionAsync(o,c)}stopTranscribingAsync(o,c){this.privRecognizer.stopContinuousRecognitionAsync(o,c)}leaveMeetingAsync(o,c){this.privRecognizer.disconnectCallbacks(),(0,t.marshalPromiseToCallbacks)((async()=>{})(),o,c)}close(o,c){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),o,c)}async dispose(o){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),o&&(this.privDisposedRecognizer=!0))}};return Jn.MeetingTranscriber=s,Jn}var Qn={},zh;function Hw(){if(zh)return Qn;zh=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.ConversationTranscriptionResult=void 0;const e=O();let t=class extends e.RecognitionResult{constructor(i,n,s,a,o,c,u,p,d,h,l){super(i,n,s,a,o,c,u,d,h,l),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Qn.ConversationTranscriptionResult=t,Qn}var Lh;function rp(){return Lh||(Lh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionResult=e.MeetingTranscriber=e.MeetingTranscriptionCanceledEventArgs=e.MeetingImpl=e.Meeting=e.ParticipantChangedReason=e.User=e.Participant=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.ConversationCommon=e.ConversationImpl=e.Conversation=void 0;var t=Zg();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return t.Conversation}}),Object.defineProperty(e,"ConversationImpl",{enumerable:!0,get:function(){return t.ConversationImpl}});var r=_w();Object.defineProperty(e,"ConversationCommon",{enumerable:!0,get:function(){return r.ConversationCommon}});var i=Ow();Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return i.ConversationExpirationEventArgs}});var n=Mw();Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return n.ConversationParticipantsChangedEventArgs}});var s=Dw();Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationCanceledEventArgs}});var a=kw();Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationEventArgs}});var o=Nw();Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return o.ConversationTranslationResult}});var c=zw();Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return c.ConversationTranslator}});var u=Lw();Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return u.ConversationTranscriber}});var p=Fw();Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return p.Participant}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return p.User}});var d=qw();Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return d.ParticipantChangedReason}});var h=Bw();Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return h.Meeting}}),Object.defineProperty(e,"MeetingImpl",{enumerable:!0,get:function(){return h.MeetingImpl}});var l=Uw();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return l.MeetingTranscriptionCanceledEventArgs}});var f=xw();Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return f.MeetingTranscriber}});var m=Hw();Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return m.ConversationTranscriptionResult}})})(Fa)),Fa}var xt={},Fh;function np(){if(Fh)return xt;Fh=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.SynthesisRequest=xt.Synthesizer=void 0;const e=L(),t=F(),r=$(),i=O();let n=class rm{constructor(o){const c=o;r.Contracts.throwIfNull(c,"speechConfig"),this.privProperties=c.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new t.Queue,this.tokenCredential=o.tokenCredential}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){r.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,o)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===e.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(o){const c={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let u=this.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),p=this.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,""),d=rm.XMLEncode(o);return this.autoDetectSourceLanguage?u="en-US":p=p||c[u],p&&(d=`<voice name='${p}'>${d}</voice>`),d=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${u}'>${d}</speak>`,d}async dispose(o){this.privDisposed||(o&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const o=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(o.text,o.isSSML,o.requestId,o.cb,o.err,o.dataStream)}}createSynthesizerConfig(o){return new e.SynthesizerConfig(o,this.privProperties)}implCommonSynthesizeSetup(){let o=typeof window<"u"?"Browser":"Node",c="unknown",u="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,c=navigator.userAgent,u=navigator.appVersion);const p=this.createSynthesizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(o,c,u)))),d=this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Key,void 0),h=d&&d!==""?new e.CognitiveSubscriptionKeyAuthentication(d):this.tokenCredential?new e.CognitiveTokenAuthentication(async()=>{try{const l=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(l==null?void 0:l.token)??""}catch(l){throw l}},async()=>{try{const l=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(l==null?void 0:l.token)??""}catch(l){throw l}}):new e.CognitiveTokenAuthentication(()=>{const l=this.privProperties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)},()=>{const l=this.privProperties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)});this.privAdapter=this.createSynthesisAdapter(h,this.privConnectionFactory,p),this.privRestAdapter=this.createRestSynthesisAdapter(h,p)}static XMLEncode(o){return o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};xt.Synthesizer=n;class s{constructor(o,c,u,p,d,h){this.requestId=o,this.text=c,this.isSSML=u,this.cb=p,this.err=d,this.dataStream=h}}return xt.SynthesisRequest=s,xt}var Yn={},qh;function $w(){if(qh)return Yn;qh=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.SpeechSynthesizer=void 0;const e=L(),t=F(),r=kg(),i=Io(),n=lr(),s=$(),a=O(),o=np();let c=class nm extends a.Synthesizer{constructor(p,d){super(p),d!==null&&(d===void 0?this.audioConfig=typeof window>"u"?void 0:a.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=d),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(p,d,h){const l=p;return d.properties.mergeTo(l.properties),new nm(p,h)}speakTextAsync(p,d,h,l){this.speakImpl(p,!1,d,h,l)}speakSsmlAsync(p,d,h,l){this.speakImpl(p,!0,d,h,l)}async getVoicesAsync(p=""){return this.getVoices(p)}close(p,d){s.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),p,d)}get internalData(){return this.privAdapter}createSynthesisAdapter(p,d,h){return new e.SpeechSynthesisAdapter(p,d,h,this,this.audioConfig)}createRestSynthesisAdapter(p,d){return new e.SynthesisRestAdapter(d,p)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=i.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(a.SpeechSynthesisOutputFormat[this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(p,d,h,l,f){try{s.Contracts.throwIfDisposed(this.privDisposed);const m=(0,t.createNoDashGuid)();let P;f instanceof a.PushAudioOutputStreamCallback?P=new n.PushAudioOutputStreamImpl(f):f instanceof a.PullAudioOutputStream?P=f:f!==void 0?P=new r.AudioFileWriter(f):P=void 0,this.synthesisRequestQueue.enqueue(new o.SynthesisRequest(m,p,d,g=>{if(this.privSynthesizing=!1,h)try{h(g)}catch(w){l&&l(w)}h=void 0,this.adapterSpeak().catch(()=>{})},g=>{l&&l(g)},P)),this.adapterSpeak().catch(()=>{})}catch(m){if(l)if(m instanceof Error){const P=m;l(P.name+": "+P.message)}else l(m);this.dispose(!0).catch(()=>{})}}async getVoices(p){const d=(0,t.createNoDashGuid)(),h=await this.privRestAdapter.getVoicesList(d);if(h.ok&&Array.isArray(h.json)){let l=h.json;return p&&p.length>0&&(l=l.filter(f=>!!f.Locale&&f.Locale.toLowerCase()===p.toLowerCase())),new a.SynthesisVoicesResult(d,l,void 0)}else return new a.SynthesisVoicesResult(d,void 0,`Error: ${h.status}: ${h.statusText}`)}};return Yn.SpeechSynthesizer=c,Yn}var Zn={},Bh;function Ww(){if(Bh)return Zn;Bh=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.SynthesisResult=void 0;let e=class{constructor(r,i,n,s){this.privResultId=r,this.privReason=i,this.privErrorDetails=n,this.privProperties=s}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Zn.SynthesisResult=e,Zn}var Xn={},Uh;function Vw(){if(Uh)return Xn;Uh=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.SpeechSynthesisResult=void 0;const e=O();let t=class extends e.SynthesisResult{constructor(i,n,s,a,o,c){super(i,n,a,o),this.privAudioData=s,this.privAudioDuration=c}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Xn.SpeechSynthesisResult=t,Xn}var ei={},xh;function Kw(){if(xh)return ei;xh=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SpeechSynthesisEventArgs=void 0;let e=class{constructor(r){this.privResult=r}get result(){return this.privResult}};return ei.SpeechSynthesisEventArgs=e,ei}var ti={},Hh;function Gw(){if(Hh)return ti;Hh=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.SpeechSynthesisWordBoundaryEventArgs=void 0;let e=class{constructor(r,i,n,s,a,o){this.privAudioOffset=r,this.privDuration=i,this.privText=n,this.privWordLength=s,this.privTextOffset=a,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return ti.SpeechSynthesisWordBoundaryEventArgs=e,ti}var ri={},$h;function Jw(){if($h)return ri;$h=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.SpeechSynthesisBookmarkEventArgs=void 0;let e=class{constructor(r,i){this.privAudioOffset=r,this.privText=i}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return ri.SpeechSynthesisBookmarkEventArgs=e,ri}var ni={},Wh;function Qw(){if(Wh)return ni;Wh=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SpeechSynthesisVisemeEventArgs=void 0;let e=class{constructor(r,i,n){this.privAudioOffset=r,this.privVisemeId=i,this.privAnimation=n}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return ni.SpeechSynthesisVisemeEventArgs=e,ni}var Ua={},Vh;function Yw(){return Vh||(Vh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBoundaryType=void 0,(function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"})(e.SpeechSynthesisBoundaryType||(e.SpeechSynthesisBoundaryType={}))})(Ua)),Ua}var ii={},Kh;function Zw(){if(Kh)return ii;Kh=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SynthesisVoicesResult=void 0;const e=O();let t=class extends e.SynthesisResult{constructor(i,n,s){if(Array.isArray(n)){super(i,e.ResultReason.VoicesListRetrieved,void 0,new e.PropertyCollection),this.privVoices=[];for(const a of n)this.privVoices.push(new e.VoiceInfo(a))}else super(i,e.ResultReason.Canceled,s||"Error information unavailable",new e.PropertyCollection)}get voices(){return this.privVoices}};return ii.SynthesisVoicesResult=t,ii}var xa={},Gh;function Xw(){return Gh||(Gh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=void 0;var t;(function(a){a[a.Unknown=0]="Unknown",a[a.Female=1]="Female",a[a.Male=2]="Male",a[a.Neutral=3]="Neutral"})(t=e.SynthesisVoiceGender||(e.SynthesisVoiceGender={}));var r;(function(a){a[a.Unknown=0]="Unknown",a[a.OnlineNeural=1]="OnlineNeural",a[a.OnlineStandard=2]="OnlineStandard",a[a.OfflineNeural=3]="OfflineNeural",a[a.OfflineStandard=4]="OfflineStandard",a[a.OnlineNeuralHD=5]="OnlineNeuralHD"})(r=e.SynthesisVoiceType||(e.SynthesisVoiceType={}));const i={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female},n={Neural:r.OnlineNeural,NeuralHD:r.OnlineNeuralHD};class s{constructor(o){if(this.privStyleList=[],o){if(this.privName=o.Name,this.privLocale=o.Locale,this.privShortName=o.ShortName,this.privLocaleName=o.LocaleName,this.privDisplayName=o.DisplayName,this.privLocalName=o.LocalName,this.privVoiceType=n[o.VoiceType]||r.Unknown,this.privGender=i[o.Gender]||t.Unknown,o.StyleList&&Array.isArray(o.StyleList))for(const c of o.StyleList)this.privStyleList.push(c);this.privSampleRateHertz=o.SampleRateHertz,this.privStatus=o.Status,o.ExtendedPropertyMap&&(this.privExtendedPropertyMap=o.ExtendedPropertyMap),this.privWordsPerMinute=o.WordsPerMinute,Array.isArray(o.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...o.SecondaryLocaleList]),Array.isArray(o.RolePlayList)&&(this.privRolePlayList=[...o.RolePlayList]),o.VoiceTag&&(this.privVoiceTag=o.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}e.VoiceInfo=s})(xa)),xa}var oi={},Jh;function eR(){if(Jh)return oi;Jh=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.SpeakerAudioDestination=void 0;const e=F(),t=lr(),r=er(),i=1800,n={[r.AudioFormatTag.PCM]:"audio/wav",[r.AudioFormatTag.MuLaw]:"audio/x-wav",[r.AudioFormatTag.MP3]:"audio/mpeg",[r.AudioFormatTag.OGG_OPUS]:"audio/ogg",[r.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[r.AudioFormatTag.ALaw]:"audio/x-wav",[r.AudioFormatTag.FLAC]:"audio/flac",[r.AudioFormatTag.AMR_WB]:"audio/amr-wb",[r.AudioFormatTag.G722]:"audio/G722"};let s=class{constructor(o){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=o||(0,e.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(o,c,u){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(o),this.updateSourceBuffer().then(()=>{c&&c()},p=>{u&&u(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(o),this.privBytesReceived+=o.byteLength)}close(o,c){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{o&&o()},u=>{c&&c(u)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===r.AudioFormatTag.PCM||this.privFormat.formatTag===r.AudioFormatTag.MuLaw||this.privFormat.formatTag===r.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let u=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(u).then(()=>{u=this.privFormat.addHeader(u);const p=new Blob([u],{type:n[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{o&&o()},d=>{c&&c(d)})},p=>{c&&c(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(o){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=o;const c=n[this.privFormat.formatTag];c===void 0?console.warn(`Unknown mimeType for format ${r.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(c)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=i,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(c),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})):(console.warn(`Format ${r.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var o;return((o=this.privAudio)==null?void 0:o.volume)??-1}set volume(o){this.privAudio&&(this.privAudio.volume=o)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(o,c){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{o&&o()},u=>{c&&c(u)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const o=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(o)}catch{this.privAudioBuffer.unshift(o),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return oi.SpeakerAudioDestination=s,oi}var si={},Qh;function tR(){if(Qh)return si;Qh=1,Object.defineProperty(si,"__esModule",{value:!0}),si.ConversationTranscriptionCanceledEventArgs=void 0;const e=_o();let t=class extends e.CancellationEventArgsBase{};return si.ConversationTranscriptionCanceledEventArgs=t,si}var ai={},Yh;function rR(){if(Yh)return ai;Yh=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.MeetingTranscriptionCanceledEventArgs=void 0;const e=_o();let t=class extends e.CancellationEventArgsBase{};return ai.MeetingTranscriptionCanceledEventArgs=t,ai}var Ha={},Zh;function nR(){return Zh||(Zh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGradingSystem=void 0,(function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"})(e.PronunciationAssessmentGradingSystem||(e.PronunciationAssessmentGradingSystem={}))})(Ha)),Ha}var $a={},Xh;function iR(){return Xh||(Xh=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGranularity=void 0,(function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"})(e.PronunciationAssessmentGranularity||(e.PronunciationAssessmentGranularity={}))})($a)),$a}var ci={},ev;function oR(){if(ev)return ci;ev=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.PronunciationAssessmentConfig=void 0;const e=$(),t=O();let r=class im{constructor(n,s=t.PronunciationAssessmentGradingSystem.FivePoint,a=t.PronunciationAssessmentGranularity.Phoneme,o=!1){e.Contracts.throwIfNullOrUndefined(n,"referenceText"),this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,n),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_GradingSystem,t.PronunciationAssessmentGradingSystem[s]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Granularity,t.PronunciationAssessmentGranularity[a]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,String(o))}static fromJSON(n){e.Contracts.throwIfNullOrUndefined(n,"json");const s=new im("");return s.privProperties=new t.PropertyCollection,s.properties.setProperty(t.PropertyId.PronunciationAssessment_Json,n),s}toJSON(){return this.updateJson(),this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Params)}applyTo(n){this.updateJson();const s=n.internalData;s.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(t.PropertyId.PronunciationAssessment_Params),s.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(n){e.Contracts.throwIfNullOrWhitespace(n,"referenceText"),this.properties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,n)}set phonemeAlphabet(n){e.Contracts.throwIfNullOrWhitespace(n,"phonemeAlphabet"),this.privPhonemeAlphabet=n}set enableMiscue(n){const s=n?"true":"false";this.properties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,s)}get enableMiscue(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(n){this.privNBestPhonemeCount=n}set enableProsodyAssessment(n){this.privEnableProsodyAssessment=n}get properties(){return this.privProperties}updateJson(){const n=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Json,"{}"),s=JSON.parse(n),a=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText);a&&(s.referenceText=a);const o=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_GradingSystem);o&&(s.gradingSystem=o);const c=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Granularity);c&&(s.granularity=c),this.privPhonemeAlphabet&&(s.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(s.nbestPhonemeCount=this.privNBestPhonemeCount),s.enableProsodyAssessment=this.privEnableProsodyAssessment,s.dimension="Comprehensive",this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue)&&(s.enableMiscue=this.enableMiscue),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Params,JSON.stringify(s))}};return ci.PronunciationAssessmentConfig=r,ci}var ui={},tv;function sR(){if(tv)return ui;tv=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.PronunciationAssessmentResult=void 0;const e=$(),t=O();let r=class om{constructor(n){const s=JSON.parse(n);e.Contracts.throwIfNullOrUndefined(s.NBest[0],"NBest"),this.privPronJson=s.NBest[0]}static fromResult(n){e.Contracts.throwIfNullOrUndefined(n,"result");const s=n.properties.getProperty(t.PropertyId.SpeechServiceResponse_JsonResult);return e.Contracts.throwIfNullOrUndefined(s,"json"),new om(s)}get detailResult(){return this.privPronJson}get accuracyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.AccuracyScore}get pronunciationScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.PronScore}get completenessScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.CompletenessScore}get fluencyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.FluencyScore}get prosodyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.ProsodyScore}};return ui.PronunciationAssessmentResult=r,ui}var pi={},rv;function aR(){if(rv)return pi;rv=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.AvatarConfig=void 0;const e=$(),t=O();let r=class{constructor(n,s,a){this.privCustomized=!1,this.privUseBuiltInVoice=!1,e.Contracts.throwIfNullOrWhitespace(n,"character"),this.character=n,this.style=s,a===void 0&&(a=new t.AvatarVideoFormat),this.videoFormat=a}get customized(){return this.privCustomized}set customized(n){this.privCustomized=n}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(n){this.privUseBuiltInVoice=n}get photoAvatarBaseModel(){return this.privPhotoAvatarBaseModel}set photoAvatarBaseModel(n){this.privPhotoAvatarBaseModel=n}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(n){this.privBackgroundColor=n}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(n){this.privBackgroundImage=n}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(n){this.privRemoteIceServers=n}};return pi.AvatarConfig=r,pi}var Wa={},nv;function cR(){return nv||(nv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarEventArgs=e.AvatarEventTypes=void 0,(function(r){r.SwitchedToSpeaking="SwitchedToSpeaking",r.SwitchedToIdle="SwitchedToIdle",r.SessionClosed="SessionClosed"})(e.AvatarEventTypes||(e.AvatarEventTypes={}));class t{constructor(i,n){this.privOffset=i,this.privDescription=n}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}e.AvatarEventArgs=t})(Wa)),Wa}var di={},li={},iv;function sm(){if(iv)return li;iv=1,Object.defineProperty(li,"__esModule",{value:!0}),li.SpeechSynthesisConnectionFactory=void 0;const e=Se(),t=O(),r=st(),i=L(),n=Ee(),s=Pt();let a=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(c,u,p){let d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),l=r.ConnectionFactoryBase.getHostSuffix(h),f=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=f===void 0?"tts":"voice",P=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+h+"."+m+".speech"+l),g={},w={};if(u.token!==void 0&&u.token!==""&&(w[u.headerName]=u.token),w[n.HeaderNames.ConnectionId]=p,f!==void 0&&f!==""&&(!d||d.search(s.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(g[s.QueryParameterNames.CustomVoiceDeploymentId]=f),c.avatarEnabled&&(!d||d.search(s.QueryParameterNames.EnableAvatar)===-1)&&(g[s.QueryParameterNames.EnableAvatar]="true"),d){const A=new URL(d),I=A.pathname;(I===""||I==="/")&&(A.pathname=this.synthesisUri,d=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(A.toString()))}d||(d=P+this.synthesisUri),c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,d);const R=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(d,g,w,new i.WebsocketMessageFormatter,e.ProxyInfo.fromParameters(c.parameters),R,p)}};return li.SpeechSynthesisConnectionFactory=a,li}var ov;function uR(){if(ov)return di;ov=1,Object.defineProperty(di,"__esModule",{value:!0}),di.AvatarSynthesizer=void 0;const e=sm(),t=L(),r=F(),i=Io(),n=O(),s=$(),a=np();let o=class extends n.Synthesizer{constructor(u,p){super(u),s.Contracts.throwIfNullOrUndefined(p,"avatarConfig"),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.privAvatarConfig=p,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=i.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(n.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(u){s.Contracts.throwIfNullOrUndefined(u,"peerConnection"),this.privIceServers=u.getConfiguration().iceServers,s.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const p=new r.Deferred;u.onicegatheringstatechange=()=>{r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering state: "+u.iceGatheringState,r.EventType.Debug)),u.iceGatheringState==="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering complete.",r.EventType.Info)),p.resolve())},u.onicecandidate=m=>{m.candidate?r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: "+m.candidate.candidate,r.EventType.Debug)):(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: complete",r.EventType.Debug)),p.resolve())},setTimeout(()=>{u.iceGatheringState!=="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering timeout.",r.EventType.Warning)),p.resolve())},2e3);const d=await u.createOffer();await u.setLocalDescription(d),await p.promise,r.Events.instance.onEvent(new r.PlatformEvent("peer connection: got local SDP.",r.EventType.Info)),this.privProperties.setProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(u.localDescription));const h=await this.speak("",!1);if(h.reason!==n.ResultReason.SynthesizingAudioCompleted)return new n.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties);const l=atob(h.properties.getProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP)),f=new RTCSessionDescription(JSON.parse(l));return await u.setRemoteDescription(f),new n.SynthesisResult(h.resultId,h.reason,void 0,h.properties)}async speakTextAsync(u){const p=await this.speak(u,!1);return new n.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async speakSsmlAsync(u){const p=await this.speak(u,!0);return new n.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return s.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(u,p,d){return new t.AvatarSynthesisAdapter(u,p,d,this,this.privAvatarConfig)}createRestSynthesisAdapter(u,p){}createSynthesizerConfig(u){const p=super.createSynthesizerConfig(u);return p.avatarEnabled=!0,p}async speak(u,p){const d=(0,r.createNoDashGuid)(),h=new r.Deferred;return this.synthesisRequestQueue.enqueue(new a.SynthesisRequest(d,u,p,l=>{h.resolve(l),this.privSynthesizing=!1,this.adapterSpeak()},l=>{h.reject(l),this.privSynthesizing=!1})),this.adapterSpeak(),h.promise}};return di.AvatarSynthesizer=o,di}var Ht={},sv;function pR(){if(sv)return Ht;sv=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.AvatarVideoFormat=Ht.Coordinate=void 0;class e{constructor(i,n){this.x=i,this.y=n}}Ht.Coordinate=e;let t=class{constructor(i="H264",n=2e6,s=1920,a=1080){this.codec=i,this.bitrate=n,this.width=s,this.height=a}setCropRange(i,n){this.cropRange={bottomRight:n,topLeft:i}}};return Ht.AvatarVideoFormat=t,Ht}var hi={},av;function dR(){if(av)return hi;av=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.AvatarWebRTCConnectionResult=void 0;const e=O();let t=class extends e.SynthesisResult{constructor(i,n,s,a,o){super(n,s,a,o),this.privSDPAnswer=i}get SDPAnswer(){return this.privSDPAnswer}};return hi.AvatarWebRTCConnectionResult=t,hi}var vi={},cv;function lR(){if(cv)return vi;cv=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Diagnostics=void 0;const e=Se(),t=F();let r=class{static SetLoggingLevel(n){this.privListener=new e.ConsoleLoggingListener(n),t.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(n){if(typeof window>"u")this.privListener&&(this.privListener.logPath=n);else throw new Error("File system logging not available in browser.")}static set onLogOutput(n){this.privListener&&(this.privListener.logCallback=n)}};return vi.Diagnostics=r,r.privListener=void 0,vi}var uv;function O(){return uv||(uv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CustomCommandsConfig=e.BotFrameworkConfig=e.DialogServiceConfig=e.PhraseListGrammar=e.Connection=e.ServiceEventArgs=e.ConnectionEventArgs=e.CancellationErrorCode=e.CancellationDetails=e.CancellationDetailsBase=e.TranslationRecognitionCanceledEventArgs=e.NoMatchDetails=e.NoMatchReason=e.Translations=e.TranslationRecognizer=e.SpeechRecognizer=e.Recognizer=e.PropertyId=e.PropertyCollection=e.SpeechTranslationConfigImpl=e.SpeechTranslationConfig=e.SpeechConfigImpl=e.SpeechConfig=e.ResultReason=e.TranslationSynthesisResult=e.TranslationRecognitionResult=e.TranslationSynthesisEventArgs=e.TranslationRecognitionEventArgs=e.SpeechRecognitionCanceledEventArgs=e.MeetingTranscriptionEventArgs=e.ConversationTranscriptionEventArgs=e.SpeechRecognitionEventArgs=e.SpeechRecognitionResult=e.RecognitionResult=e.OutputFormat=e.RecognitionEventArgs=e.SessionEventArgs=e.KeywordRecognitionModel=e.PushAudioOutputStreamCallback=e.PullAudioInputStreamCallback=e.CancellationReason=e.PushAudioOutputStream=e.PullAudioOutputStream=e.AudioOutputStream=e.PushAudioInputStream=e.PullAudioInputStream=e.AudioInputStream=e.AudioFormatTag=e.AudioStreamFormat=e.AudioConfig=void 0,e.AvatarSynthesizer=e.AvatarEventArgs=e.AvatarConfig=e.LanguageIdMode=e.PronunciationAssessmentResult=e.PronunciationAssessmentConfig=e.PronunciationAssessmentGranularity=e.PronunciationAssessmentGradingSystem=e.MeetingTranscriptionCanceledEventArgs=e.ConversationTranscriptionCanceledEventArgs=e.SpeakerAudioDestination=e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=e.SynthesisVoicesResult=e.SpeechSynthesisBoundaryType=e.SpeechSynthesisVisemeEventArgs=e.SpeechSynthesisBookmarkEventArgs=e.SpeechSynthesisWordBoundaryEventArgs=e.SpeechSynthesisEventArgs=e.SpeechSynthesisResult=e.SynthesisResult=e.SpeechSynthesizer=e.SpeechSynthesisOutputFormat=e.Synthesizer=e.User=e.ParticipantChangedReason=e.Participant=e.MeetingTranscriber=e.Meeting=e.ConversationTranscriptionResult=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.Conversation=e.SourceLanguageConfig=e.AutoDetectSourceLanguageResult=e.AutoDetectSourceLanguageConfig=e.ConnectionMessage=e.ConnectionMessageEventArgs=e.BaseAudioPlayer=e.ProfanityOption=e.ServicePropertyChannel=e.TurnStatusReceivedEventArgs=e.ActivityReceivedEventArgs=e.DialogServiceConnector=void 0,e.LogLevel=e.Diagnostics=e.AvatarWebRTCConnectionResult=e.Coordinate=e.AvatarVideoFormat=void 0;var t=qP();Object.defineProperty(e,"AudioConfig",{enumerable:!0,get:function(){return t.AudioConfig}});var r=er();Object.defineProperty(e,"AudioStreamFormat",{enumerable:!0,get:function(){return r.AudioStreamFormat}}),Object.defineProperty(e,"AudioFormatTag",{enumerable:!0,get:function(){return r.AudioFormatTag}});var i=Ng();Object.defineProperty(e,"AudioInputStream",{enumerable:!0,get:function(){return i.AudioInputStream}}),Object.defineProperty(e,"PullAudioInputStream",{enumerable:!0,get:function(){return i.PullAudioInputStream}}),Object.defineProperty(e,"PushAudioInputStream",{enumerable:!0,get:function(){return i.PushAudioInputStream}});var n=lr();Object.defineProperty(e,"AudioOutputStream",{enumerable:!0,get:function(){return n.AudioOutputStream}}),Object.defineProperty(e,"PullAudioOutputStream",{enumerable:!0,get:function(){return n.PullAudioOutputStream}}),Object.defineProperty(e,"PushAudioOutputStream",{enumerable:!0,get:function(){return n.PushAudioOutputStream}});var s=BP();Object.defineProperty(e,"CancellationReason",{enumerable:!0,get:function(){return s.CancellationReason}});var a=UP();Object.defineProperty(e,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return a.PullAudioInputStreamCallback}});var o=xP();Object.defineProperty(e,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return o.PushAudioOutputStreamCallback}});var c=HP();Object.defineProperty(e,"KeywordRecognitionModel",{enumerable:!0,get:function(){return c.KeywordRecognitionModel}});var u=$P();Object.defineProperty(e,"SessionEventArgs",{enumerable:!0,get:function(){return u.SessionEventArgs}});var p=WP();Object.defineProperty(e,"RecognitionEventArgs",{enumerable:!0,get:function(){return p.RecognitionEventArgs}});var d=VP();Object.defineProperty(e,"OutputFormat",{enumerable:!0,get:function(){return d.OutputFormat}});var h=KP();Object.defineProperty(e,"RecognitionResult",{enumerable:!0,get:function(){return h.RecognitionResult}});var l=GP();Object.defineProperty(e,"SpeechRecognitionResult",{enumerable:!0,get:function(){return l.SpeechRecognitionResult}});var f=JP();Object.defineProperty(e,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return f.SpeechRecognitionEventArgs}}),Object.defineProperty(e,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return f.ConversationTranscriptionEventArgs}}),Object.defineProperty(e,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return f.MeetingTranscriptionEventArgs}});var m=QP();Object.defineProperty(e,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return m.SpeechRecognitionCanceledEventArgs}});var P=YP();Object.defineProperty(e,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return P.TranslationRecognitionEventArgs}});var g=ZP();Object.defineProperty(e,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return g.TranslationSynthesisEventArgs}});var w=Fg();Object.defineProperty(e,"TranslationRecognitionResult",{enumerable:!0,get:function(){return w.TranslationRecognitionResult}});var R=XP();Object.defineProperty(e,"TranslationSynthesisResult",{enumerable:!0,get:function(){return R.TranslationSynthesisResult}});var A=ew();Object.defineProperty(e,"ResultReason",{enumerable:!0,get:function(){return A.ResultReason}});var I=tw();Object.defineProperty(e,"SpeechConfig",{enumerable:!0,get:function(){return I.SpeechConfig}}),Object.defineProperty(e,"SpeechConfigImpl",{enumerable:!0,get:function(){return I.SpeechConfigImpl}});var D=rw();Object.defineProperty(e,"SpeechTranslationConfig",{enumerable:!0,get:function(){return D.SpeechTranslationConfig}}),Object.defineProperty(e,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return D.SpeechTranslationConfigImpl}});var q=Bg();Object.defineProperty(e,"PropertyCollection",{enumerable:!0,get:function(){return q.PropertyCollection}});var M=ep();Object.defineProperty(e,"PropertyId",{enumerable:!0,get:function(){return M.PropertyId}});var K=nw();Object.defineProperty(e,"Recognizer",{enumerable:!0,get:function(){return K.Recognizer}});var Q=iw();Object.defineProperty(e,"SpeechRecognizer",{enumerable:!0,get:function(){return Q.SpeechRecognizer}});var Ae=ow();Object.defineProperty(e,"TranslationRecognizer",{enumerable:!0,get:function(){return Ae.TranslationRecognizer}});var nr=sw();Object.defineProperty(e,"Translations",{enumerable:!0,get:function(){return nr.Translations}});var le=aw();Object.defineProperty(e,"NoMatchReason",{enumerable:!0,get:function(){return le.NoMatchReason}});var Yp=cw();Object.defineProperty(e,"NoMatchDetails",{enumerable:!0,get:function(){return Yp.NoMatchDetails}});var ty=uw();Object.defineProperty(e,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return ty.TranslationRecognitionCanceledEventArgs}});var ry=Kg();Object.defineProperty(e,"CancellationDetailsBase",{enumerable:!0,get:function(){return ry.CancellationDetailsBase}});var ny=pw();Object.defineProperty(e,"CancellationDetails",{enumerable:!0,get:function(){return ny.CancellationDetails}});var iy=dw();Object.defineProperty(e,"CancellationErrorCode",{enumerable:!0,get:function(){return iy.CancellationErrorCode}});var oy=lw();Object.defineProperty(e,"ConnectionEventArgs",{enumerable:!0,get:function(){return oy.ConnectionEventArgs}});var sy=hw();Object.defineProperty(e,"ServiceEventArgs",{enumerable:!0,get:function(){return sy.ServiceEventArgs}});var ay=$g();Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return ay.Connection}});var cy=vw();Object.defineProperty(e,"PhraseListGrammar",{enumerable:!0,get:function(){return cy.PhraseListGrammar}});var uy=tp();Object.defineProperty(e,"DialogServiceConfig",{enumerable:!0,get:function(){return uy.DialogServiceConfig}});var py=fw();Object.defineProperty(e,"BotFrameworkConfig",{enumerable:!0,get:function(){return py.BotFrameworkConfig}});var dy=gw();Object.defineProperty(e,"CustomCommandsConfig",{enumerable:!0,get:function(){return dy.CustomCommandsConfig}});var ly=Sw();Object.defineProperty(e,"DialogServiceConnector",{enumerable:!0,get:function(){return ly.DialogServiceConnector}});var hy=Cw();Object.defineProperty(e,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return hy.ActivityReceivedEventArgs}});var vy=Pw();Object.defineProperty(e,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return vy.TurnStatusReceivedEventArgs}});var fy=ww();Object.defineProperty(e,"ServicePropertyChannel",{enumerable:!0,get:function(){return fy.ServicePropertyChannel}});var gy=Rw();Object.defineProperty(e,"ProfanityOption",{enumerable:!0,get:function(){return gy.ProfanityOption}});var my=Ew();Object.defineProperty(e,"BaseAudioPlayer",{enumerable:!0,get:function(){return my.BaseAudioPlayer}});var Sy=Aw();Object.defineProperty(e,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Sy.ConnectionMessageEventArgs}});var Cy=Hg();Object.defineProperty(e,"ConnectionMessage",{enumerable:!0,get:function(){return Cy.ConnectionMessage}});var yy=Tw();Object.defineProperty(e,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return yy.AutoDetectSourceLanguageConfig}});var Py=bw();Object.defineProperty(e,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Py.AutoDetectSourceLanguageResult}});var wy=Iw();Object.defineProperty(e,"SourceLanguageConfig",{enumerable:!0,get:function(){return wy.SourceLanguageConfig}});var ve=rp();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return ve.Conversation}}),Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return ve.ConversationExpirationEventArgs}}),Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return ve.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return ve.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return ve.ConversationTranslationEventArgs}}),Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return ve.ConversationTranslationResult}}),Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return ve.ConversationTranslator}}),Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return ve.ConversationTranscriber}}),Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return ve.ConversationTranscriptionResult}}),Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return ve.Meeting}}),Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return ve.MeetingTranscriber}}),Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return ve.Participant}}),Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return ve.ParticipantChangedReason}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return ve.User}});var Ry=np();Object.defineProperty(e,"Synthesizer",{enumerable:!0,get:function(){return Ry.Synthesizer}});var Ey=jg();Object.defineProperty(e,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Ey.SpeechSynthesisOutputFormat}});var Ay=$w();Object.defineProperty(e,"SpeechSynthesizer",{enumerable:!0,get:function(){return Ay.SpeechSynthesizer}});var Ty=Ww();Object.defineProperty(e,"SynthesisResult",{enumerable:!0,get:function(){return Ty.SynthesisResult}});var by=Vw();Object.defineProperty(e,"SpeechSynthesisResult",{enumerable:!0,get:function(){return by.SpeechSynthesisResult}});var Iy=Kw();Object.defineProperty(e,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return Iy.SpeechSynthesisEventArgs}});var _y=Gw();Object.defineProperty(e,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return _y.SpeechSynthesisWordBoundaryEventArgs}});var Oy=Jw();Object.defineProperty(e,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Oy.SpeechSynthesisBookmarkEventArgs}});var My=Qw();Object.defineProperty(e,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return My.SpeechSynthesisVisemeEventArgs}});var Dy=Yw();Object.defineProperty(e,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return Dy.SpeechSynthesisBoundaryType}});var ky=Zw();Object.defineProperty(e,"SynthesisVoicesResult",{enumerable:!0,get:function(){return ky.SynthesisVoicesResult}});var ra=Xw();Object.defineProperty(e,"SynthesisVoiceGender",{enumerable:!0,get:function(){return ra.SynthesisVoiceGender}}),Object.defineProperty(e,"SynthesisVoiceType",{enumerable:!0,get:function(){return ra.SynthesisVoiceType}}),Object.defineProperty(e,"VoiceInfo",{enumerable:!0,get:function(){return ra.VoiceInfo}});var Ny=eR();Object.defineProperty(e,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Ny.SpeakerAudioDestination}});var jy=tR();Object.defineProperty(e,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return jy.ConversationTranscriptionCanceledEventArgs}});var zy=rR();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return zy.MeetingTranscriptionCanceledEventArgs}});var Ly=nR();Object.defineProperty(e,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Ly.PronunciationAssessmentGradingSystem}});var Fy=iR();Object.defineProperty(e,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Fy.PronunciationAssessmentGranularity}});var qy=oR();Object.defineProperty(e,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return qy.PronunciationAssessmentConfig}});var By=sR();Object.defineProperty(e,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return By.PronunciationAssessmentResult}});var Uy=Qg();Object.defineProperty(e,"LanguageIdMode",{enumerable:!0,get:function(){return Uy.LanguageIdMode}});var xy=aR();Object.defineProperty(e,"AvatarConfig",{enumerable:!0,get:function(){return xy.AvatarConfig}});var Hy=cR();Object.defineProperty(e,"AvatarEventArgs",{enumerable:!0,get:function(){return Hy.AvatarEventArgs}});var $y=uR();Object.defineProperty(e,"AvatarSynthesizer",{enumerable:!0,get:function(){return $y.AvatarSynthesizer}});var Zp=pR();Object.defineProperty(e,"AvatarVideoFormat",{enumerable:!0,get:function(){return Zp.AvatarVideoFormat}}),Object.defineProperty(e,"Coordinate",{enumerable:!0,get:function(){return Zp.Coordinate}});var Wy=dR();Object.defineProperty(e,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Wy.AvatarWebRTCConnectionResult}});var Vy=lR();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return Vy.Diagnostics}});var Ky=Mg();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return Ky.LogLevel}})})(Ta)),Ta}var pv;function hR(){if(pv)return Qr;pv=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.ProxyInfo=void 0;const e=O();let t=class am{constructor(i,n,s,a){this.privProxyHostName=i,this.privProxyPort=n,this.privProxyUserName=s,this.privProxyPassword=a}static fromParameters(i){return new am(i.getProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(i.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPort),10),i.getProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName),i.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(i){return this.fromParameters(i.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return Qr.ProxyInfo=t,Qr}var fi={},Va,dv;function vR(){if(dv)return Va;dv=1;const e=new Set(["json","buffer","string"]);return Va=t=>(...r)=>{const i=new Set;let n,s,a,o="";return r.forEach(c=>{if(typeof c=="string")if(c.toUpperCase()===c)if(n){const u=`Can't set method to ${c}, already set to ${n}.`;throw new Error(u)}else n=c;else if(c.startsWith("http:")||c.startsWith("https:"))o=c;else if(e.has(c))s=c;else throw new Error(`Unknown encoding, ${c}`);else if(typeof c=="number")i.add(c);else if(typeof c=="object")if(Array.isArray(c)||c instanceof Set)c.forEach(u=>i.add(u));else{if(a)throw new Error("Cannot set headers twice.");a=c}else throw new Error(`Unknown type: ${typeof c}`)}),n||(n="GET"),i.size===0&&i.add(200),t(i,n,s,a,o)},Va}var Ka,lv;function fR(){if(lv)return Ka;lv=1;const e=vR();class t extends Error{constructor(n,...s){super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="StatusError",this.message=n.statusMessage,this.statusCode=n.status,this.res=n,this.json=n.json.bind(n),this.text=n.text.bind(n),this.arrayBuffer=n.arrayBuffer.bind(n);let a;Object.defineProperty(this,"responseBody",{get:()=>(a||(a=this.arrayBuffer()),a)}),this.headers={};for(const[c,u]of n.headers.entries())this.headers[c.toLowerCase()]=u}}return Ka=e((i,n,s,a,o)=>async(c,u,p={})=>{c=o+(c||"");let d=new URL(c);if(a||(a={}),d.username&&(a.Authorization="Basic "+btoa(d.username+":"+d.password),d=new URL(d.protocol+"//"+d.host+d.pathname+d.search)),d.protocol!=="https:"&&d.protocol!=="http:")throw new Error(`Unknown protocol, ${d.protocol}`);if(u&&!(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="string"))if(typeof u=="object")u=JSON.stringify(u),a["Content-Type"]="application/json";else throw new Error("Unknown body type.");p=new Headers({...a||{},...p});const h=await fetch(d,{method:n,headers:p,body:u});if(h.statusCode=h.status,!i.has(h.status))throw new t(h);return s==="json"?h.json():s==="buffer"?h.arrayBuffer():s==="string"?h.text():h}),Ka}var hv;function gR(){return hv||(hv=1,(function(e){var t=fi&&fi.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.RestMessageAdapter=e.RestRequestType=void 0;const r=t(fR()),i=F();var n;(function(a){a.Get="GET",a.Post="POST",a.Delete="DELETE",a.File="file"})(n=e.RestRequestType||(e.RestRequestType={}));let s=class{constructor(o){if(!o)throw new i.ArgumentNullError("configParams");this.privHeaders=o.headers,this.privIgnoreCache=o.ignoreCache}static extractHeaderValue(o,c){let u="";try{const p=c.trim().split(/[\r\n]+/),d={};p.forEach(h=>{const l=h.split(": "),f=l.shift().toLowerCase(),m=l.join(": ");d[f]=m}),u=d[o.toLowerCase()]}catch{}return u}set options(o){this.privHeaders=o.headers,this.privIgnoreCache=o.ignoreCache}setHeaders(o,c){this.privHeaders[o]=c}request(o,c,u={},p=null){const d=new i.Deferred,h=o===n.File?"POST":o,l=(m,P={})=>{const g=m;return{data:JSON.stringify(P),headers:JSON.stringify(m.headers),json:P,ok:m.statusCode>=200&&m.statusCode<300,status:m.statusCode,statusText:P.error?P.error.message:g.statusText?g.statusText:g.statusMessage}},f=m=>{const P=(0,r.default)(c,h,this.privHeaders,200,201,202,204,400,401,402,403,404),g=this.queryParams(u)===""?"":`?${this.queryParams(u)}`;P(g,m).then(async w=>{if(o===n.Delete||w.statusCode===204)d.resolve(l(w));else try{const R=await w.json();d.resolve(l(w,R))}catch{d.resolve(l(w))}}).catch(w=>{d.reject(w)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),o===n.Post&&p&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),f(p),d.promise}queryParams(o={}){return Object.keys(o).map(c=>encodeURIComponent(c)+"="+encodeURIComponent(o[c])).join("&")}};e.RestMessageAdapter=s})(fi)),fi}var gi={},vv;function cm(){if(vv)return gi;vv=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.RestConfigBase=void 0;let e=class Go{static get requestOptions(){return Go.privDefaultRequestOptions}static get configParams(){return Go.privDefaultParams}static get restErrors(){return Go.privRestErrors}};return gi.RestConfigBase=e,e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},gi}var fv;function Se(){return fv||(fv=1,(function(e){var t=Nt&&Nt.__createBinding||(Object.create?(function(i,n,s,a){a===void 0&&(a=s),Object.defineProperty(i,a,{enumerable:!0,get:function(){return n[s]}})}):(function(i,n,s,a){a===void 0&&(a=s),i[a]=n[s]})),r=Nt&&Nt.__exportStar||function(i,n){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(n,s)&&t(n,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),r(DP(),e),r(kP(),e),r(NP(),e),r(jP(),e),r(zP(),e),r(LP(),e),r(Dg(),e),r(FP(),e),r(hR(),e),r(gR(),e),r(cm(),e)})(Nt)),Nt}var mi={},gv;function Rs(){if(gv)return mi;gv=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.SpeechConnectionMessage=void 0;const e=F(),t=Ee();class r extends e.ConnectionMessage{constructor(n,s,a,o,c,u,p,d){if(!s)throw new e.ArgumentNullError("path");if(!a)throw new e.ArgumentNullError("requestId");const h={};if(h[t.HeaderNames.Path]=s,h[t.HeaderNames.RequestId]=a,h[t.HeaderNames.RequestTimestamp]=new Date().toISOString(),o&&(h[t.HeaderNames.ContentType]=o),u&&(h[t.HeaderNames.RequestStreamId]=u),p)for(const l in p)l&&(h[l]=p[l]);d?super(n,c,h,d):super(n,c,h),this.privPath=s,this.privRequestId=a,this.privContentType=o,this.privStreamId=u,this.privAdditionalHeaders=p}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(n){let s=null,a=null,o=null,c=null;const u={};if(n.headers)for(const p in n.headers)p&&(p.toLowerCase()===t.HeaderNames.Path.toLowerCase()?s=n.headers[p]:p.toLowerCase()===t.HeaderNames.RequestId.toLowerCase()?a=n.headers[p]:p.toLowerCase()===t.HeaderNames.ContentType.toLowerCase()?o=n.headers[p]:p.toLowerCase()===t.HeaderNames.RequestStreamId.toLowerCase()?c=n.headers[p]:u[p]=n.headers[p]);return new r(n.messageType,s,a,o,n.body,c,u,n.id)}}return mi.SpeechConnectionMessage=r,mi}var Ga={},mv;function mR(){return mv||(mv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SegmentationMode=void 0,(function(t){t.Normal="Normal",t.Disabled="Disabled",t.Custom="Custom",t.Semantic="Semantic"})(e.SegmentationMode||(e.SegmentationMode={}))})(Ga)),Ga}var Ja={},Sv;function SR(){return Sv||(Sv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.None="None",t.Synthesize="Synthesize"})(e.NextAction||(e.NextAction={}))})(Ja)),Ja}var Qa={},Cv;function CR(){return Cv||(Cv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Mode=void 0,(function(t){t.None="None",t.Always="Always"})(e.Mode||(e.Mode={}))})(Qa)),Qa}var Ya={},yv;function yR(){return yv||(yv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdDetectionPriority=e.LanguageIdDetectionMode=void 0,(function(t){t.DetectAtAudioStart="DetectAtAudioStart",t.DetectContinuous="DetectContinuous",t.DetectSegments="DetectSegments"})(e.LanguageIdDetectionMode||(e.LanguageIdDetectionMode={})),(function(t){t.Auto="Auto",t.PrioritizeLatency="PrioritizeLatency",t.PrioritizeAccuracy="PrioritizeAccuracy"})(e.LanguageIdDetectionPriority||(e.LanguageIdDetectionPriority={}))})(Ya)),Ya}var Za={},Pv;function PR(){return Pv||(Pv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.Recognize="Recognize",t.None="None"})(e.NextAction||(e.NextAction={}))})(Za)),Za}var Xa={},wv;function wR(){return wv||(wv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnUnknownAction=void 0,(function(t){t.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",t.None="None"})(e.OnUnknownAction||(e.OnUnknownAction={}))})(Xa)),Xa}var ec={},Rv;function RR(){return Rv||(Rv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultType=void 0,(function(t){t.Auto="Auto",t.StableFragment="StableFragment",t.Hypothesis="Hypothesis",t.None="None"})(e.ResultType||(e.ResultType={}))})(ec)),ec}var tc={},Ev;function ER(){return Ev||(Ev=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PhraseResultOutputType=void 0,(function(t){t.Always="Always",t.None="None"})(e.PhraseResultOutputType||(e.PhraseResultOutputType={}))})(tc)),tc}var rc={},Av;function AR(){return Av||(Av=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.None="None",t.Translate="Translate"})(e.NextAction||(e.NextAction={}))})(rc)),rc}var Tv;function TR(){if(Tv)return $r;Tv=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.ServiceRecognizerBase=void 0;const e=Se(),t=F(),r=O(),i=L(),n=Rs(),s=mR(),a=Be(),o=SR(),c=CR(),u=yR(),p=PR(),d=wR(),h=RR(),l=ER(),f=AR();let m=class ao{constructor(g,w,R,A,I){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!g)throw new t.ArgumentNullError("authentication");if(!w)throw new t.ArgumentNullError("connectionFactory");if(!R)throw new t.ArgumentNullError("audioSource");if(!A)throw new t.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=A.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=g,this.privConnectionFactory=w,this.privAudioSource=R,this.privRecognizerConfig=A,this.privIsDisposed=!1,this.privRecognizer=I,this.privRequestSession=new i.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privDynamicGrammar=new i.DynamicGrammarBuilder,this.privSpeechContext=new i.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new i.AgentConfig,this.privRecognizerConfig.parameters.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=t.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(q=>{if(q.name==="ConnectionClosedEvent"){const M=q;(M.statusCode===1003||M.statusCode===1007||M.statusCode===1002||M.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(r.CancellationReason.Error,M.statusCode===1007?r.CancellationErrorCode.BadRequestParameters:r.CancellationErrorCode.ConnectionFailure,`${M.reason} websocket error code: ${M.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,t.createNoDashGuid)())}setTranslationJson(){const g=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(g!==void 0){const w=g.split(","),R=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),A=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),I=R!==void 0?o.NextAction.Synthesize:o.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:I},onSuccess:{action:I},output:{includePassThroughResults:!0,interimResults:{mode:c.Mode.Always}},targetLanguages:w},A!==void 0&&(this.privSpeechContext.getContext().translation.category=A),R!==void 0){const q={};for(const M of w)q[M]=R;this.privSpeechContext.getContext().synthesis={defaultVoices:q}}const D=this.privSpeechContext.getContext().phraseDetection||{};D.onSuccess={action:f.NextAction.Translate},D.onInterim={action:f.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=D}}setSpeechSegmentationTimeoutJson(){const g=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),w=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),R=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationStrategy,void 0),A={mode:s.SegmentationMode.Normal};let I=!1;if(R!==void 0){I=!0;let D=s.SegmentationMode.Normal;switch(R.toLowerCase()){case"default":break;case"time":D=s.SegmentationMode.Custom;break;case"semantic":D=s.SegmentationMode.Semantic;break}A.mode=D}if(g!==void 0){I=!0;const D=parseInt(g,10);A.mode=s.SegmentationMode.Custom,A.segmentationSilenceTimeoutMs=D}if(w!==void 0){I=!0;const D=parseInt(w,10);A.mode=s.SegmentationMode.Custom,A.segmentationForcedTimeoutMs=D}if(I){const D=this.privSpeechContext.getContext().phraseDetection||{};switch(D.mode=this.recognitionMode,this.recognitionMode){case a.RecognitionMode.Conversation:D.conversation=D.conversation??{segmentation:{}},D.conversation.segmentation=A;break;case a.RecognitionMode.Interactive:D.interactive=D.interactive??{segmentation:{}},D.interactive.segmentation=A;break;case a.RecognitionMode.Dictation:D.dictation=D.dictation??{},D.dictation.segmentation=A;break}this.privSpeechContext.getContext().phraseDetection=D}}setLanguageIdJson(){const g=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const w=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");w.length===1&&w[0]===i.AutoDetectSourceLanguagesOpenRangeOptionName&&(w[0]="UND");let R;this.privRecognizerConfig.languageIdMode==="Continuous"?R=u.LanguageIdDetectionMode.DetectContinuous:R=u.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:w,mode:R,onSuccess:{action:p.NextAction.Recognize},onUnknown:{action:d.OnUnknownAction.None},priority:u.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:h.ResultType.Auto},phraseResults:{resultType:l.PhraseResultOutputType.Always}};const A=this.privRecognizerConfig.sourceLanguageModels;A!==void 0&&(g.customModels=A,g.onInterim={action:f.NextAction.None},g.onSuccess={action:f.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=g}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(i.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()===r.OutputFormat[r.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}setSpeechStartEventSensitivityJson(){const g=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_StartEventSensitivity,void 0);if(g!==void 0){let w=!1;switch(g.toLowerCase()){case a.SpeechStartEventSensitivity.Low:case a.SpeechStartEventSensitivity.Medium:case a.SpeechStartEventSensitivity.High:w=!0;break}if(w){const R=this.privSpeechContext.getContext().phraseDetection||{};R.voiceOnsetSensitivity=g.toLowerCase(),this.privSpeechContext.getContext().phraseDetection=R}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(g){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.ConversationTranslator_Token,g)}set authentication(g){this.privAuthentication=g}isDisposed(){return this.privIsDisposed}async dispose(g){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(g)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(g,w,R){if(this.recognizeOverride!==void 0){await this.recognizeOverride(g,w,R);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=g,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const M=this.privSpeechContext.getContext().phraseDetection||{};M.mode=g,this.privSpeechContext.getContext().phraseDetection=M}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.setSpeechStartEventSensitivityJson(),this.privSuccessCallback=w,this.privErrorCallback=R,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const A=this.connectImpl();let I;try{const M=await this.audioSource.attach(this.privRequestSession.audioNodeId),K=await this.audioSource.format,Q=await this.audioSource.deviceInfo;this.privIsLiveAudio=Q.type&&Q.type===i.type.Microphones,I=new e.ReplayableAudioNode(M,K.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(I,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:Q}}catch(M){throw await this.privRequestSession.onStopRecognizing(),M}try{await A}catch(M){await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,M);return}const D=new r.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,D),this.receiveMessage(),this.sendAudio(I).catch(async M=>{await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,M)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(g,w){this.connectImpl().then(()=>{try{g&&g()}catch(R){w&&w(R)}},R=>{try{w&&w(R)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(g){}async sendNetworkMessage(g,w){const R=typeof w=="string"?t.MessageType.Text:t.MessageType.Binary,A=typeof w=="string"?"application/json":"";return(await this.fetchConnection()).send(new n.SpeechConnectionMessage(R,g,this.privRequestSession.requestId,A,w))}set activityTemplate(g){this.privActivityTemplate=g}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(g){this.privExpectContentAssessmentResponse=g}async sendTelemetryData(){const g=this.privRequestSession.getTelemetry();if(ao.telemetryDataEnabled!==!0||this.privIsDisposed||g===null)return;if(ao.telemetryData)try{ao.telemetryData(g)}catch{}await(await this.fetchConnection()).send(new n.SpeechConnectionMessage(t.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",g))}async cancelRecognitionLocal(g,w,R){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,g,w,R))}async receiveMessage(){try{if(this.privIsDisposed)return;let g=await this.fetchConnection();const w=await g.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!w)return this.receiveMessage();this.privServiceHasSentMessage=!0;const R=n.SpeechConnectionMessage.fromConnectionMessage(w);if(R.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(R.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const A=i.SpeechDetected.fromJSON(R.textBody,this.privRequestSession.currentTurnAudioOffset),I=new r.RecognitionEventArgs(A.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,I);break;case"speech.enddetected":let D;R.textBody.length>0?D=R.textBody:D="{ Offset: 0 }";const q=i.SpeechDetected.fromJSON(D,this.privRequestSession.currentTurnAudioOffset),M=new r.RecognitionEventArgs(q.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,M);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(r.CancellationReason.EndOfStream,r.CancellationErrorCode.NoError,void 0));const K=new r.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,K);return}else g=await this.fetchConnection(),await this.sendPrePayloadJSON(g);break;default:await this.processTypeSpecificMessages(R)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(R.path.toLowerCase(),R.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const g=this.privRequestSession.recognitionBytesSent,w=this.privAverageBytesPerMs!==0?g/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(w)}sendSpeechContext(g,w){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const R=this.speechContext.toJSON();if(w&&this.privRequestSession.onSpeechContext(),R)return g.send(new n.SpeechConnectionMessage(t.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",R))}setupTranslationWithLanguageId(){const g=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),w=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(g!==void 0&&w){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:h.ResultType.None},phraseResults:{resultType:l.PhraseResultOutputType.None}};const R=this.privSpeechContext.getContext().translation;if(R){const A=this.privRecognizerConfig.sourceLanguageModels;if(A!==void 0&&A.length>0){const D=this.privSpeechContext.getContext().phraseDetection||{};D.customModels=A,this.privSpeechContext.getContext().phraseDetection=D}this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(R.onSuccess={action:o.NextAction.Synthesize},R.onPassthrough={action:o.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(g,w=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(g);await this.sendSpeechContext(g,w),await this.sendWaveHeader(g)}async sendWaveHeader(g){const w=await this.audioSource.format;return g.send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",w.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(g=>g.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(g,w,R){if(w.onSpeechContext(),ao.telemetryDataEnabled!==!0){const I={context:{system:JSON.parse(R).context.system}};R=JSON.stringify(I)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const A=JSON.parse(R);A.context.DisableReferenceChannel="True",A.context.MicSpec="1_0_0",R=JSON.stringify(A)}if(R)return g.send(new n.SpeechConnectionMessage(t.MessageType.Text,"speech.config",w.requestId,"application/json",R))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(g=>g.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(g){const w=await this.audioSource.format;this.privAverageBytesPerMs=w.avgBytesPerSec/1e3;let R=Date.now();const A=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),I=w.avgBytesPerSec/1e3*parseInt(A,10),D=this.privRequestSession.recogNumber,q=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===D){const M=await this.fetchConnection(),K=await g.read();if(this.privRequestSession.isSpeechEnded)return;let Q,Ae;if(!K||K.isEnd?(Q=null,Ae=0):(Q=K.buffer,this.privRequestSession.onAudioSent(Q.byteLength),I>=this.privRequestSession.bytesSent?Ae=0:Ae=Math.max(0,R-Date.now())),Ae!==0&&await this.delay(Ae),Q!==null&&(R=Date.now()+Q.byteLength*1e3/(w.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===D)if(M.send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,Q)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),K!=null&&K.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return q()}};return q()}async retryableConnect(){let g=!1;this.privAuthFetchEventId=(0,t.createNoDashGuid)();const w=this.privRequestSession.sessionId;this.privConnectionId=w!==void 0?w:(0,t.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let R=0,A="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const D=await(g?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const q=await this.privConnectionFactory.create(this.privRecognizerConfig,D,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(q.events),q.events.attach(K=>{this.connectionEvents.onEvent(K)});const M=await q.open();if(M.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(M.statusCode),Promise.resolve(q);M.statusCode===1006&&(g=!0),R=M.statusCode,A=M.reason}return await this.privRequestSession.onConnectionEstablishCompleted(R,A),Promise.reject(`Unable to contact server. StatusCode: ${R}, ${this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${A}`)}delay(g){return new Promise(w=>this.privSetTimeout(w,g))}writeBufferToConsole(g){let w="Buffer Size: ";if(g===null)w+="null";else{const R=new Uint8Array(g);w+=`${g.byteLength}\r
`;for(let A=0;A<g.byteLength;A++)w+=R[A].toString(16).padStart(2,"0")+" ",(A+1)%16===0&&(console.info(w),w="")}console.info(w)}async sendFinalAudio(){await(await this.fetchConnection()).send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const g=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(g):(await this.sendSpeechServiceConfig(g,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(g,!1),g)}};return $r.ServiceRecognizerBase=m,m.telemetryDataEnabled=!0,$r}var Si={},bv;function bR(){if(bv)return Si;bv=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.ConversationServiceRecognizer=void 0;const e=O(),t=L();let r=class extends t.ServiceRecognizerBase{constructor(n,s,a,o,c){super(n,s,a,o,c),this.handleSpeechPhraseMessage=async u=>this.handleSpeechPhrase(u),this.handleSpeechHypothesisMessage=u=>this.handleSpeechHypothesis(u)}processTypeSpecificMessages(n){}handleRecognizedCallback(n,s,a){}handleRecognizingCallback(n,s,a){}async processSpeechMessages(n){let s=!1;switch(n.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(n.textBody),s=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(n.textBody),s=!0;break}return s}cancelRecognition(n,s,a,o,c){}async handleSpeechPhrase(n){const s=t.SimpleSpeechPhrase.fromJSON(n,this.privRequestSession.currentTurnAudioOffset),a=t.EnumTranslation.implTranslateRecognitionResult(s.RecognitionStatus);let o;const c=new e.PropertyCollection;if(c.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,n),this.privRequestSession.onPhraseRecognized(s.Offset+s.Duration),e.ResultReason.Canceled===a){const u=t.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus),p=t.EnumTranslation.implTranslateCancelErrorCode(s.RecognitionStatus);await this.cancelRecognitionLocal(u,p,t.EnumTranslation.implTranslateErrorDetails(p))}else if(s.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,a,s.DisplayText,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),c);else{const u=t.DetailedSpeechPhrase.fromJSON(n,this.privRequestSession.currentTurnAudioOffset);o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,a,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),c)}this.handleRecognizedCallback(o,o.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(n){const s=t.SpeechHypothesis.fromJSON(n,this.privRequestSession.currentTurnAudioOffset),a=new e.PropertyCollection;a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,n);const o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),a);this.privRequestSession.onHypothesis(s.Offset),this.handleRecognizingCallback(o,s.Duration,this.privRequestSession.sessionId)}};return Si.ConversationServiceRecognizer=r,Si}var nc={},Iv;function IR(){return Iv||(Iv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognizerConfig=e.SpeechResultFormat=void 0;const t=O(),r=L(),i=Be();(function(s){s[s.Simple=0]="Simple",s[s.Detailed=1]="Detailed"})(e.SpeechResultFormat||(e.SpeechResultFormat={}));class n{constructor(a,o){this.privSpeechServiceConfig=a||new r.SpeechServiceConfig(new r.Context(null)),this.privParameters=o,this.privMaxRetryCount=parseInt(o.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=o.getProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(a){this.privRecognitionMode=a,this.privRecognitionActivityTimeout=a===i.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=i.RecognitionMode[a]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==i.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(a){this.parameters.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,a)}get sourceLanguageModels(){const a=[];let o=!1;if(this.autoDetectSourceLanguages!==void 0)for(const c of this.autoDetectSourceLanguages.split(",")){const u=c+t.PropertyId.SpeechServiceConnection_EndpointId.toString(),p=this.parameters.getProperty(u,void 0);p!==void 0?(a.push({language:c,endpoint:p}),o=!0):a.push({language:c,endpoint:""})}return o?a:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(a){this.privEnableSpeakerId=a}}e.RecognizerConfig=n})(nc)),nc}var ic={},_v;function _R(){return _v||(_v=1,Object.defineProperty(ic,"__esModule",{value:!0})),ic}var Ci={},Ov;function OR(){if(Ov)return Ci;Ov=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.WebsocketMessageFormatter=void 0;const e=F(),t=`\r
`;let r=class{toConnectionMessage(n){const s=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const a=n.textContent;let o={},c=null;if(a){const u=a.split(`\r
\r
`);u&&u.length>0&&(o=this.parseHeaders(u[0]),u.length>1&&(c=u[1]))}s.resolve(new e.ConnectionMessage(n.messageType,c,o,n.id))}else if(n.messageType===e.MessageType.Binary){const a=n.binaryContent;let o={},c=null;if(!a||a.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const u=new DataView(a),p=u.getInt16(0);if(a.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");let d="";for(let h=0;h<p;h++)d+=String.fromCharCode(u.getInt8(h+2));o=this.parseHeaders(d),a.byteLength>p+2&&(c=a.slice(2+p)),s.resolve(new e.ConnectionMessage(n.messageType,c,o,n.id))}}catch(a){s.reject(`Error formatting the message. Error: ${a}`)}return s.promise}fromConnectionMessage(n){const s=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const a=`${this.makeHeaders(n)}${t}${n.textBody?n.textBody:""}`;s.resolve(new e.RawWebsocketMessage(e.MessageType.Text,a,n.id))}else if(n.messageType===e.MessageType.Binary){const a=this.makeHeaders(n),o=n.binaryBody,c=this.stringToArrayBuffer(a),u=new Int8Array(c),p=u.byteLength,d=new Int8Array(2+p+(o?o.byteLength:0));if(d[0]=p>>8&255,d[1]=p&255,d.set(u,2),o){const l=new Int8Array(o);d.set(l,2+p)}const h=d.buffer;s.resolve(new e.RawWebsocketMessage(e.MessageType.Binary,h,n.id))}}catch(a){s.reject(`Error formatting the message. ${a}`)}return s.promise}makeHeaders(n){let s="";if(n.headers)for(const a in n.headers)a&&(s+=`${a}: ${n.headers[a]}${t}`);return s}parseHeaders(n){const s={};if(n){const a=n.match(/[^\r\n]+/g);if(s){for(const o of a)if(o){const c=o.indexOf(":"),u=c>0?o.substr(0,c).trim().toLowerCase():o,p=c>0&&o.length>c+1?o.substr(c+1).trim():"";s[u]=p}}}return s}stringToArrayBuffer(n){const s=new ArrayBuffer(n.length),a=new DataView(s);for(let o=0;o<n.length;o++)a.setUint8(o,n.charCodeAt(o));return s}};return Ci.WebsocketMessageFormatter=r,Ci}var yi={},Mv;function MR(){if(Mv)return yi;Mv=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.SpeechConnectionFactory=void 0;const e=Se(),t=L(),r=O(),i=st(),n=L(),s=Ee(),a=Pt(),o=Be();let c=class extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(p,d,h){let l=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const f=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),m=i.ConnectionFactoryBase.getHostSuffix(f),P=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".stt.speech"+m),g={},w=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),R=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(w?(!l||l.search(a.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(g[a.QueryParameterNames.CustomSpeechDeploymentId]=w):R&&(!l||l.search(a.QueryParameterNames.Language)===-1)&&(g[a.QueryParameterNames.Language]=R),(!l||l.search(a.QueryParameterNames.Format)===-1)&&(g[a.QueryParameterNames.Format]=p.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(g[a.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(p,g,l),l){const M=new URL(l),K=M.pathname;(K===""||K==="/")&&(M.pathname=this.universalUri+p.recognitionEndpointVersion,l=await i.ConnectionFactoryBase.getRedirectUrlFromEndpoint(M.toString()))}if(!l)switch(p.recognitionMode){case o.RecognitionMode.Conversation:p.parameters.getProperty(t.ForceDictationPropertyName,"false")==="true"?l=P+this.dictationRelativeUri:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?l=`${P}${this.universalUri}${p.recognitionEndpointVersion}`:l=P+this.conversationRelativeUri;break;case o.RecognitionMode.Dictation:l=P+this.dictationRelativeUri;break;default:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?l=`${P}${this.universalUri}${p.recognitionEndpointVersion}`:l=P+this.interactiveRelativeUri;break}const A={};d.token!==void 0&&d.token!==""&&(A[d.headerName]=d.token),A[s.HeaderNames.ConnectionId]=h,A.connectionId=h;const I=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",D=new e.WebsocketConnection(l,g,A,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),I,h),q=D.uri;return p.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,q),D}};return yi.SpeechConnectionFactory=c,yi}var Pi={},Dv;function DR(){if(Dv)return Pi;Dv=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.ConversationTranscriberConnectionFactory=void 0;const e=Se(),t=O(),r=L(),i=st(),n=L(),s=Ee(),a=Pt();let o=class extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.conversationRelativeUriV1="/speech/recognition/conversation/cognitiveservices/v1"}async create(u,p,d){let h=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),f=i.ConnectionFactoryBase.getHostSuffix(l),m=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+l+".stt.speech"+f),P={},g=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),w=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(g?(!h||h.search(a.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(P[a.QueryParameterNames.CustomSpeechDeploymentId]=g):w&&(!h||h.search(a.QueryParameterNames.Language)===-1)&&(P[a.QueryParameterNames.Language]=w),u.autoDetectSourceLanguages!==void 0&&(P[a.QueryParameterNames.EnableLanguageId]="true"),u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)==="1")h=`${m}${this.universalUri}`;else{if(this.setV2UrlParams(u,P,h),h){const M=new URL(h),K=M.pathname;(K===""||K==="/")&&(M.pathname=this.universalUri,h=await i.ConnectionFactoryBase.getRedirectUrlFromEndpoint(M.toString()))}h||(h=`${m}${this.conversationRelativeUriV1}`)}const A={};p.token!==void 0&&p.token!==""&&(A[p.headerName]=p.token),A[s.HeaderNames.ConnectionId]=d;const I=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",D=new e.WebsocketConnection(h,P,A,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),I,d),q=D.uri;return u.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,q),D}setV2UrlParams(u,p,d){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,a.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,a.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,a.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,a.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,a.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,a.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,a.QueryParameterNames.StableIntermediateThreshold]]).forEach((f,m)=>{this.setUrlParameter(m,f,u,p,d)});const l=JSON.parse(u.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(l).forEach(f=>{p[f]=l[f]})}};return Pi.ConversationTranscriberConnectionFactory=o,Pi}var wi={},kv;function kR(){if(kv)return wi;kv=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.TranscriberConnectionFactory=void 0;const e=Se(),t=O(),r=st(),i=L(),n=Ee(),s=Pt();let a=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(c,u,p){let d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"centralus"),l=r.ConnectionFactoryBase.getHostSuffix(h),f="wss://transcribe."+h+".cts.speech"+l+this.multiaudioRelativeUri,m=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,f),P={};this.setQueryParams(P,c,d),d||(d=m);const g={};u.token!==void 0&&u.token!==""&&(g[u.headerName]=u.token),g[n.HeaderNames.ConnectionId]=p,c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,d);const w=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(d,P,g,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),w,p))}setQueryParams(c,u,p){const d=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),h=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);d&&!(s.QueryParameterNames.CustomSpeechDeploymentId in c)&&(c[s.QueryParameterNames.CustomSpeechDeploymentId]=d),h&&!(s.QueryParameterNames.Language in c)&&(c[s.QueryParameterNames.Language]=h);const l=u.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",f=u.parameters.getProperty(i.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple])!==t.OutputFormat[t.OutputFormat.Simple];(l||f)&&(c[s.QueryParameterNames.Format]=t.OutputFormat[t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(u,c,p)}};return wi.TranscriberConnectionFactory=a,wi}var Ri={},Nv;function NR(){if(Nv)return Ri;Nv=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.TranslationConnectionFactory=void 0;const e=Se(),t=Xg(),r=O(),i=st(),n=L(),s=Ee(),a=Pt(),o=Be();let c=class extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(p,d,h){let l=this.getEndpointUrl(p);const f={};if(this.setQueryParams(f,p,l),l){const w=new URL(l),R=w.pathname;(R===""||R==="/")&&(w.pathname=this.universalUri,l=await i.ConnectionFactoryBase.getRedirectUrlFromEndpoint(w.toString()))}const m={};d.token!==void 0&&d.token!==""&&(m[d.headerName]=d.token),m[s.HeaderNames.ConnectionId]=h,p.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,l);const P=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(l,f,m,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),P,h)}getEndpointUrl(p,d){const h=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),l=i.ConnectionFactoryBase.getHostSuffix(h);let f=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);return f?d===!0?f:t.StringUtils.formatString(f,{region:h}):(p.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?f=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+l)+this.translationV1Uri:f=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+l)+this.universalUri,d===!0?f:t.StringUtils.formatString(f,{region:h}))}setQueryParams(p,d,h){p.from=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage),p.to=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages),p.scenario=d.recognitionMode===o.RecognitionMode.Interactive?"interactive":d.recognitionMode===o.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(d,p,h),this.setUrlParameter(r.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,a.QueryParameterNames.StableTranslation,d,p,h);const l=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);l!==void 0&&(p.voice=l,p.features="requireVoice")}};return Ri.TranslationConnectionFactory=c,Ri}var Ei={},jv;function jR(){if(jv)return Ei;jv=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.EnumTranslation=void 0;const e=O(),t=L();let r=class{static implTranslateRecognitionResult(n,s=!1){let a=e.ResultReason.Canceled;switch(n){case t.RecognitionStatus.Success:a=e.ResultReason.RecognizedSpeech;break;case t.RecognitionStatus.EndOfDictation:a=s?e.ResultReason.RecognizedSpeech:e.ResultReason.NoMatch;break;case t.RecognitionStatus.NoMatch:case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:a=e.ResultReason.NoMatch;break;case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:a=e.ResultReason.Canceled;break}return a}static implTranslateCancelResult(n){let s=e.CancellationReason.EndOfStream;switch(n){case t.RecognitionStatus.Success:case t.RecognitionStatus.EndOfDictation:case t.RecognitionStatus.NoMatch:s=e.CancellationReason.EndOfStream;break;case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:s=e.CancellationReason.Error;break}return s}static implTranslateCancelErrorCode(n){let s=e.CancellationErrorCode.NoError;switch(n){case t.RecognitionStatus.Error:s=e.CancellationErrorCode.ServiceError;break;case t.RecognitionStatus.TooManyRequests:s=e.CancellationErrorCode.TooManyRequests;break;case t.RecognitionStatus.BadRequest:s=e.CancellationErrorCode.BadRequestParameters;break;case t.RecognitionStatus.Forbidden:s=e.CancellationErrorCode.Forbidden;break;default:s=e.CancellationErrorCode.NoError;break}return s}static implTranslateErrorDetails(n){let s="The speech service encountered an internal error and could not continue.";switch(n){case e.CancellationErrorCode.Forbidden:s="The recognizer is using a free subscription that ran out of quota.";break;case e.CancellationErrorCode.BadRequestParameters:s="Invalid parameter or unsupported audio format in the request.";break;case e.CancellationErrorCode.TooManyRequests:s="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return s}};return Ei.EnumTranslation=r,Ei}var oc={},zv;function zR(){return zv||(zv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionStatus=e.SynthesisStatus=void 0,(function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"})(e.SynthesisStatus||(e.SynthesisStatus={})),(function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"})(e.RecognitionStatus||(e.RecognitionStatus={}))})(oc)),oc}var Ai={},Lv;function LR(){if(Lv)return Ai;Lv=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.TranslationSynthesisEnd=void 0;const e=L();let t=class um{constructor(i){this.privSynthesisEnd=JSON.parse(i),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(i){return new um(i)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Ai.TranslationSynthesisEnd=t,Ai}var Ti={},Fv;function FR(){if(Fv)return Ti;Fv=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.TranslationHypothesis=void 0;const e=$(),t=Yu();let r=class Mc{constructor(n,s){this.privTranslationHypothesis=n,this.privTranslationHypothesis.Offset+=s,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(n,s){return new Mc(JSON.parse(n),s)}static fromTranslationResponse(n,s){e.Contracts.throwIfNullOrUndefined(n,"translationHypothesis");const a=n.SpeechHypothesis;return n.SpeechHypothesis=void 0,a.Translation=n,new Mc(a,s)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var n;return(n=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:n.Language}asJson(){const n={...this.privTranslationHypothesis};return n.Translation!==void 0?JSON.stringify({...n,TranslationStatus:t.TranslationStatus[n.Translation.TranslationStatus]}):JSON.stringify(n)}mapTranslationStatus(n){if(typeof n=="string")return t.TranslationStatus[n];if(typeof n=="number")return n}};return Ti.TranslationHypothesis=r,Ti}var bi={},qv;function qR(){if(qv)return bi;qv=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.TranslationPhrase=void 0;const e=$(),t=L(),r=Yu();let i=class Dc{constructor(s,a){this.privTranslationPhrase=s,this.privTranslationPhrase.Offset+=a,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(s,a){return new Dc(JSON.parse(s),a)}static fromTranslationResponse(s,a){e.Contracts.throwIfNullOrUndefined(s,"translationResponse");const o=s.SpeechPhrase;return s.SpeechPhrase=void 0,o.Translation=s,o.Text=o.DisplayText,new Dc(o,a)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Language}get Confidence(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const s={...this.privTranslationPhrase},a={...s,RecognitionStatus:t.RecognitionStatus[s.RecognitionStatus]};return s.Translation&&(a.Translation={...s.Translation,TranslationStatus:r.TranslationStatus[s.Translation.TranslationStatus]}),JSON.stringify(a)}mapRecognitionStatus(s){if(typeof s=="string")return t.RecognitionStatus[s];if(typeof s=="number")return s}mapTranslationStatus(s){if(typeof s=="string")return r.TranslationStatus[s];if(typeof s=="number")return s}};return bi.TranslationPhrase=i,bi}var Ii={},Bv;function BR(){if(Bv)return Ii;Bv=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.TranslationServiceRecognizer=void 0;const e=F(),t=O(),r=L();let i=class extends r.ConversationServiceRecognizer{constructor(s,a,o,c,u){super(s,a,o,c,u),this.privTranslationRecognizer=u,this.connectionEvents.attach(p=>{p.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(s){const a=new t.PropertyCollection;let o=await this.processSpeechMessages(s);if(o)return!0;const c=async p=>{if(a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson()),this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),p.RecognitionStatus===r.RecognitionStatus.Success){const d=this.fireEventForResult(p,a);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d.result)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const d=r.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus),h=new t.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,d,p.Text,p.Duration,p.Offset,p.Language,p.Confidence,void 0,p.asJson(),a);if(d===t.ResultReason.Canceled){const l=r.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),f=r.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(l,f,r.EnumTranslation.implTranslateErrorDetails(f))}else if(p.RecognitionStatus!==r.RecognitionStatus.EndOfDictation){const l=new t.TranslationRecognitionEventArgs(h,h.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(h)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}o=!0}},u=p=>{a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=this.fireEventForResult(p,a);if(this.privRequestSession.onHypothesis(d.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,d)}catch{}o=!0};switch(s.messageType===e.MessageType.Text&&a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"translation.hypothesis":u(r.TranslationHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const p=JSON.parse(s.textBody);if(p.SpeechPhrase)await c(r.TranslationPhrase.fromTranslationResponse(p,this.privRequestSession.currentTurnAudioOffset));else{const h=JSON.parse(s.textBody);h.SpeechHypothesis&&u(r.TranslationHypothesis.fromTranslationResponse(h,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await c(r.TranslationPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(s.binaryBody,this.privRequestSession.sessionId),o=!0;break;case"audio.end":case"translation.synthesis.end":const d=r.TranslationSynthesisEnd.fromJSON(s.textBody);switch(d.SynthesisStatus){case r.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const h=new t.TranslationSynthesisResult(t.ResultReason.Canceled,void 0),l=new t.TranslationSynthesisEventArgs(h,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,l)}catch{}}if(this.privTranslationRecognizer.canceled){const h=new t.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,t.CancellationReason.Error,d.FailureReason,t.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,h)}catch{}}break;case r.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}o=!0;break}return o}cancelRecognition(s,a,o,c,u){const p=new t.PropertyCollection;if(p.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privTranslationRecognizer.canceled){const d=new t.TranslationRecognitionCanceledEventArgs(s,o,u,c,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new t.TranslationRecognitionResult(void 0,a,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,u,void 0,p);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(s,a,o){try{const c=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(s),a,o);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,c)}catch{}}handleRecognizedCallback(s,a,o){try{const c=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(s),a,o);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,c)}catch{}}fireEventForResult(s,a){let o;if(s.Translation.Translations!==void 0){o=new t.Translations;for(const l of s.Translation.Translations)o.set(l.Language,l.Text||l.DisplayText)}let c,u;s instanceof r.TranslationPhrase?(s.Translation&&s.Translation.TranslationStatus===e.TranslationStatus.Success?c=t.ResultReason.TranslatedSpeech:c=t.ResultReason.RecognizedSpeech,u=s.Confidence):c=t.ResultReason.TranslatingSpeech;const p=s.Language,d=new t.TranslationRecognitionResult(o,this.privRequestSession.requestId,c,s.Text,s.Duration,s.Offset,p,u,s.Translation.FailureReason,s.asJson(),a);return new t.TranslationRecognitionEventArgs(d,s.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(s,a){const o=s===void 0?t.ResultReason.SynthesizingAudioCompleted:t.ResultReason.SynthesizingAudio,c=new t.TranslationSynthesisResult(o,s),u=new t.TranslationSynthesisEventArgs(c,a);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}};return Ii.TranslationServiceRecognizer=i,Ii}var _i={},Uv;function UR(){if(Uv)return _i;Uv=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.SpeechDetected=void 0;let e=class pm{constructor(r,i){this.privSpeechStartDetected=JSON.parse(r),this.privSpeechStartDetected.Offset+=i}static fromJSON(r,i){return new pm(r,i)}get Offset(){return this.privSpeechStartDetected.Offset}};return _i.SpeechDetected=e,_i}var Oi={},xv;function xR(){if(xv)return Oi;xv=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.SpeechHypothesis=void 0;let e=class dm{constructor(r,i){this.privSpeechHypothesis=JSON.parse(r),this.updateOffset(i)}static fromJSON(r,i){return new dm(r,i)}updateOffset(r){this.privSpeechHypothesis.Offset+=r}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return Oi.SpeechHypothesis=e,Oi}var Mi={},Hv;function HR(){if(Hv)return Mi;Hv=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.SpeechKeyword=void 0;let e=class lm{constructor(r,i){this.privSpeechKeyword=JSON.parse(r),this.privSpeechKeyword.Offset+=i}static fromJSON(r,i){return new lm(r,i)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return Mi.SpeechKeyword=e,Mi}var Di={},$v;function $R(){if($v)return Di;$v=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.SpeechServiceRecognizer=void 0;const e=O(),t=L();let r=class extends t.ServiceRecognizerBase{constructor(n,s,a,o,c){super(n,s,a,o,c),this.privSpeechRecognizer=c}async processTypeSpecificMessages(n){let s;const a=new e.PropertyCollection;let o=!1;switch(n.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const c=t.SpeechHypothesis.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,c.asJson()),s=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,void 0,void 0,c.asJson(),a),this.privRequestSession.onHypothesis(c.Offset);const u=new e.SpeechRecognitionEventArgs(s,c.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch{}o=!0;break;case"speech.phrase":const p=t.SimpleSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=t.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),e.ResultReason.Canceled===d){const h=t.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),l=t.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(h,l,t.EnumTranslation.implTranslateErrorDetails(l))}else{if(p.RecognitionStatus===t.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])s=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,p.asJson(),a);else{const l=t.DetailedSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),s=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,l.RecognitionStatus===t.RecognitionStatus.Success?l.NBest[0].Display:"",l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),a)}const h=new e.SpeechRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}o=!0;break}return o}cancelRecognition(n,s,a,o,c){const u=new e.PropertyCollection;if(u.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[o]),this.privSpeechRecognizer.canceled){const p=new e.SpeechRecognitionCanceledEventArgs(a,c,o,void 0,n);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new e.SpeechRecognitionResult(s,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,c,void 0,u);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return Di.SpeechServiceRecognizer=r,Di}var ki={},sc={},Wv;function WR(){return Wv||(Wv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.IdentityProvider=e.SpeakerDiarizationMode=void 0,(function(t){t.None="None",t.Identity="Identity",t.Anonymous="Anonymous"})(e.SpeakerDiarizationMode||(e.SpeakerDiarizationMode={})),(function(t){t.CallCenter="CallCenter"})(e.IdentityProvider||(e.IdentityProvider={}))})(sc)),sc}var Vv;function VR(){if(Vv)return ki;Vv=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.ConversationTranscriptionServiceRecognizer=void 0;const e=O(),t=L(),r=WR(),i=Be();let n=class extends t.ServiceRecognizerBase{constructor(a,o,c,u,p){super(a,o,c,u,p),this.privConversationTranscriber=p,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const a=this.privSpeechContext.getContext().phraseDetection||{};a.mode=i.RecognitionMode.Conversation;const o={};o.mode=r.SpeakerDiarizationMode.Anonymous,o.audioSessionId=this.privDiarizationSessionId,o.audioOffsetMs=0,o.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",a.speakerDiarization=o,this.privSpeechContext.getContext().phraseDetection=a}}async processTypeSpecificMessages(a){let o;const c=new e.PropertyCollection;c.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,a.textBody);let u=!1;switch(a.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const p=t.SpeechHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);o=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),c),this.privRequestSession.onHypothesis(p.Offset);const d=new e.ConversationTranscriptionEventArgs(o,p.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,d)}catch{}u=!0;break;case"speech.phrase":const h=t.SimpleSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset),l=t.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),e.ResultReason.Canceled===l){const f=t.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),m=t.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(f,m,t.EnumTranslation.implTranslateErrorDetails(m))}else if(!(this.privRequestSession.isSpeechEnded&&l===e.ResultReason.NoMatch&&h.RecognitionStatus!==t.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])o=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,l,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,h.asJson(),c);else{const m=t.DetailedSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);o=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,l,m.RecognitionStatus===t.RecognitionStatus.Success?m.NBest[0].Display:void 0,m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,h.SpeakerId,void 0,m.asJson(),c)}const f=new e.ConversationTranscriptionEventArgs(o,o.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,f)}catch{}}u=!0;break}return u}cancelRecognition(a,o,c,u,p){if(new e.PropertyCollection().setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[u]),this.privConversationTranscriber.canceled){const h=new e.ConversationTranscriptionCanceledEventArgs(c,p,u,void 0,a);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,h)}catch{}}}};return ki.ConversationTranscriptionServiceRecognizer=n,ki}var Ni={},Kv;function KR(){if(Kv)return Ni;Kv=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.TranscriptionServiceRecognizer=void 0;const e=F(),t=O(),r=L(),i=Rs();let n=class extends r.ConversationServiceRecognizer{constructor(a,o,c,u,p){super(a,o,c,u,p),this.privTranscriberRecognizer=p,this.sendPrePayloadJSONOverride=d=>this.sendTranscriptionStartJSON(d),this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(a,o){if(this.privRequestSession.isRecognizing){const c=await this.fetchConnection();await this.sendSpeechEvent(c,this.createSpeechEventPayload(a,o))}}async sendMeetingSpeechEventAsync(a,o){if(this.privRequestSession.isRecognizing){const c=await this.fetchConnection();await this.sendSpeechEvent(c,this.createMeetingSpeechEventPayload(a,o))}}processTypeSpecificMessages(a){return this.processSpeechMessages(a)}handleRecognizedCallback(a,o,c){try{const u=new t.SpeechRecognitionEventArgs(a,o,c);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,u),this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(a,o,c){try{const u=new t.SpeechRecognitionEventArgs(a,o,c);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,u)}catch{}}cancelRecognition(a,o,c,u,p){const d=new t.PropertyCollection;if(d.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[u]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const h=new t.MeetingTranscriptionCanceledEventArgs(c,p,u,void 0,a);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,h)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const h=new t.ConversationTranscriptionCanceledEventArgs(c,p,u,void 0,a);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new t.SpeechRecognitionResult(o,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,d);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(a){if(await this.sendSpeechContext(a,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const o=this.privTranscriberRecognizer.getMeetingInfo(),c=this.createMeetingSpeechEventPayload(o,"start");await this.sendSpeechEvent(a,c)}else{const o=this.privTranscriberRecognizer.getConversationInfo(),c=this.createSpeechEventPayload(o,"start");await this.sendSpeechEvent(a,c)}await this.sendWaveHeader(a)}sendSpeechEvent(a,o){const c=JSON.stringify(o);if(c)return a.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",c))}createSpeechEventPayload(a,o){const c={id:"meeting",name:o,meeting:a.conversationProperties};return c.meeting.id=a.id,c.meeting.attendees=a.participants,c}createMeetingSpeechEventPayload(a,o){const c={id:"meeting",name:o,meeting:a.meetingProperties};return c.meeting.id=a.id,c.meeting.attendees=a.participants,c}};return Ni.TranscriptionServiceRecognizer=n,Ni}var ji={},Gv;function GR(){if(Gv)return ji;Gv=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.DetailedSpeechPhrase=void 0;const e=L();let t=class hm{constructor(i,n){this.privDetailedSpeechPhrase=JSON.parse(i),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(n)}static fromJSON(i,n){return new hm(i,n)}updateOffsets(i){if(this.privDetailedSpeechPhrase.Offset+=i,this.privDetailedSpeechPhrase.NBest)for(const n of this.privDetailedSpeechPhrase.NBest){if(n.Words)for(const s of n.Words)s.Offset+=i;if(n.DisplayWords)for(const s of n.DisplayWords)s.Offset+=i}}asJson(){const i={...this.privDetailedSpeechPhrase};return JSON.stringify({...i,RecognitionStatus:e.RecognitionStatus[i.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(i){if(typeof i=="string")return e.RecognitionStatus[i];if(typeof i=="number")return i}};return ji.DetailedSpeechPhrase=t,ji}var zi={},Jv;function JR(){if(Jv)return zi;Jv=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.SimpleSpeechPhrase=void 0;const e=L();let t=class vm{constructor(i,n=0){this.privSimpleSpeechPhrase=JSON.parse(i),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(n)}static fromJSON(i,n){return new vm(i,n)}updateOffset(i){this.privSimpleSpeechPhrase.Offset+=i}asJson(){const i={...this.privSimpleSpeechPhrase};return JSON.stringify({...i,RecognitionStatus:e.RecognitionStatus[i.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(i){if(typeof i=="string")return e.RecognitionStatus[i];if(typeof i=="number")return i}};return zi.SimpleSpeechPhrase=t,zi}var Li={},Fi={},Qv;function QR(){if(Qv)return Fi;Qv=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.ServiceTelemetryListener=void 0;const e=F(),t=Xu();class r{constructor(n,s,a){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=n,this.privAudioSourceId=s,this.privAudioNodeId=a,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(n){n>0&&this.privPhraseLatencies.push(Date.now()-n)}hypothesisReceived(n){n>0&&this.privHypothesisLatencies.push(Date.now()-n)}onEvent(n){this.privIsDisposed||(n instanceof t.RecognitionTriggeredEvent&&n.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:n.eventTime,Name:"ListeningTrigger",Start:n.eventTime}),n instanceof e.AudioStreamNodeAttachingEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=n.eventTime),n instanceof e.AudioStreamNodeAttachedEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=n.eventTime),n instanceof e.AudioSourceErrorEvent&&n.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Error:n.error,Name:"Microphone",Start:this.privMicStartTime})),n instanceof e.AudioStreamNodeErrorEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Error:n.error,Name:"Microphone",Start:this.privMicStartTime})),n instanceof e.AudioStreamNodeDetachedEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Name:"Microphone",Start:this.privMicStartTime})),n instanceof t.ConnectingToServiceEvent&&n.requestId===this.privRequestId&&(this.privConnectionId=n.sessionId),n instanceof e.ConnectionStartEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionStartTime=n.eventTime),n instanceof e.ConnectionEstablishedEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:n.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),n instanceof e.ConnectionEstablishErrorEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:n.eventTime,Error:this.getConnectionError(n.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),n instanceof e.ConnectionMessageReceivedEvent&&n.connectionId===this.privConnectionId&&n.message&&n.message.headers&&n.message.headers.path&&(this.privReceivedMessages[n.message.headers.path]||(this.privReceivedMessages[n.message.headers.path]=new Array),this.privReceivedMessages[n.message.headers.path].length<50&&this.privReceivedMessages[n.message.headers.path].push(n.networkReceivedTime)))}getTelemetry(){const n=new Array;this.privListeningTriggerMetric&&n.push(this.privListeningTriggerMetric),this.privMicMetric&&n.push(this.privMicMetric),this.privConnectionEstablishMetric&&n.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&n.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&n.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const s={Metrics:n,ReceivedMessages:this.privReceivedMessages},a=JSON.stringify(s);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],a}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(n){switch(n){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+n.toString()}}}return Fi.ServiceTelemetryListener=r,Fi}var Yv;function YR(){if(Yv)return Li;Yv=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.RequestSession=void 0;const e=F(),t=Xu(),r=QR();let i=class{constructor(s){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=s,this.privRequestId=(0,e.createNoDashGuid)(),this.privAudioNodeId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(s){this.privServiceTelemetryListener&&this.privDetachables.push(s.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new r.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new t.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(s,a){this.privAudioNode=s,this.privIsAudioNodeDetached=!1,a?await this.onComplete():this.onEvent(new t.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(s,a){this.privAuthFetchEventId=s,this.privSessionId=a,this.onEvent(new t.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(s){s&&await this.onComplete()}async onConnectionEstablishCompleted(s,a){if(s===200){this.onEvent(new t.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else s===403&&await this.onComplete()}async onServiceTurnEndResponse(s){this.privTurnDeferral.resolve(),!s||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,e.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred}onHypothesis(s){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(s)))}onPhraseRecognized(s){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(s)),this.onServiceRecognized(s)}onServiceRecognized(s){this.privLastRecoOffset=s,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(s),this.privConnectionAttempts=0}onAudioSent(s){this.privBytesSent+=s,this.privRecognitionBytesSent+=s}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const s of this.privDetachables)await s.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(s){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(s),e.Events.instance.onEvent(s)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return Li.RequestSession=i,Li}var qi={},ac={},Zv;function ZR(){return Zv||(Zv=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TentativePhraseResultsOption=e.OutputFormat=e.PhraseExtension=e.PhraseOption=void 0,(function(t){t.WordTimings="WordTimings",t.SNR="SNR",t.Pronunciation="Pronunciation",t.WordPronunciation="WordPronunciation",t.WordConfidence="WordConfidence",t.Words="Words",t.Sentiment="Sentiment",t.PronunciationAssessment="PronunciationAssessment",t.ContentAssessment="ContentAssessment",t.PhraseAMScore="PhraseAMScore",t.PhraseLMScore="PhraseLMScore",t.WordAMScore="WordAMScore",t.WordLMScore="WordLMScore",t.RuleTree="RuleTree",t.NBestTimings="NBestTimings",t.DecoderDiagnostics="DecoderDiagnostics",t.DisplayWordTimings="DisplayWordTimings",t.DisplayWords="DisplayWords"})(e.PhraseOption||(e.PhraseOption={})),(function(t){t.Graph="Graph",t.Corrections="Corrections",t.Sentiment="Sentiment"})(e.PhraseExtension||(e.PhraseExtension={})),(function(t){t.Simple="Simple",t.Detailed="Detailed"})(e.OutputFormat||(e.OutputFormat={})),(function(t){t.None="None",t.Always="Always"})(e.TentativePhraseResultsOption||(e.TentativePhraseResultsOption={}))})(ac)),ac}var Xv;function XR(){if(Xv)return qi;Xv=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.SpeechContext=void 0;const e=Be(),t=ZR();let r=class{constructor(n){this.privContext={},this.privDynamicGrammar=n}getContext(){return this.privContext}setPronunciationAssessmentParams(n,s=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(n)||{},s&&(this.privContext.phraseDetection.mode=e.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.SNR)}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(n){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=n}toJSON(){const n=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=n,JSON.stringify(this.privContext)}};return qi.SpeechContext=r,qi}var Bi={},cc={},ef;function eE(){return ef||(ef=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SubstringMatchType=e.GroupType=void 0,(function(t){t.IntentText="IntentText",t.IntentEntity="IntentEntity",t.Generic="Generic",t.People="People",t.Place="Place",t.DynamicEntity="DynamicEntity"})(e.GroupType||(e.GroupType={})),(function(t){t.None="None",t.LeftRooted="LeftRooted",t.PartialName="PartialName",t.MiddleOfSentence="MiddleOfSentence"})(e.SubstringMatchType||(e.SubstringMatchType={}))})(cc)),cc}var tf;function tE(){if(tf)return Bi;tf=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.DynamicGrammarBuilder=void 0;const e=eE();let t=class{constructor(){this.privWeight=1}addPhrase(i){this.privPhrases||(this.privPhrases=[]),i instanceof Array?this.privPhrases=this.privPhrases.concat(i):this.privPhrases.push(i)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(i){this.privGrammars||(this.privGrammars=[]),i instanceof Array?this.privGrammars=this.privGrammars.concat(i):this.privGrammars.push(i)}clearGrammars(){this.privGrammars=void 0}setWeight(i){this.privWeight=i}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const i={};if(i.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const n=[];this.privPhrases.forEach(s=>{n.push({text:s})}),i.groups=[{type:e.GroupType.Generic,items:n}],i.bias=this.privWeight}return i}};return Bi.DynamicGrammarBuilder=t,Bi}var Ui={},xi={},Hi={},uc={},rf;function fm(){return rf||(rf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MessageDataStreamType=e.ActivityPayloadResponse=void 0;class t{constructor(i){this.privActivityResponse=JSON.parse(i)}static fromJSON(i){return new t(i)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}e.ActivityPayloadResponse=t,(function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"})(e.MessageDataStreamType||(e.MessageDataStreamType={}))})(uc)),uc}var nf;function rE(){if(nf)return Hi;nf=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.DialogServiceTurnState=void 0;const e=Io(),t=lr(),r=fm();let i=class{constructor(s,a){this.privRequestId=a,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=s,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(s,a){return s.messageDataStreamType===r.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=t.AudioOutputStream.createPullStream(),this.privAudioStream.format=a!==void 0?a:e.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return Hi.DialogServiceTurnState=i,Hi}var of;function nE(){if(of)return xi;of=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.DialogServiceTurnStateManager=void 0;const e=Ge(),t=rE();let r=class{constructor(){this.privTurnMap=new Map}StartTurn(n){if(this.privTurnMap.has(n))throw new e.InvalidOperationError("Service error: There is already a turn with id:"+n);const s=new t.DialogServiceTurnState(this,n);return this.privTurnMap.set(n,s),this.privTurnMap.get(n)}GetTurn(n){return this.privTurnMap.get(n)}CompleteTurn(n){if(!this.privTurnMap.has(n))throw new e.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+n);const s=this.privTurnMap.get(n);return s.complete(),this.privTurnMap.delete(n),s}};return xi.DialogServiceTurnStateManager=r,xi}var pc={},sf;function iE(){return sf||(sf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InvocationSource=void 0,(function(t){t.None="None",t.VoiceActivationWithKeyword="VoiceActivationWithKeyword"})(e.InvocationSource||(e.InvocationSource={}))})(pc)),pc}var dc={},af;function oE(){return af||(af=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnRejectAction=e.KeywordDetectionType=void 0,(function(t){t.StartTrigger="StartTrigger"})(e.KeywordDetectionType||(e.KeywordDetectionType={})),(function(t){t.EndOfTurn="EndOfTurn",t.Continue="Continue"})(e.OnRejectAction||(e.OnRejectAction={}))})(dc)),dc}var cf;function sE(){if(cf)return Ui;cf=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.DialogServiceAdapter=void 0;const e=Se(),t=Tg(),r=F(),i=Io(),n=O(),s=nE(),a=L(),o=fm(),c=iE(),u=oE(),p=Rs();let d=class extends a.ServiceRecognizerBase{constructor(l,f,m,P,g){super(l,f,m,P,g),this.privEvents=new r.EventSource,this.privDialogServiceConnector=g,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new s.DialogServiceTurnStateManager,this.recognizeOverride=(w,R,A)=>this.listenOnce(w,R,A),this.postConnectImplOverride=w=>this.dialogConnectImpl(w),this.configConnectionOverride=w=>this.configConnection(w),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=m,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(w=>{w.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(l){const f=(0,r.createGuid)(),m=(0,r.createNoDashGuid)(),P={context:{interactionId:f},messagePayload:JSON.parse(l),version:.5},g=JSON.stringify(P);await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(r.MessageType.Text,"agent",m,"application/json",g))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(l){const f=new n.PropertyCollection;l.messageType===r.MessageType.Text&&f.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,l.textBody);let m,P;switch(l.path.toLowerCase()){case"speech.phrase":const w=a.SimpleSpeechPhrase.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(w.Offset+w.Duration),w.RecognitionStatus!==a.RecognitionStatus.TooManyRequests&&w.RecognitionStatus!==a.RecognitionStatus.Error){const q=this.fireEventForResult(w,f);if(this.privLastResult=q.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,q)}catch{}}P=!0;break;case"speech.hypothesis":const R=a.SpeechHypothesis.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);m=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,R.Text,R.Duration,R.Offset,R.Language,R.LanguageDetectionConfidence,void 0,void 0,R.asJson(),f),this.privRequestSession.onHypothesis(R.Offset);const A=new n.SpeechRecognitionEventArgs(m,R.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,A)}catch{}P=!0;break;case"speech.keyword":const I=a.SpeechKeyword.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);m=new n.SpeechRecognitionResult(this.privRequestSession.requestId,I.Status==="Accepted"?n.ResultReason.RecognizedKeyword:n.ResultReason.NoMatch,I.Text,I.Duration,I.Offset,void 0,void 0,void 0,void 0,I.asJson(),f),I.Status!=="Accepted"&&(this.privLastResult=m);const D=new n.SpeechRecognitionEventArgs(m,m.duration,m.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,D)}catch{}P=!0;break;case"audio":{const q=l.requestId.toUpperCase(),M=this.privTurnStateManager.GetTurn(q);try{l.binaryBody?M.audioStream.write(l.binaryBody):M.endAudioStream()}catch{}}P=!0;break;case"response":this.handleResponseMessage(l),P=!0;break}const g=new r.Deferred;return g.resolve(P),g.promise}async cancelRecognition(l,f,m,P,g){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const w=new n.PropertyCollection;w.setProperty(a.CancellationErrorCodePropertyName,n.CancellationErrorCode[P]);const R=new n.SpeechRecognitionCanceledEventArgs(m,g,P,void 0,l);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,R)}catch{}if(this.privSuccessCallback){const A=new n.SpeechRecognitionResult(void 0,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,g,void 0,w);try{this.privSuccessCallback(A),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(l,f,m){this.privRecognizerConfig.recognitionMode=l,this.privSuccessCallback=f,this.privErrorCallback=m,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(n.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const P=this.connectImpl(),g=this.sendPreAudioMessages(),w=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),R=await this.privDialogAudioSource.format,A=await this.privDialogAudioSource.deviceInfo,I=new e.ReplayableAudioNode(w,R.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(I,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:A};try{await P,await g}catch(M){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,M),Promise.resolve()}const D=new n.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,D),this.sendAudio(I).then(()=>{},async M=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,M)})}dialogConnectImpl(l){return this.privConnectionLoop=this.startMessageLoop(),l}receiveDialogMessageOverride(){const l=new r.Deferred,f=async()=>{try{const m=this.isDisposed(),P=!this.isDisposed()&&this.terminateMessageLoop;if(m||P){l.resolve(void 0);return}const w=await(await this.fetchConnection()).read();if(!w)return f();const R=p.SpeechConnectionMessage.fromConnectionMessage(w);switch(R.path.toLowerCase()){case"turn.start":{const Q=R.requestId.toUpperCase(),Ae=this.privRequestSession.requestId.toUpperCase();Q!==Ae?this.privTurnStateManager.StartTurn(Q):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const I=a.SpeechDetected.fromJSON(R.textBody,this.privRequestSession.currentTurnAudioOffset),D=new n.RecognitionEventArgs(I.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,D);break;case"speech.enddetected":let q;R.textBody.length>0?q=R.textBody:q="{ Offset: 0 }";const M=a.SpeechDetected.fromJSON(q,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(M.Offset);const K=new n.RecognitionEventArgs(M.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,K);break;case"turn.end":{const Q=R.requestId.toUpperCase(),Ae=this.privRequestSession.requestId.toUpperCase();if(Q!==Ae)this.privTurnStateManager.CompleteTurn(Q);else{const nr=new n.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,nr),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(le){this.privErrorCallback&&this.privErrorCallback(le)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(R)||this.serviceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(R.path.toLowerCase(),R.textBody))}catch{}}return f()}catch{this.terminateMessageLoop=!0,l.resolve()}};return f().catch(m=>{r.Events.instance.onEvent(new r.BackgroundEvent(m))}),l.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(l){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,l)}return Promise.resolve()}async configConnection(l){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(l,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(l),l)}async sendPreAudioMessages(){const l=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(l,!0),await this.sendAgentContext(l),await this.sendWaveHeader(l)}sendAgentConfig(l){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(n.PropertyId.Conversation_DialogType)===n.DialogServiceConfig.DialogTypes.CustomCommands){const m=this.agentConfig.get();m.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(m)}this.onEvent(new t.SendingAgentContextMessageEvent(this.agentConfig));const f=this.agentConfig.toJsonString();return this.agentConfigSent=!0,l.send(new p.SpeechConnectionMessage(r.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",f))}}sendAgentContext(l){const f=(0,r.createGuid)(),m=this.privDialogServiceConnector.properties.getProperty(n.PropertyId.Conversation_Speech_Activity_Template),g=JSON.stringify({channelData:"",context:{interactionId:f},messagePayload:typeof m===void 0?void 0:m,version:.5});return l.send(new p.SpeechConnectionMessage(r.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",g))}fireEventForResult(l,f){const m=a.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus),P=new n.SpeechRecognitionResult(this.privRequestSession.requestId,m,l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),f);return new n.SpeechRecognitionEventArgs(P,l.Offset,this.privRequestSession.sessionId)}handleResponseMessage(l){const f=JSON.parse(l.textBody);switch(f.messageType.toLowerCase()){case"message":const m=l.requestId.toUpperCase(),P=o.ActivityPayloadResponse.fromJSON(l.textBody),g=this.privTurnStateManager.GetTurn(m);if(P.conversationId){const A=this.agentConfig.get();A.botInfo.conversationId=P.conversationId,this.agentConfig.set(A)}const w=g.processActivityPayload(P,i.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),R=new n.ActivityReceivedEventArgs(P.messagePayload,w);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,R)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new n.TurnStatusReceivedEventArgs(l.textBody))}catch{}break;default:r.Events.instance.onEvent(new r.BackgroundEvent(`Unexpected response of type ${f.messageType}. Ignoring.`));break}}onEvent(l){this.privEvents.onEvent(l),r.Events.instance.onEvent(l)}addKeywordContextData(){const l=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(l===void 0)return;const f=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),m=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),P=l.split(";"),g=f===void 0?[]:f.split(";"),w=m===void 0?[]:m.split(";"),R=[];for(let A=0;A<P.length;A++){const I={text:P[A]};A<g.length&&(I.startOffset=Number(g[A])),A<w.length&&(I.duration=Number(w[A])),R.push(I)}this.speechContext.getContext().invocationSource=c.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:R,onReject:{action:u.OnRejectAction.EndOfTurn},type:u.KeywordDetectionType.StartTrigger}]}};return Ui.DialogServiceAdapter=d,Ui}var $i={},uf;function aE(){if(uf)return $i;uf=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.AgentConfig=void 0;let e=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(r){this.iPrivConfig=r}};return $i.AgentConfig=e,$i}var lc={},Wi={},Vi={},pf;function ip(){if(pf)return Vi;pf=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.ConversationConnectionConfig=void 0;const e=cm();let t=class ft extends e.RestConfigBase{static get host(){return ft.privHost}static get apiVersion(){return ft.privApiVersion}static get clientAppId(){return ft.privClientAppId}static get defaultLanguageCode(){return ft.privDefaultLanguageCode}static get restPath(){return ft.privRestPath}static get webSocketPath(){return ft.privWebSocketPath}static get transcriptionEventKeys(){return ft.privTranscriptionEventKeys}};return Vi.ConversationConnectionConfig=t,t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],Vi}var df;function cE(){if(df)return Wi;df=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ConversationManager=void 0;const e=Se(),t=$(),r=O(),i=ip();let n=class{constructor(){this.privRequestParams=i.ConversationConnectionConfig.configParams,this.privErrors=i.ConversationConnectionConfig.restErrors,this.privHost=i.ConversationConnectionConfig.host,this.privApiVersion=i.ConversationConnectionConfig.apiVersion,this.privRestPath=i.ConversationConnectionConfig.restPath,this.privRestAdapter=new e.RestMessageAdapter({})}createOrJoin(a,o,c,u){try{t.Contracts.throwIfNullOrUndefined(a,"args");const p=a.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,i.ConversationConnectionConfig.defaultLanguageCode),d=a.getProperty(r.PropertyId.ConversationTranslator_Name,"conversation_host"),h=a.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),l=a.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),f=a.getProperty(r.PropertyId.SpeechServiceConnection_Key),m=a.getProperty(r.PropertyId.SpeechServiceConnection_Region),P=a.getProperty(r.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(p,"languageCode"),t.Contracts.throwIfNullOrWhitespace(d,"nickname"),t.Contracts.throwIfNullOrWhitespace(h,"endpointHost");const g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.languageCode]=p,g[this.privRequestParams.nickname]=d;const w={};l&&(w[this.privRequestParams.correlationId]=l),w[this.privRequestParams.clientAppId]=i.ConversationConnectionConfig.clientAppId,o!==void 0?g[this.privRequestParams.roomId]=o:(t.Contracts.throwIfNullOrUndefined(m,this.privErrors.authInvalidSubscriptionRegion),w[this.privRequestParams.subscriptionRegion]=m,f?w[this.privRequestParams.subscriptionKey]=f:P?w[this.privRequestParams.authorization]=`Bearer ${P}`:t.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionKey));const R={};R.headers=w,this.privRestAdapter.options=R;const A=`https://${h}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Post,A,g,null).then(I=>{const D=e.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,I.headers);if(!I.ok){if(u){let M=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",I.status.toString()),K;try{K=JSON.parse(I.data),M+=` [${K.error.code}: ${K.error.message}]`}catch{M+=` [${I.data}]`}D&&(M+=` ${D}`),u(M)}return}const q=JSON.parse(I.data);if(q&&(q.requestId=D),c){try{c(q)}catch(M){u&&u(M)}c=void 0}}).catch(()=>{})}catch(p){if(u)if(p instanceof Error){const d=p;u(d.name+": "+d.message)}else u(p)}}leave(a,o){return new Promise((c,u)=>{try{t.Contracts.throwIfNullOrUndefined(a,this.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","token"));const p=a.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),d=a.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),h={};h[this.privRequestParams.apiVersion]=this.privApiVersion,h[this.privRequestParams.sessionToken]=o;const l={};d&&(l[this.privRequestParams.correlationId]=d);const f={};f.headers=l,this.privRestAdapter.options=f;const m=`https://${p}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Delete,m,h,null).then(P=>{P.ok,c()}).catch(()=>{})}catch(p){if(p instanceof Error){const d=p;u(d.name+": "+d.message)}else u(p)}})}};return Wi.ConversationManager=n,Wi}var $t={},Ki={},Gi={},Ji={},lf;function gm(){if(lf)return Ji;lf=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.ConversationConnectionMessage=void 0;const e=F();let t=class extends e.ConnectionMessage{constructor(i,n,s,a){super(i,n,s,a);const o=JSON.parse(this.textBody);o.type!==void 0&&(this.privConversationMessageType=o.type)}get conversationMessageType(){return this.privConversationMessageType}};return Ji.ConversationConnectionMessage=t,Ji}var hf;function uE(){if(hf)return Gi;hf=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.ConversationWebsocketMessageFormatter=void 0;const e=F(),t=gm();let r=class{toConnectionMessage(n){const s=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const a=new t.ConversationConnectionMessage(n.messageType,n.textContent,{},n.id);s.resolve(a)}else n.messageType===e.MessageType.Binary&&s.resolve(new t.ConversationConnectionMessage(n.messageType,n.binaryContent,void 0,n.id))}catch(a){s.reject(`Error formatting the message. Error: ${a}`)}return s.promise}fromConnectionMessage(n){const s=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const a=`${n.textBody?n.textBody:""}`;s.resolve(new e.RawWebsocketMessage(e.MessageType.Text,a,n.id))}}catch(a){s.reject(`Error formatting the message. ${a}`)}return s.promise}};return Gi.ConversationWebsocketMessageFormatter=r,Gi}var vf;function pE(){if(vf)return Ki;vf=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.ConversationConnectionFactory=void 0;const e=Se(),t=F(),r=$(),i=O(),n=st(),s=ip(),a=uE();let o=class extends n.ConnectionFactoryBase{create(u,p,d){const h=u.parameters.getProperty(i.PropertyId.ConversationTranslator_Host,s.ConversationConnectionConfig.host),l=u.parameters.getProperty(i.PropertyId.ConversationTranslator_CorrelationId,(0,t.createGuid)()),f=`wss://${h}${s.ConversationConnectionConfig.webSocketPath}`,m=u.parameters.getProperty(i.PropertyId.ConversationTranslator_Token,void 0);r.Contracts.throwIfNullOrUndefined(m,"token");const P={};P[s.ConversationConnectionConfig.configParams.apiVersion]=s.ConversationConnectionConfig.apiVersion,P[s.ConversationConnectionConfig.configParams.token]=m,P[s.ConversationConnectionConfig.configParams.correlationId]=l;const g=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(f,P,{},new a.ConversationWebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),g,d))}};return Ki.ConversationConnectionFactory=o,Ki}var Qi={},Yi={},ff;function dE(){if(ff)return Yi;ff=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.ConversationRequestSession=void 0;const e=F();let t=class{constructor(i){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=i,this.privRequestId=(0,e.createNoDashGuid)(),this.privRequestCompletionDeferral=new e.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(i,n){this.privSessionId=n}onAuthCompleted(i){i&&this.onComplete()}onConnectionEstablishCompleted(i){i!==200&&i===403&&this.onComplete()}onServiceTurnEndResponse(i){i?this.privRequestId=(0,e.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const i of this.privDetachables)await i.detach()}}onComplete(){}};return Yi.ConversationRequestSession=t,Yi}var he={},gf;function mm(){if(gf)return he;gf=1,Object.defineProperty(he,"__esModule",{value:!0}),he.ConversationReceivedTranslationEventArgs=he.ParticipantsListEventArgs=he.ParticipantAttributeEventArgs=he.ParticipantEventArgs=he.LockRoomEventArgs=he.MuteAllEventArgs=void 0;const e=O();class t extends e.SessionEventArgs{constructor(c,u){super(u),this.privIsMuted=c}get isMuted(){return this.privIsMuted}}he.MuteAllEventArgs=t;class r extends e.SessionEventArgs{constructor(c,u){super(u),this.privIsLocked=c}get isMuted(){return this.privIsLocked}}he.LockRoomEventArgs=r;class i extends e.SessionEventArgs{constructor(c,u){super(u),this.privParticipant=c}get participant(){return this.privParticipant}}he.ParticipantEventArgs=i;class n extends e.SessionEventArgs{constructor(c,u,p,d){super(d),this.privKey=u,this.privValue=p,this.privParticipantId=c}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}he.ParticipantAttributeEventArgs=n;class s extends e.SessionEventArgs{constructor(c,u,p,d,h,l,f,m,P){super(P),this.privRoomId=c,this.privSessionToken=u,this.privTranslateTo=p,this.privProfanityFilter=d,this.privRoomProfanityFilter=h,this.privIsRoomLocked=l,this.privIsRoomLocked=f,this.privParticipants=m}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}he.ParticipantsListEventArgs=s;class a{constructor(c,u,p){this.privPayload=u,this.privCommand=c,this.privSessionId=p}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return he.ConversationReceivedTranslationEventArgs=a,he}var et={},mf;function Sm(){if(mf)return et;mf=1,Object.defineProperty(et,"__esModule",{value:!0}),et.ConversationTranslatorCommandTypes=et.ConversationTranslatorMessageTypes=et.InternalParticipants=void 0;class e{constructor(r=[],i){this.participants=r,this.meId=i}addOrUpdateParticipant(r){if(r===void 0)return;const i=this.getParticipantIndex(r.id);return i>-1?this.participants.splice(i,1,r):this.participants.push(r),this.getParticipant(r.id)}getParticipantIndex(r){return this.participants.findIndex(i=>i.id===r)}getParticipant(r){return this.participants.find(i=>i.id===r)}deleteParticipant(r){this.participants=this.participants.filter(i=>i.id!==r)}get host(){return this.participants.find(r=>r.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return et.InternalParticipants=e,et.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},et.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},et}var hc={},Zi={},Sf;function lE(){if(Sf)return Zi;Sf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.CommandResponsePayload=void 0;const e=r=>JSON.parse(r);let t=class Cm{constructor(i){this.privCommandResponse=e(i)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(i){return new Cm(i)}};return Zi.CommandResponsePayload=t,Zi}var Wt={},Cf;function hE(){if(Cf)return Wt;Cf=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ParticipantPayloadResponse=Wt.ParticipantsListPayloadResponse=void 0;const e=n=>JSON.parse(n),t=n=>JSON.parse(n);class r{constructor(s){this.privParticipantsPayloadResponse=e(s)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(s){return new r(s)}}Wt.ParticipantsListPayloadResponse=r;class i{constructor(s){this.privParticipantPayloadResponse=t(s)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(s){return new i(s)}}return Wt.ParticipantPayloadResponse=i,Wt}var Vt={},yf;function vE(){if(yf)return Vt;yf=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.TextResponsePayload=Vt.SpeechResponsePayload=void 0;const e=n=>JSON.parse(n),t=n=>JSON.parse(n);class r{constructor(s){this.privSpeechResponse=e(s)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(s){return new r(s)}}Vt.SpeechResponsePayload=r;class i{constructor(s){this.privTextResponse=t(s)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(s){return new i(s)}}return Vt.TextResponsePayload=i,Vt}var Pf;function fE(){return Pf||(Pf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextResponsePayload=e.SpeechResponsePayload=e.ParticipantPayloadResponse=e.ParticipantsListPayloadResponse=e.CommandResponsePayload=void 0;var t=lE();Object.defineProperty(e,"CommandResponsePayload",{enumerable:!0,get:function(){return t.CommandResponsePayload}});var r=hE();Object.defineProperty(e,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantsListPayloadResponse}}),Object.defineProperty(e,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantPayloadResponse}});var i=vE();Object.defineProperty(e,"SpeechResponsePayload",{enumerable:!0,get:function(){return i.SpeechResponsePayload}}),Object.defineProperty(e,"TextResponsePayload",{enumerable:!0,get:function(){return i.TextResponsePayload}})})(hc)),hc}var wf;function gE(){if(wf)return Qi;wf=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.ConversationServiceAdapter=void 0;const e=F(),t=O(),r=L(),i=gm(),n=dE(),s=mm(),a=Sm(),o=fE();let c=class extends r.ServiceRecognizerBase{constructor(p,d,h,l,f){super(p,d,h,l,f),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=f,this.privConversationAuthentication=p,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=m=>this.conversationConnectImpl(m),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new n.ConversationRequestSession((0,e.createNoDashGuid)()),this.privConversationConnectionFactory=d,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(p){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(p),await super.dispose(p)}async sendMessage(p){return(await this.fetchConnection()).send(new i.ConversationConnectionMessage(e.MessageType.Text,p))}async sendMessageAsync(p){await(await this.fetchConnection()).send(new i.ConversationConnectionMessage(e.MessageType.Text,p))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(p,d,h,l,f){this.terminateMessageLoop=!0;const m=new t.ConversationTranslationCanceledEventArgs(h,f,l,void 0,p);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,m)}catch{}}async conversationConnectImpl(p){return this.privConnectionLoop=this.startMessageLoop(),p}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const p=new e.Deferred;try{const h=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return p.resolve(),Promise.resolve();if(!h)return this.receiveConversationMessageOverride();const l=this.privConversationRequestSession.sessionId,f=h.conversationMessageType.toLowerCase();let m=!1;try{switch(f){case"info":case"participant_command":case"command":const P=o.CommandResponsePayload.fromJSON(h.textBody);switch(P.command.toLowerCase()){case"participantlist":const D=o.ParticipantsListPayloadResponse.fromJSON(h.textBody),q=D.participants.map(le=>({avatar:le.avatar,displayName:le.nickname,id:le.participantId,isHost:le.ishost,isMuted:le.ismuted,isUsingTts:le.usetts,preferredLanguage:le.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new s.ParticipantsListEventArgs(D.roomid,D.token,D.translateTo,D.profanityFilter,D.roomProfanityFilter,D.roomLocked,D.muteAll,q,l));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(P.participantId,a.ConversationTranslatorCommandTypes.setTranslateToLanguages,P.value,l));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(P.participantId,a.ConversationTranslatorCommandTypes.setProfanityFiltering,P.value,l));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(P.participantId,a.ConversationTranslatorCommandTypes.setMute,P.value,l));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new s.MuteAllEventArgs(P.value,l));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new t.ConversationExpirationEventArgs(P.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(P.participantId,a.ConversationTranslatorCommandTypes.setUseTTS,P.value,l));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new s.LockRoomEventArgs(P.value,l));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(P.participantId,a.ConversationTranslatorCommandTypes.changeNickname,P.value,l));break;case"joinsession":const M=o.ParticipantPayloadResponse.fromJSON(h.textBody),K={avatar:M.avatar,displayName:M.nickname,id:M.participantId,isHost:M.ishost,isMuted:M.ismuted,isUsingTts:M.usetts,preferredLanguage:M.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(K,l));break;case"leavesession":const Q={id:P.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(Q,l));break;case"disconnectsession":const Ae={id:P.participantId};break;case"token":const nr=new r.CognitiveTokenAuthentication(()=>{const le=P.token;return Promise.resolve(le)},()=>{const le=P.token;return Promise.resolve(le)});this.authentication=nr,this.privConversationServiceConnector.onToken(nr);break;default:break}break;case"partial":case"final":const g=o.SpeechResponsePayload.fromJSON(h.textBody),w=f==="final"?t.ResultReason.TranslatedParticipantSpeech:t.ResultReason.TranslatingParticipantSpeech,R=new t.ConversationTranslationResult(g.participantId,this.getTranslations(g.translations),g.language,g.id,w,g.recognition,void 0,void 0,h.textBody,void 0);g.isFinal?((R.text!==void 0&&R.text.length>0||g.id===this.privLastPartialUtteranceId)&&(m=!0),m&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.final,R,l))):R.text!==void 0&&(this.privLastPartialUtteranceId=g.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.partial,R,l)));break;case"translated_message":const A=o.TextResponsePayload.fromJSON(h.textBody),I=new t.ConversationTranslationResult(A.participantId,this.getTranslations(A.translations),A.language,void 0,void 0,A.originalText,void 0,void 0,void 0,h.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.instantMessage,I,l));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return p.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const p=this.receiveConversationMessageOverride();try{return await p}catch(d){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,d),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(p=>p.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(p=>p),this.privConnectionConfigPromise)}getTranslations(p){let d;if(p!==void 0){d=new t.Translations;for(const h of p)d.set(h.lang,h.translation)}return d}};return Qi.ConversationServiceAdapter=c,Qi}var Rf;function mE(){if(Rf)return $t;Rf=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.ConversationTranslatorRecognizer=$t.ConversationRecognizerFactory=void 0;const e=L(),t=F(),r=$(),i=O(),n=pE(),s=gE();class a{static fromConfig(u,p,d){return new o(u,p,d)}}$t.ConversationRecognizerFactory=a;let o=class extends i.Recognizer{constructor(u,p,d){const h=p;r.Contracts.throwIfNull(h,"speechConfig");const l=u;r.Contracts.throwIfNull(l,"conversationImpl"),super(d,h.properties,new n.ConversationConnectionFactory),this.privConversation=l,this.privIsDisposed=!1,this.privProperties=h.properties.clone(),this.privConnection=i.Connection.fromRecognizer(this),this.privProperties.getProperty(i.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=t.Timeout.setTimeout,this.privClearTimeout=t.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(u){this.privConnection.connected=u}set disconnected(u){this.privConnection.disconnected=u}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(u,p,d){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfNullOrWhitespace(u,"token"),this.privReco.conversationTranslatorToken=u,this.resetConversationTimeout(),this.privReco.connectAsync(p,d)}catch(h){if(d)if(h instanceof Error){const l=h;d(l.name+": "+l.message)}else d(h)}}disconnect(u,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{u&&u()},d=>{p&&p(d)})}catch(d){if(p)if(d instanceof Error){const h=d;p(h.name+": "+h.message)}else p(d);this.dispose(!0).catch(h=>{t.Events.instance.onEvent(new t.BackgroundEvent(h))})}}sendRequest(u,p,d){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(u,p,d)}catch(h){if(d)if(h instanceof Error){const l=h;d(l.name+": "+l.message)}else d(h);this.dispose(!0).catch(l=>{t.Events.instance.onEvent(new t.BackgroundEvent(l))})}}onToken(u){this.privConversation.onToken(u)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(u){this.privIsDisposed||u&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(u))}createRecognizerConfig(u){return new e.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,p,d,h){const l=d;return new s.ConversationServiceAdapter(u,p,l,h,this)}sendMessage(u,p,d){const h=this.privReco;((f,m,P)=>{f!==void 0?f.then(()=>{try{m&&m()}catch(g){P&&P(`'Unhandled error on promise callback: ${g}'`)}},g=>{try{P&&P(g)}catch{}}):P&&P("Null promise")})(h.sendMessageAsync(u),p,d),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return $t.ConversationTranslatorRecognizer=o,$t}var Xi={},Ef;function SE(){if(Ef)return Xi;Ef=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.TranscriberRecognizer=void 0;const e=F(),t=$(),r=O(),i=L(),n=Be();let s=class extends r.Recognizer{constructor(o,c){const u=o;t.Contracts.throwIfNull(u,"speechTranslationConfig");const p=c;t.Contracts.throwIfNull(p,"audioConfigImpl"),t.Contracts.throwIfNullOrWhitespace(u.speechRecognitionLanguage,r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new i.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){t.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,o)}set conversation(o){t.Contracts.throwIfNullOrUndefined(o,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=o}getConversationInfo(){return t.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(o){t.Contracts.throwIfNullOrUndefined(o,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=o}getMeetingInfo(){return t.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(o,c){(0,e.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(n.RecognitionMode.Conversation),o,c)}stopContinuousRecognitionAsync(o,c){(0,e.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),o,c)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(o,c){const u=this.privReco;t.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendSpeechEventAsync(o,c)}async pushMeetingEvent(o,c){const u=this.privReco;t.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendMeetingSpeechEventAsync(o,c)}async enforceAudioGating(){const u=(await this.audioConfig.format).channels;if(u===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(u!==8)throw new Error(`Unsupported audio configuration: Detected ${u}-channel audio`)}connectMeetingCallbacks(o){this.isMeetingRecognizer=!0,this.canceled=(c,u)=>{o.canceled&&o.canceled(o,u)},this.recognizing=(c,u)=>{o.transcribing&&o.transcribing(o,u)},this.recognized=(c,u)=>{o.transcribed&&o.transcribed(o,u)},this.sessionStarted=(c,u)=>{o.sessionStarted&&o.sessionStarted(o,u)},this.sessionStopped=(c,u)=>{o.sessionStopped&&o.sessionStopped(o,u)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(o){this.privDisposedRecognizer||(o&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(o))}createRecognizerConfig(o){return new i.RecognizerConfig(o,this.properties)}createServiceRecognizer(o,c,u,p){const d=u;return new i.TranscriptionServiceRecognizer(o,c,d,p,this)}};return Xi.TranscriberRecognizer=s,Xi}var Af;function CE(){return Af||(Af=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InternalParticipants=e.ConversationTranslatorMessageTypes=e.ConversationTranslatorCommandTypes=e.ParticipantsListEventArgs=e.ParticipantEventArgs=e.ParticipantAttributeEventArgs=e.MuteAllEventArgs=e.LockRoomEventArgs=e.ConversationReceivedTranslationEventArgs=e.TranscriberRecognizer=e.ConversationRecognizerFactory=e.ConversationConnectionConfig=e.ConversationManager=void 0;var t=cE();Object.defineProperty(e,"ConversationManager",{enumerable:!0,get:function(){return t.ConversationManager}});var r=ip();Object.defineProperty(e,"ConversationConnectionConfig",{enumerable:!0,get:function(){return r.ConversationConnectionConfig}});var i=mE();Object.defineProperty(e,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return i.ConversationRecognizerFactory}});var n=SE();Object.defineProperty(e,"TranscriberRecognizer",{enumerable:!0,get:function(){return n.TranscriberRecognizer}});var s=mm();Object.defineProperty(e,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(e,"LockRoomEventArgs",{enumerable:!0,get:function(){return s.LockRoomEventArgs}}),Object.defineProperty(e,"MuteAllEventArgs",{enumerable:!0,get:function(){return s.MuteAllEventArgs}}),Object.defineProperty(e,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return s.ParticipantAttributeEventArgs}}),Object.defineProperty(e,"ParticipantEventArgs",{enumerable:!0,get:function(){return s.ParticipantEventArgs}}),Object.defineProperty(e,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return s.ParticipantsListEventArgs}});var a=Sm();Object.defineProperty(e,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return a.ConversationTranslatorCommandTypes}}),Object.defineProperty(e,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return a.ConversationTranslatorMessageTypes}}),Object.defineProperty(e,"InternalParticipants",{enumerable:!0,get:function(){return a.InternalParticipants}})})(lc)),lc}var vc={},Tf;function ym(){return Tf||(Tf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAudioMetadata=e.MetadataType=void 0,(function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme",r.SentenceBoundary="SentenceBoundary",r.SessionEnd="SessionEnd",r.AvatarSignal="TalkingAvatarSignal"})(e.MetadataType||(e.MetadataType={}));class t{constructor(i){this.privSynthesisAudioMetadata=JSON.parse(i)}static fromJSON(i){return new t(i)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}e.SynthesisAudioMetadata=t})(vc)),vc}var eo={},Ne={},bf;function yE(){if(bf)return Ne;bf=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.SynthesisStartedEvent=Ne.ConnectingToSynthesisServiceEvent=Ne.SynthesisTriggeredEvent=Ne.SpeechSynthesisEvent=void 0;const e=F();class t extends e.PlatformEvent{constructor(a,o,c=e.EventType.Info){super(a,c),this.privRequestId=o}get requestId(){return this.privRequestId}}Ne.SpeechSynthesisEvent=t;class r extends t{constructor(a,o,c){super("SynthesisTriggeredEvent",a),this.privSessionAudioDestinationId=o,this.privTurnAudioDestinationId=c}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}Ne.SynthesisTriggeredEvent=r;class i extends t{constructor(a,o){super("ConnectingToSynthesisServiceEvent",a),this.privAuthFetchEventId=o}get authFetchEventId(){return this.privAuthFetchEventId}}Ne.ConnectingToSynthesisServiceEvent=i;class n extends t{constructor(a,o){super("SynthesisStartedEvent",a),this.privAuthFetchEventId=o}get authFetchEventId(){return this.privAuthFetchEventId}}return Ne.SynthesisStartedEvent=n,Ne}var If;function PE(){if(If)return eo;If=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.SynthesisTurn=void 0;const e=F(),t=lr(),r=O(),i=ym(),n=yE();let s=class kc{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(o){this.privStreamId=o}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(o){this.privAudioOutputFormat=o}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const o=new r.PropertyCollection;return o.setProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),o}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const o=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(o),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(o,c,u,p){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=o,this.privRawText=c,this.privIsSSML=u,this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",p!==void 0&&(this.privTurnAudioDestination=p,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new n.SynthesisTriggeredEvent(this.requestId,void 0,p===void 0?void 0:p.id()))}onPreConnectionStart(o){this.privAuthFetchEventId=o,this.onEvent(new n.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(o){o&&this.onComplete()}onConnectionEstablishCompleted(o){if(o===200){this.onEvent(new n.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else o===403&&this.onComplete()}onServiceResponseMessage(o){const c=JSON.parse(o);this.streamId=c.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(o){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred;const c=JSON.parse(o);c.webrtc&&(this.privWebRTCSDP=c.webrtc.connectionString)}onAudioChunkReceived(o){this.isSynthesizing&&(this.privAudioOutputStream.write(o),this.privBytesReceived+=o.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(o))}onTextBoundaryEvent(o){this.updateTextOffset(o.Data.text.Text,o.Type)}onVisemeMetadataReceived(o){o.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=o.Data.AnimationChunk)}onSessionEnd(o){this.privAudioDuration=o.Data.Offset}async constructSynthesisResult(){const o=await this.getAllReceivedAudioWithHeader();return new r.SpeechSynthesisResult(this.requestId,r.ResultReason.SynthesizingAudioCompleted,o,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const o=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",o}onEvent(o){e.Events.instance.onEvent(o)}static isXmlTag(o){return o.length>=2&&o[0]==="<"&&o[o.length-1]===">"}updateTextOffset(o,c){c===i.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(o,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+o.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!kc.isXmlTag(o)&&this.updateTextOffset(o,c))):(this.privSentenceOffset=this.privRawText.indexOf(o,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+o.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!kc.isXmlTag(o)&&this.updateTextOffset(o,c)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(o){return this.privRawText.indexOf("<",o+1)>this.privRawText.indexOf(">",o+1)}};return eo.SynthesisTurn=s,eo}var to={},_f;function wE(){if(_f)return to;_f=1,Object.defineProperty(to,"__esModule",{value:!0}),to.SynthesisAdapterBase=void 0;const e=F(),t=O(),r=L(),i=Rs();let n=class{constructor(a,o,c,u){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!a)throw new e.ArgumentNullError("authentication");if(!o)throw new e.ArgumentNullError("connectionFactory");if(!c)throw new e.ArgumentNullError("synthesizerConfig");this.privAuthentication=a,this.privConnectionFactory=o,this.privSynthesizerConfig=c,this.privIsDisposed=!1,this.privSessionAudioDestination=u,this.privSynthesisTurn=new r.SynthesisTurn,this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privSynthesisContext=new r.SynthesisContext,this.privAgentConfig=new r.AgentConfig,this.connectionEvents.attach(p=>{if(p.name==="ConnectionClosedEvent"){const d=p;d.statusCode!==1e3&&this.cancelSynthesisLocal(t.CancellationReason.Error,d.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${d.reason} websocket error code: ${d.statusCode}`)}})}get synthesizerConfig(){return this.privSynthesizerConfig}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(a){this.privActivityTemplate=a}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(a){this.privAudioOutputFormat=a,this.privSynthesisTurn.audioOutputFormat=a,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=a),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=a)}isDisposed(){return this.privIsDisposed}async dispose(a){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(a)}async connect(){await this.connectImpl()}async sendNetworkMessage(a,o){const c=typeof o=="string"?e.MessageType.Text:e.MessageType.Binary,u=typeof o=="string"?"application/json":"";return(await this.fetchConnection()).send(new i.SpeechConnectionMessage(c,a,this.privSynthesisTurn.requestId,u,o))}async Speak(a,o,c,u,p,d){let h;if(o?h=a:h=this.privSynthesizer.buildSsml(a),this.speakOverride!==void 0)return this.speakOverride(h,c,u,p);this.privSuccessCallback=u,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(c,a,o,d);try{await this.connectImpl();const l=await this.fetchConnection();await this.sendSynthesisContext(l),await this.sendSsmlMessage(l,h,c),this.onSynthesisStarted(c),this.receiveMessage()}catch(l){return this.cancelSynthesisLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,l),Promise.reject(l)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(a,o,c,u){const p=new t.PropertyCollection;p.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]);const d=new t.SpeechSynthesisResult(a,t.ResultReason.Canceled,void 0,u,p);if(this.onSynthesisCancelled(d),this.privSuccessCallback)try{this.privSuccessCallback(d)}catch{}}cancelSynthesisLocal(a,o,c){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,a,o,c))}processTypeSpecificMessages(a){return!0}async receiveMessage(){try{const o=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!o)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const c=i.SpeechConnectionMessage.fromConnectionMessage(o);if(c.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(c.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(c.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(c.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===c.streamId.toLowerCase()&&c.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(c.binaryBody),this.onSynthesizing(c.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(c.binaryBody));break;case"audio.metadata":const u=r.SynthesisAudioMetadata.fromJSON(c.textBody).Metadata;for(const d of u)switch(d.Type){case r.MetadataType.WordBoundary:case r.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(d);const h=new t.SpeechSynthesisWordBoundaryEventArgs(d.Data.Offset,d.Data.Duration,d.Data.text.Text,d.Data.text.Length,d.Type===r.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,d.Data.text.BoundaryType);this.onWordBoundary(h);break;case r.MetadataType.Bookmark:const l=new t.SpeechSynthesisBookmarkEventArgs(d.Data.Offset,d.Data.Bookmark);this.onBookmarkReached(l);break;case r.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(d),d.Data.IsLastAnimation){const f=new t.SpeechSynthesisVisemeEventArgs(d.Data.Offset,d.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(f)}break;case r.MetadataType.AvatarSignal:this.onAvatarEvent(d);break;case r.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(d);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let p;try{p=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(p)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.onSynthesisCompleted(p);break;default:this.processTypeSpecificMessages(c)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(c.path.toLowerCase(),c.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(a){this.setSynthesisContextSynthesisSection();const o=this.synthesisContext.toJSON();if(o)return a.send(new i.SpeechConnectionMessage(e.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",o))}setSpeechConfigSynthesisSection(){}connectImpl(a=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(c=>c.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,e.createNoDashGuid)(),this.privConnectionId=(0,e.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const o=a?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=o.then(async c=>{this.privSynthesisTurn.onAuthCompleted(!1);const u=await this.privConnectionFactory.create(this.privSynthesizerConfig,c,this.privConnectionId);u.events.attach(d=>{this.connectionEvents.onEvent(d)});const p=await u.open();return p.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.resolve(u)):p.statusCode===403&&!a?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${p.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Url)} Reason: ${p.reason}`))},c=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(c)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(a,o){if(o)return a.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",o))}sendSsmlMessage(a,o,c){return a.send(new i.SpeechConnectionMessage(e.MessageType.Text,"ssml",c,"application/ssml+xml",o))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(a=>a.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const a=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(a):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(a,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),a)}onAvatarEvent(a){}onSynthesisStarted(a){}onSynthesizing(a){}onSynthesisCancelled(a){}onSynthesisCompleted(a){}onWordBoundary(a){}onVisemeReceived(a){}onBookmarkReached(a){}};return to.SynthesisAdapterBase=n,n.telemetryDataEnabled=!0,to}var ro={},Of;function RE(){if(Of)return ro;Of=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.AvatarSynthesisAdapter=void 0;const e=O(),t=L();let r=class extends t.SynthesisAdapterBase{constructor(n,s,a,o,c){super(n,s,a,void 0),this.privAvatarSynthesizer=o,this.privSynthesizer=o,this.privAvatarConfig=c}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var n,s,a,o,c,u,p,d,h,l,f,m,P,g,w,R,A;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(n=this.privAvatarConfig.videoFormat)==null?void 0:n.bitrate,codec:(s=this.privAvatarConfig.videoFormat)==null?void 0:s.codec,crop:{bottomRight:{x:(c=(o=(a=this.privAvatarConfig.videoFormat)==null?void 0:a.cropRange)==null?void 0:o.bottomRight)==null?void 0:c.x,y:(d=(p=(u=this.privAvatarConfig.videoFormat)==null?void 0:u.cropRange)==null?void 0:p.bottomRight)==null?void 0:d.y},topLeft:{x:(f=(l=(h=this.privAvatarConfig.videoFormat)==null?void 0:h.cropRange)==null?void 0:l.topLeft)==null?void 0:f.x,y:(g=(P=(m=this.privAvatarConfig.videoFormat)==null?void 0:m.cropRange)==null?void 0:P.topLeft)==null?void 0:g.y}},resolution:{height:(w=this.privAvatarConfig.videoFormat)==null?void 0:w.height,width:(R=this.privAvatarConfig.videoFormat)==null?void 0:R.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(A=this.privAvatarConfig.backgroundImage)==null?void 0:A.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,photoAvatarBaseModel:this.privAvatarConfig.photoAvatarBaseModel,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(n){if(this.privAvatarSynthesizer.avatarEventReceived){const s=new e.AvatarEventArgs(n.Data.Offset,n.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,s)}catch{}}}};return ro.AvatarSynthesisAdapter=r,ro}var no={},Mf;function EE(){if(Mf)return no;Mf=1,Object.defineProperty(no,"__esModule",{value:!0}),no.SpeechSynthesisAdapter=void 0;const e=O(),t=L();let r=class extends t.SynthesisAdapterBase{constructor(n,s,a,o,c){super(n,s,a,c),this.privSpeechSynthesizer=o,this.privSynthesizer=o}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(n){const s=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(n,e.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,s)}onSynthesizing(n){if(this.privSpeechSynthesizer.synthesizing)try{const s=this.privSynthesisTurn.audioOutputFormat.addHeader(n),a=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(this.privSynthesisTurn.requestId,e.ResultReason.SynthesizingAudio,s));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,a)}catch{}}onSynthesisCancelled(n){if(this.privSpeechSynthesizer.SynthesisCanceled){const s=new e.SpeechSynthesisEventArgs(n);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,s)}catch{}}}onSynthesisCompleted(n){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new e.SpeechSynthesisEventArgs(n))}catch{}}onWordBoundary(n){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,n)}catch{}}onVisemeReceived(n){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,n)}catch{}}onBookmarkReached(n){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,n)}catch{}}};return no.SpeechSynthesisAdapter=r,no}var io={},Df;function AE(){if(Df)return io;Df=1,Object.defineProperty(io,"__esModule",{value:!0}),io.SynthesisRestAdapter=void 0;const e=Se(),t=O(),r=st(),i=Ee();let n=class{constructor(a,o){let c=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!c){const p=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"westus"),d=r.ConnectionFactoryBase.getHostSuffix(p);c=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`https://${p}.tts.speech${d}`)}this.privUri=`${c}/cognitiveservices/voices/list`;const u=e.RestConfigBase.requestOptions;this.privRestAdapter=new e.RestMessageAdapter(u),this.privAuthentication=o}getVoicesList(a){return this.privRestAdapter.setHeaders(i.HeaderNames.ConnectionId,a),this.privAuthentication.fetch(a).then(o=>(this.privRestAdapter.setHeaders(o.headerName,o.token),this.privRestAdapter.request(e.RestRequestType.Get,this.privUri)))}};return io.SynthesisRestAdapter=n,io}var fc={},kf;function TE(){return kf||(kf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesizerConfig=e.SynthesisServiceType=void 0;const t=L();var r;(function(n){n[n.Standard=0]="Standard",n[n.Custom=1]="Custom"})(r=e.SynthesisServiceType||(e.SynthesisServiceType={}));class i{constructor(s,a){this.privSynthesisServiceType=r.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=s||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=a}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(s){this.privSynthesisServiceType=s}set synthesisVideoSection(s){this.privSpeechServiceConfig.Context.synthesis={video:s}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}setContextFromJson(s){const a=JSON.parse(s);a.system&&(this.privSpeechServiceConfig.Context.system=a.system),a.os&&(this.privSpeechServiceConfig.Context.os=a.os),a.audio&&(this.privSpeechServiceConfig.Context.audio=a.audio),a.synthesis&&(this.privSpeechServiceConfig.Context.synthesis=a.synthesis)}}e.SynthesizerConfig=i})(fc)),fc}var oo={},Nf;function bE(){if(Nf)return oo;Nf=1,Object.defineProperty(oo,"__esModule",{value:!0}),oo.SynthesisContext=void 0;const e=O();let t=class{constructor(){this.privContext={}}setSection(i,n){this.privContext[i]=n}set audioOutputFormat(i){this.privAudioOutputFormat=i}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(i){const n=this.buildSynthesisContext(i);this.setSection("synthesis",n)}buildSynthesisContext(i){return{audio:{metadataOptions:{bookmarkEnabled:!!(i!=null&&i.bookmarkReached),punctuationBoundaryEnabled:i==null?void 0:i.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(i!=null&&i.wordBoundary)),sentenceBoundaryEnabled:i==null?void 0:i.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(i!=null&&i.visemeReceived),wordBoundaryEnabled:i==null?void 0:i.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(i!=null&&i.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:i==null?void 0:i.autoDetectSourceLanguage}}}};return oo.SynthesisContext=t,oo}var gc={},jf;function IE(){return jf||(jf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.connectivity=e.Device=e.OS=e.System=e.Context=e.SpeechServiceConfig=void 0;class t{constructor(o){this.context=o}serialize(){return JSON.stringify(this,(o,c)=>{if(c&&typeof c=="object"&&!Array.isArray(c)){const u={};for(const p in c)Object.hasOwnProperty.call(c,p)&&(u[p&&p.charAt(0).toLowerCase()+p.substring(1)]=c[p]);return u}return c})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(o){this.recognition=o.toLowerCase()}}e.SpeechServiceConfig=t;class r{constructor(o){this.system=new i,this.os=o}}e.Context=r;class i{constructor(){const o="1.47.0";this.name="SpeechSDK",this.version=o,this.build="JavaScript",this.lang="JavaScript"}}e.System=i;class n{constructor(o,c,u){this.platform=o,this.name=c,this.version=u}}e.OS=n;class s{constructor(o,c,u){this.manufacturer=o,this.model=c,this.version=u}}e.Device=s,(function(a){a.Bluetooth="Bluetooth",a.Wired="Wired",a.WiFi="WiFi",a.Cellular="Cellular",a.InBuilt="InBuilt",a.Unknown="Unknown"})(e.connectivity||(e.connectivity={})),(function(a){a.Phone="Phone",a.Speaker="Speaker",a.Car="Car",a.Headset="Headset",a.Thermostat="Thermostat",a.Microphones="Microphones",a.Deskphone="Deskphone",a.RemoteControl="RemoteControl",a.Unknown="Unknown",a.File="File",a.Stream="Stream"})(e.type||(e.type={}))})(gc)),gc}var zf;function L(){return zf||(zf=1,(function(e){var t=Ot&&Ot.__createBinding||(Object.create?(function(s,a,o,c){c===void 0&&(c=o),Object.defineProperty(s,c,{enumerable:!0,get:function(){return a[o]}})}):(function(s,a,o,c){c===void 0&&(c=o),s[c]=a[o]})),r=Ot&&Ot.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&t(a,s,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguagesOpenRangeOptionName=e.ForceDictationPropertyName=e.ServicePropertiesPropertyName=e.CancellationErrorCodePropertyName=e.OutputFormatPropertyName=e.SpeechSynthesisAdapter=e.AvatarSynthesisAdapter=void 0,r(IP(),e),r(_P(),e),r(Zu(),e),r(OP(),e),r(MP(),e),r(Xu(),e),r(TR(),e),r(bR(),e),r(IR(),e),r(_R(),e),r(OR(),e),r(MR(),e),r(DR(),e),r(kR(),e),r(NR(),e),r(sm(),e),r(jR(),e),r(zR(),e),r(LR(),e),r(FR(),e),r(qR(),e),r(BR(),e),r(UR(),e),r(xR(),e),r(HR(),e),r($R(),e),r(VR(),e),r(KR(),e),r(GR(),e),r(JR(),e),r(YR(),e),r(XR(),e),r(tE(),e),r(sE(),e),r(aE(),e),r(CE(),e),r(ym(),e),r(PE(),e),r(wE(),e);var i=RE();Object.defineProperty(e,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return i.AvatarSynthesisAdapter}});var n=EE();Object.defineProperty(e,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return n.SpeechSynthesisAdapter}}),r(AE(),e),r(TE(),e),r(bE(),e),r(IE(),e),e.OutputFormatPropertyName="OutputFormat",e.CancellationErrorCodePropertyName="CancellationErrorCode",e.ServicePropertiesPropertyName="ServiceProperties",e.ForceDictationPropertyName="ForceDictation",e.AutoDetectSourceLanguagesOpenRangeOptionName="UND"})(Ot)),Ot}var Lf;function cj(){return Lf||(Lf=1,(function(e){var t=_t&&_t.__createBinding||(Object.create?(function(n,s,a,o){o===void 0&&(o=a),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[a]}})}):(function(n,s,a,o){o===void 0&&(o=a),n[o]=s[a]})),r=_t&&_t.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0});const i=L();new i.AgentConfig,r(O(),e)})(_t)),_t}var Nc,jc,zc;(function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"})(Nc||(Nc={})),(function(e){e.view="view",e.edit="edit",e.editNew="editNew"})(jc||(jc={})),(function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"})(zc||(zc={}));function wt(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function j(e,t,r,i){return new(r||(r=Promise))((function(n,s){function a(u){try{c(i.next(u))}catch(p){s(p)}}function o(u){try{c(i.throw(u))}catch(p){s(p)}}function c(u){var p;u.done?n(u.value):(p=u.value,p instanceof r?p:new r((function(d){d(p)}))).then(a,o)}c((i=i.apply(e,[])).next())}))}const Pm={childProxyingCommunication:!1};function _E(){Pm.childProxyingCommunication=!0}function wm(){return Pm.childProxyingCommunication}let op={disableEnforceOriginMatchForChildResponses:!1};function sp(){return op}function Rm(e){op=e}function OE(e){return Rm(Object.assign(Object.assign({},op),e)),sp()}var Ff=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},He=[],Te=[],ME=typeof Uint8Array<"u"?Uint8Array:Array,ap=!1;function Em(){ap=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)He[t]=e[t],Te[e.charCodeAt(t)]=t;Te[45]=62,Te[95]=63}function DE(e,t,r){for(var i,n,s=[],a=t;a<r;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],s.push(He[(n=i)>>18&63]+He[n>>12&63]+He[n>>6&63]+He[63&n]);return s.join("")}function qf(e){var t;ap||Em();for(var r=e.length,i=r%3,n="",s=[],a=16383,o=0,c=r-i;o<c;o+=a)s.push(DE(e,o,o+a>c?c:o+a));return i===1?(t=e[r-1],n+=He[t>>2],n+=He[t<<4&63],n+="=="):i===2&&(t=(e[r-2]<<8)+e[r-1],n+=He[t>>10],n+=He[t>>4&63],n+=He[t<<2&63],n+="="),s.push(n),s.join("")}function xo(e,t,r,i,n){var s,a,o=8*n-i-1,c=(1<<o)-1,u=c>>1,p=-7,d=r?n-1:0,h=r?-1:1,l=e[t+d];for(d+=h,s=l&(1<<-p)-1,l>>=-p,p+=o;p>0;s=256*s+e[t+d],d+=h,p-=8);for(a=s&(1<<-p)-1,s>>=-p,p+=i;p>0;a=256*a+e[t+d],d+=h,p-=8);if(s===0)s=1-u;else{if(s===c)return a?NaN:1/0*(l?-1:1);a+=Math.pow(2,i),s-=u}return(l?-1:1)*a*Math.pow(2,s-i)}function Am(e,t,r,i,n,s){var a,o,c,u=8*s-n-1,p=(1<<u)-1,d=p>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:s-1,f=i?1:-1,m=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=p):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=p?(o=0,a=p):a+d>=1?(o=(t*c-1)*Math.pow(2,n),a+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,n),a=0));n>=8;e[r+l]=255&o,l+=f,o/=256,n-=8);for(a=a<<n|o,u+=n;u>0;e[r+l]=255&a,l+=f,a/=256,u-=8);e[r+l-f]|=128*m}var kE={}.toString,Tm=Array.isArray||function(e){return kE.call(e)=="[object Array]"};function ts(){return b.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function nt(e,t){if(ts()<t)throw new RangeError("Invalid typed array length");return b.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=b.prototype:(e===null&&(e=new b(t)),e.length=t),e}function b(e,t,r){if(!(b.TYPED_ARRAY_SUPPORT||this instanceof b))return new b(e,t,r);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return Lc(this,e)}return bm(this,e,t,r)}function bm(e,t,r,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?(function(n,s,a,o){if(s.byteLength,a<0||s.byteLength<a)throw new RangeError("'offset' is out of bounds");if(s.byteLength<a+(o||0))throw new RangeError("'length' is out of bounds");return s=a===void 0&&o===void 0?new Uint8Array(s):o===void 0?new Uint8Array(s,a):new Uint8Array(s,a,o),b.TYPED_ARRAY_SUPPORT?(n=s).__proto__=b.prototype:n=mc(n,s),n})(e,t,r,i):typeof t=="string"?(function(n,s,a){if(typeof a=="string"&&a!==""||(a="utf8"),!b.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var o=0|_m(s,a);n=nt(n,o);var c=n.write(s,a);return c!==o&&(n=n.slice(0,c)),n})(e,t,r):(function(n,s){if($e(s)){var a=0|cp(s.length);return(n=nt(n,a)).length===0||s.copy(n,0,0,a),n}if(s){if(typeof ArrayBuffer<"u"&&s.buffer instanceof ArrayBuffer||"length"in s)return typeof s.length!="number"||(o=s.length)!=o?nt(n,0):mc(n,s);if(s.type==="Buffer"&&Tm(s.data))return mc(n,s.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")})(e,t)}function Im(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Lc(e,t){if(Im(t),e=nt(e,t<0?0:0|cp(t)),!b.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function mc(e,t){var r=t.length<0?0:0|cp(t.length);e=nt(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function cp(e){if(e>=ts())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ts().toString(16)+" bytes");return 0|e}function $e(e){return!(e==null||!e._isBuffer)}function _m(e,t){if($e(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var r=e.length;if(r===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return rs(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return km(e).length;default:if(i)return rs(e).length;t=(""+t).toLowerCase(),i=!0}}function NE(e,t,r){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return HE(this,t,r);case"utf8":case"utf-8":return Mm(this,t,r);case"ascii":return UE(this,t,r);case"latin1":case"binary":return xE(this,t,r);case"base64":return BE(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $E(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function Kt(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function Bf(e,t,r,i,n){if(e.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if(typeof t=="string"&&(t=b.from(t,i)),$e(t))return t.length===0?-1:Uf(e,t,r,i,n);if(typeof t=="number")return t&=255,b.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):Uf(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function Uf(e,t,r,i,n){var s,a=1,o=e.length,c=t.length;if(i!==void 0&&((i=String(i).toLowerCase())==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(e.length<2||t.length<2)return-1;a=2,o/=2,c/=2,r/=2}function u(l,f){return a===1?l[f]:l.readUInt16BE(f*a)}if(n){var p=-1;for(s=r;s<o;s++)if(u(e,s)===u(t,p===-1?0:s-p)){if(p===-1&&(p=s),s-p+1===c)return p*a}else p!==-1&&(s-=s-p),p=-1}else for(r+c>o&&(r=o-c),s=r;s>=0;s--){for(var d=!0,h=0;h<c;h++)if(u(e,s+h)!==u(t,h)){d=!1;break}if(d)return s}return-1}function jE(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var a=0;a<i;++a){var o=parseInt(t.substr(2*a,2),16);if(isNaN(o))return a;e[r+a]=o}return a}function zE(e,t,r,i){return Es(rs(t,e.length-r),e,r,i)}function Om(e,t,r,i){return Es((function(n){for(var s=[],a=0;a<n.length;++a)s.push(255&n.charCodeAt(a));return s})(t),e,r,i)}function LE(e,t,r,i){return Om(e,t,r,i)}function FE(e,t,r,i){return Es(km(t),e,r,i)}function qE(e,t,r,i){return Es((function(n,s){for(var a,o,c,u=[],p=0;p<n.length&&!((s-=2)<0);++p)o=(a=n.charCodeAt(p))>>8,c=a%256,u.push(c),u.push(o);return u})(t,e.length-r),e,r,i)}function BE(e,t,r){return t===0&&r===e.length?qf(e):qf(e.slice(t,r))}function Mm(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var s,a,o,c,u=e[n],p=null,d=u>239?4:u>223?3:u>191?2:1;if(n+d<=r)switch(d){case 1:u<128&&(p=u);break;case 2:(192&(s=e[n+1]))==128&&(c=(31&u)<<6|63&s)>127&&(p=c);break;case 3:s=e[n+1],a=e[n+2],(192&s)==128&&(192&a)==128&&(c=(15&u)<<12|(63&s)<<6|63&a)>2047&&(c<55296||c>57343)&&(p=c);break;case 4:s=e[n+1],a=e[n+2],o=e[n+3],(192&s)==128&&(192&a)==128&&(192&o)==128&&(c=(15&u)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&c<1114112&&(p=c)}p===null?(p=65533,d=1):p>65535&&(p-=65536,i.push(p>>>10&1023|55296),p=56320|1023&p),i.push(p),n+=d}return(function(h){var l=h.length;if(l<=xf)return String.fromCharCode.apply(String,h);for(var f="",m=0;m<l;)f+=String.fromCharCode.apply(String,h.slice(m,m+=xf));return f})(i)}b.TYPED_ARRAY_SUPPORT=Ff.TYPED_ARRAY_SUPPORT===void 0||Ff.TYPED_ARRAY_SUPPORT,ts(),b.poolSize=8192,b._augment=function(e){return e.__proto__=b.prototype,e},b.from=function(e,t,r){return bm(null,e,t,r)},b.TYPED_ARRAY_SUPPORT&&(b.prototype.__proto__=Uint8Array.prototype,b.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&b[Symbol.species]),b.alloc=function(e,t,r){return(function(i,n,s,a){return Im(n),n<=0?nt(i,n):s!==void 0?typeof a=="string"?nt(i,n).fill(s,a):nt(i,n).fill(s):nt(i,n)})(null,e,t,r)},b.allocUnsafe=function(e){return Lc(null,e)},b.allocUnsafeSlow=function(e){return Lc(null,e)},b.isBuffer=KE,b.compare=function(e,t){if(!$e(e)||!$e(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},b.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(e,t){if(!Tm(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return b.alloc(0);var r;if(t===void 0)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=b.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var s=e[r];if(!$e(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n),n+=s.length}return i},b.byteLength=_m,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Kt(this,t,t+1);return this},b.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Kt(this,t,t+3),Kt(this,t+1,t+2);return this},b.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Kt(this,t,t+7),Kt(this,t+1,t+6),Kt(this,t+2,t+5),Kt(this,t+3,t+4);return this},b.prototype.toString=function(){var e=0|this.length;return e===0?"":arguments.length===0?Mm(this,0,e):NE.apply(this,arguments)},b.prototype.equals=function(e){if(!$e(e))throw new TypeError("Argument must be a Buffer");return this===e||b.compare(this,e)===0},b.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},b.prototype.compare=function(e,t,r,i,n){if(!$e(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),r===void 0&&(r=e?e.length:0),i===void 0&&(i=0),n===void 0&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var s=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(t>>>=0),o=Math.min(s,a),c=this.slice(i,n),u=e.slice(t,r),p=0;p<o;++p)if(c[p]!==u[p]){s=c[p],a=u[p];break}return s<a?-1:a<s?1:0},b.prototype.includes=function(e,t,r){return this.indexOf(e,t,r)!==-1},b.prototype.indexOf=function(e,t,r){return Bf(this,e,t,r,!0)},b.prototype.lastIndexOf=function(e,t,r){return Bf(this,e,t,r,!1)},b.prototype.write=function(e,t,r,i){if(t===void 0)i="utf8",r=this.length,t=0;else if(r===void 0&&typeof t=="string")i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,i===void 0&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((r===void 0||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return jE(this,e,t,r);case"utf8":case"utf-8":return zE(this,e,t,r);case"ascii":return Om(this,e,t,r);case"latin1":case"binary":return LE(this,e,t,r);case"base64":return FE(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qE(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var xf=4096;function UE(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function xE(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function HE(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=t;s<r;++s)n+=VE(e[s]);return n}function $E(e,t,r){for(var i=e.slice(t,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function ie(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function fe(e,t,r,i,n,s){if(!$e(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function Ho(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,s=Math.min(e.length-r,2);n<s;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function $o(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,s=Math.min(e.length-r,4);n<s;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function Dm(e,t,r,i,n,s){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Hf(e,t,r,i,n){return n||Dm(e,0,r,4),Am(e,t,r,i,23,4),r+4}function $f(e,t,r,i,n){return n||Dm(e,0,r,8),Am(e,t,r,i,52,8),r+8}b.prototype.slice=function(e,t){var r,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=t===void 0?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),b.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=b.prototype;else{var n=t-e;r=new b(n,void 0);for(var s=0;s<n;++s)r[s]=this[s+e]}return r},b.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||ie(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i},b.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||ie(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},b.prototype.readUInt8=function(e,t){return t||ie(e,1,this.length),this[e]},b.prototype.readUInt16LE=function(e,t){return t||ie(e,2,this.length),this[e]|this[e+1]<<8},b.prototype.readUInt16BE=function(e,t){return t||ie(e,2,this.length),this[e]<<8|this[e+1]},b.prototype.readUInt32LE=function(e,t){return t||ie(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},b.prototype.readUInt32BE=function(e,t){return t||ie(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},b.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||ie(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},b.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||ie(e,t,this.length);for(var i=t,n=1,s=this[e+--i];i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},b.prototype.readInt8=function(e,t){return t||ie(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},b.prototype.readInt16LE=function(e,t){t||ie(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},b.prototype.readInt16BE=function(e,t){t||ie(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},b.prototype.readInt32LE=function(e,t){return t||ie(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},b.prototype.readInt32BE=function(e,t){return t||ie(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},b.prototype.readFloatLE=function(e,t){return t||ie(e,4,this.length),xo(this,e,!0,23,4)},b.prototype.readFloatBE=function(e,t){return t||ie(e,4,this.length),xo(this,e,!1,23,4)},b.prototype.readDoubleLE=function(e,t){return t||ie(e,8,this.length),xo(this,e,!0,52,8)},b.prototype.readDoubleBE=function(e,t){return t||ie(e,8,this.length),xo(this,e,!1,52,8)},b.prototype.writeUIntLE=function(e,t,r,i){e=+e,t|=0,r|=0,i||fe(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},b.prototype.writeUIntBE=function(e,t,r,i){e=+e,t|=0,r|=0,i||fe(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},b.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,1,255,0),b.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},b.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,2,65535,0),b.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Ho(this,e,t,!0),t+2},b.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,2,65535,0),b.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Ho(this,e,t,!1),t+2},b.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,4,4294967295,0),b.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):$o(this,e,t,!0),t+4},b.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,4,4294967295,0),b.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):$o(this,e,t,!1),t+4},b.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);fe(this,e,t,r,n-1,-n)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&o===0&&this[t+s-1]!==0&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},b.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);fe(this,e,t,r,n-1,-n)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&o===0&&this[t+s+1]!==0&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},b.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,1,127,-128),b.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},b.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,2,32767,-32768),b.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Ho(this,e,t,!0),t+2},b.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,2,32767,-32768),b.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Ho(this,e,t,!1),t+2},b.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,4,2147483647,-2147483648),b.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):$o(this,e,t,!0),t+4},b.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||fe(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),b.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):$o(this,e,t,!1),t+4},b.prototype.writeFloatLE=function(e,t,r){return Hf(this,e,t,!0,r)},b.prototype.writeFloatBE=function(e,t,r){return Hf(this,e,t,!1,r)},b.prototype.writeDoubleLE=function(e,t,r){return $f(this,e,t,!0,r)},b.prototype.writeDoubleBE=function(e,t,r){return $f(this,e,t,!1,r)},b.prototype.copy=function(e,t,r,i){if(r||(r=0),i||i===0||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n,s=i-r;if(this===e&&r<t&&t<i)for(n=s-1;n>=0;--n)e[n+t]=this[n+r];else if(s<1e3||!b.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},b.prototype.fill=function(e,t,r,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,r=this.length):typeof r=="string"&&(i=r,r=this.length),e.length===1){var n=e.charCodeAt(0);n<256&&(e=n)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!b.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var s;if(t>>>=0,r=r===void 0?this.length:r>>>0,e||(e=0),typeof e=="number")for(s=t;s<r;++s)this[s]=e;else{var a=$e(e)?e:rs(new b(e,i).toString()),o=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%o]}return this};var WE=/[^+\/0-9A-Za-z-_]/g;function VE(e){return e<16?"0"+e.toString(16):e.toString(16)}function rs(e,t){var r;t=t||1/0;for(var i=e.length,n=null,s=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function km(e){return(function(t){var r,i,n,s,a,o;ap||Em();var c=t.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=t[c-2]==="="?2:t[c-1]==="="?1:0,o=new ME(3*c/4-a),n=a>0?c-4:c;var u=0;for(r=0,i=0;r<n;r+=4,i+=3)s=Te[t.charCodeAt(r)]<<18|Te[t.charCodeAt(r+1)]<<12|Te[t.charCodeAt(r+2)]<<6|Te[t.charCodeAt(r+3)],o[u++]=s>>16&255,o[u++]=s>>8&255,o[u++]=255&s;return a===2?(s=Te[t.charCodeAt(r)]<<2|Te[t.charCodeAt(r+1)]>>4,o[u++]=255&s):a===1&&(s=Te[t.charCodeAt(r)]<<10|Te[t.charCodeAt(r+1)]<<4|Te[t.charCodeAt(r+2)]>>2,o[u++]=s>>8&255,o[u++]=255&s),o})((function(t){if((t=(function(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")})(t).replace(WE,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t})(e))}function Es(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function KE(e){return e!=null&&(!!e._isBuffer||Wf(e)||(function(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&Wf(t.slice(0,0))})(e))}function Wf(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var Fc,qc,Bc,N,Ve,Vf,Kf,ns,Uc,is;function hr(e){return(e==null?void 0:e.errorCode)!==void 0}(function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"})(Fc||(Fc={})),(function(e){e.M365Content="m365content"})(qc||(qc={})),(function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"})(Bc||(Bc={})),(function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"})(N||(N={})),(function(e){e.GeoLocation="geolocation",e.Media="media"})(Ve||(Ve={})),(function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"})(Vf||(Vf={})),(function(e){e.Faculty="faculty",e.Student="student",e.Other="other"})(Kf||(Kf={})),(function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NotAdult="notAdult",e.NonAdult="notAdult"})(ns||(ns={})),(function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"})(Uc||(Uc={})),(function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"})(is||(is={}));var z,mo,C,xc,Hc,$c,ge,Wc;(function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.visionOS="visionOS",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"})(z||(z={})),(function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"})(mo||(mo={})),(function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"})(C||(C={})),(function(e){e.copilotSidePanel="copilotSidePanel",e.copilotMainPane="copilotMainPane",e.copilotFullScreen="copilotFullScreen"})(xc||(xc={})),(function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"})(Hc||(Hc={})),(function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"})($c||($c={})),(function(e){e.Large="large",e.Medium="medium",e.Small="small"})(ge||(ge={})),(function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"})(Wc||(Wc={}));const E={errorCode:N.NOT_SUPPORTED_ON_PLATFORM},Gf={majorVersion:1,minorVersion:5},GE={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},JE=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),QE=new Error("Invalid response: Received more images than the specified max limit in the response.");var Jf={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Wo;const YE=new Uint8Array(16);function ZE(){if(!Wo&&(Wo=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Wo))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Wo(YE)}const se=[];for(let e=0;e<256;++e)se.push((e+256).toString(16).slice(1));function XE(e,t=0){return se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]}function Nm(e,t,r){if(Jf.randomUUID&&!e)return Jf.randomUUID();const i=(e=e||{}).random||(e.rng||ZE)();return i[6]=15&i[6]|64,i[8]=63&i[8]|128,XE(i)}var eA=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jm(e){return typeof e=="string"&&eA.test(e)}function Rt(e){return(t,r)=>{if(!t)throw new Error(r)}}function As(e,t){if(typeof e!="string"||typeof t!="string")return NaN;const r=e.split("."),i=t.split(".");function n(s){return/^\d+$/.test(s)}if(!r.every(n)||!i.every(n))return NaN;for(;r.length<i.length;)r.push("0");for(;i.length<r.length;)i.push("0");for(let s=0;s<r.length;++s)if(Number(r[s])!=Number(i[s]))return Number(r[s])>Number(i[s])?1:-1;return 0}function up(){return Nm()}function zm(e){return Object.keys(e).forEach((t=>{e[t]!==null&&e[t]!==void 0&&typeof e[t]=="object"&&zm(e[t])})),Object.freeze(e)}function tA(e,t,...r){const i=e(...r);return i.then((n=>{t&&t(void 0,n)})).catch((n=>{t&&t(n)})),i}function Qf(e,t,...r){const i=e(...r);return i.then((()=>{t&&t(null)})).catch((n=>{t&&t(n)})),i}function rA(e,t,...r){const i=e(...r);return i.then((n=>{t&&t(null,n)})).catch((n=>{t&&t(n,null)})),i}function nA(e,t,r){return new Promise(((i,n)=>{const s=setTimeout(n,t,r);e().then((a=>{clearTimeout(s),i(a)})).catch((a=>{clearTimeout(s),n(a)}))}))}function iA(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function Lm(e){return!(As(`${e.majorVersion}.${e.minorVersion}`,`${Gf.majorVersion}.${Gf.minorVersion}`)>=0)}function pp(e){return e.protocol==="https:"}function oA(e,t){return new Promise(((r,i)=>{if(e||i("MimeType cannot be null or empty."),t||i("Base64 string cannot be null or empty."),e.startsWith("image/")){const s=atob(t),a=new Uint8Array(s.length);for(let o=0;o<s.length;o++)a[o]=s.charCodeAt(o);r(new Blob([a],{type:e}))}const n=b.from(t,"base64").toString();r(new Blob([n],{type:e}))}))}function sA(e){return new Promise(((t,r)=>{e.size===0&&r(new Error("Blob cannot be empty."));const i=new FileReader;i.onloadend=()=>{i.result?t(i.result.toString().split(",")[1]):r(new Error("Failed to read the blob"))},i.onerror=()=>{r(i.error)},i.readAsDataURL(e)}))}function ur(){if(Ue())throw new Error("window object undefined at SSR check");return window}function Ue(){return typeof window>"u"}function Ke(e,t){if(dp(e)||!(function(r){return r.length<256&&r.length>4})(e)||!(function(r){for(let i=0;i<r.length;i++){const n=r.charCodeAt(i);if(n<32||n>126)return!1}return!0})(e))throw t||new Error("id is not valid.")}function Fm(e,t){const r=e.toString().toLocaleLowerCase();if(dp(r))throw new Error("Invalid Url");if(r.length>2048)throw new Error("Url exceeds the maximum size of 2048 characters");if(!pp(e))throw new Error("Url should be a valid https url")}function aA(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function dp(e){return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function cA(e){if(!e)throw new Error("id must not be empty");if(jm(e)===!1)throw new Error("id must be a valid UUID")}const uA=!!performance&&"now"in performance;function Ts(){return uA?performance.now()+performance.timeOrigin:void 0}function Vc(e,t=0){return t>1e3?!1:e===void 0||typeof e=="boolean"||typeof e=="number"||typeof e=="bigint"||typeof e=="string"||e===null?!0:Array.isArray(e)?e.every((r=>Vc(r,t+1))):!(typeof e!="object"||Object.prototype.toString.call(e)!=="[object Object]"||Object.getPrototypeOf(e)!==Object.prototype&&Object.getPrototypeOf(e)!==null)&&Object.keys(e).every((r=>Vc(e[r],t+1)))}function Yf(e){var t,r;if(!(!((r=(t=e.hostVersionsInfo)===null||t===void 0?void 0:t.appEligibilityInformation)===null||r===void 0)&&r.ageGroup))return e;const i=e.hostVersionsInfo.appEligibilityInformation.ageGroup;return(i==null?void 0:i.toLowerCase())!=="nonadult"?e:Object.assign(Object.assign({},e),{hostVersionsInfo:Object.assign(Object.assign({},e.hostVersionsInfo),{appEligibilityInformation:Object.assign(Object.assign({},e.hostVersionsInfo.appEligibilityInformation),{ageGroup:ns.NotAdult})})})}let Et=class{constructor(t=up()){this.uuid=t,cA(t)}toString(){return this.uuid}serialize(){return this.toString()}};function pA(e){if(!(e instanceof Et))throw new Error(`Potential id (${JSON.stringify(e)}) is invalid; it is not an instance of UUID class.`)}const qm=e=>{const{uuid:t}=e,r=wt(e,["uuid"]),i=t==null?void 0:t.toString();return Object.assign(Object.assign({},r),{uuidAsString:i})},dA=e=>{const{uuidAsString:t}=e,r=wt(e,["uuidAsString"]);return Object.assign(Object.assign({},r),{uuid:t?new Et(t):void 0})},lA=e=>{const{uuidAsString:t}=e,r=wt(e,["uuidAsString"]);return Object.assign(Object.assign({},r),{uuid:t?new Et(t):void 0})},hA=e=>{const{uuid:t}=e,r=wt(e,["uuid"]),i=t==null?void 0:t.toString();return Object.assign(Object.assign({},r),{uuidAsString:i})};var Kc={exports:{}},Zf,Xf;function vA(){if(Xf)return Zf;Xf=1;var e=1e3,t=60*e,r=60*t,i=24*r,n=7*i,s=365.25*i;function a(o,c,u,p){var d=c>=1.5*u;return Math.round(o/u)+" "+p+(d?"s":"")}return Zf=function(o,c){c=c||{};var u=typeof o;if(u==="string"&&o.length>0)return(function(p){if(!((p=String(p)).length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(d){var h=parseFloat(d[1]);switch((d[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return h*s;case"weeks":case"week":case"w":return h*n;case"days":case"day":case"d":return h*i;case"hours":case"hour":case"hrs":case"hr":case"h":return h*r;case"minutes":case"minute":case"mins":case"min":case"m":return h*t;case"seconds":case"second":case"secs":case"sec":case"s":return h*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}})(o);if(u==="number"&&isFinite(o))return c.long?(function(p){var d=Math.abs(p);return d>=i?a(p,d,i,"day"):d>=r?a(p,d,r,"hour"):d>=t?a(p,d,t,"minute"):d>=e?a(p,d,e,"second"):p+" ms"})(o):(function(p){var d=Math.abs(p);return d>=i?Math.round(p/i)+"d":d>=r?Math.round(p/r)+"h":d>=t?Math.round(p/t)+"m":d>=e?Math.round(p/e)+"s":p+"ms"})(o);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))}}var fA=function(e){function t(n){let s,a,o,c=null;function u(...p){if(!u.enabled)return;const d=u,h=Number(new Date),l=h-(s||h);d.diff=l,d.prev=s,d.curr=h,s=h,p[0]=t.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");let f=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,((m,P)=>{if(m==="%%")return"%";f++;const g=t.formatters[P];if(typeof g=="function"){const w=p[f];m=g.call(d,w),p.splice(f,1),f--}return m})),t.formatArgs.call(d,p),(d.log||t.log).apply(d,p)}return u.namespace=n,u.useColors=t.useColors(),u.color=t.selectColor(n),u.extend=r,u.destroy=t.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>c!==null?c:(a!==t.namespaces&&(a=t.namespaces,o=t.enabled(n)),o),set:p=>{c=p}}),typeof t.init=="function"&&t.init(u),u}function r(n,s){const a=t(this.namespace+(s===void 0?":":s)+n);return a.log=this.log,a}function i(n){return n.toString().substring(2,n.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(n){return n instanceof Error?n.stack||n.message:n},t.disable=function(){const n=[...t.names.map(i),...t.skips.map(i).map((s=>"-"+s))].join(",");return t.enable(""),n},t.enable=function(n){let s;t.save(n),t.namespaces=n,t.names=[],t.skips=[];const a=(typeof n=="string"?n:"").split(/[\s,]+/),o=a.length;for(s=0;s<o;s++)a[s]&&((n=a[s].replace(/\*/g,".*?"))[0]==="-"?t.skips.push(new RegExp("^"+n.slice(1)+"$")):t.names.push(new RegExp("^"+n+"$")))},t.enabled=function(n){if(n[n.length-1]==="*")return!0;let s,a;for(s=0,a=t.skips.length;s<a;s++)if(t.skips[s].test(n))return!1;for(s=0,a=t.names.length;s<a;s++)if(t.names[s].test(n))return!0;return!1},t.humanize=vA(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(n){let s=0;for(let a=0;a<n.length;a++)s=(s<<5)-s+n.charCodeAt(a),s|=0;return t.colors[Math.abs(s)%t.colors.length]},t.enable(t.load()),t},gA={};(function(e,t){t.formatArgs=function(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;i.splice(1,0,n,"color: inherit");let s=0,a=0;i[0].replace(/%[a-zA-Z%]/g,(o=>{o!=="%%"&&(s++,o==="%c"&&(a=s))})),i.splice(a,0,n)},t.save=function(i){try{i?t.storage.setItem("debug",i):t.storage.removeItem("debug")}catch{}},t.load=function(){let i;try{i=t.storage.getItem("debug")}catch{}return!i&&typeof process<"u"&&"env"in process&&(i=gA.DEBUG),i},t.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=(function(){try{return localStorage}catch{}})(),t.destroy=(()=>{let i=!1;return()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=fA(t);const{formatters:r}=e.exports;r.j=function(i){try{return JSON.stringify(i)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}}})(Kc,Kc.exports);var lp=Kc.exports;const mA=new Et,SA=lp.debug.formatArgs;lp.debug.formatArgs=function(e){e[0]=`(${new Date().toISOString()}): ${e[0]} [${mA.toString()}]`,SA.call(this,e)};const CA=lp.debug("teamsJs");function ae(e){return CA.extend(e)}function S(e,t){return`${e}_${t}`}function hp(e){return/^v\d+_[\w.]+$/.test(e)}function be(e){return e.uuidAsString!==void 0?`${e.uuidAsString} (legacy id: ${e.id})`:e.uuid!==void 0?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}const yA=ae("flushMessageQueue");function vp(e,t,r,i){if(e&&t&&r.length!==0)for(;r.length>0;){const n=r.shift();if(n){const s=qm(n);yA("Flushing message %s from %s message queue via postMessage.",be(s),i),e.postMessage(s,t)}}}var PA=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.office365.us","outlook-dod.office365.us","webmail.apps.mil","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","*.outlook.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net","fa000000125.officeapps.live.com","fa000000129.officeapps.live.com","fa000000124.officeapps.live.com","fa000000128.officeapps.live.com","fa000000136.mro1cdnstorage.public.cdn.office.net","fa000000136.mro1cdnstorage.public.onecdn.static.microsoft","substrate-msb-bizchatvnext-service.sdf01.substrate-msb-bingatwork.eastus2-sdf.cosmic-ppe.office.net","office-home-m365copilotapp.wus2sdf1.office-home-m365copilotapp.westus2-sdf.cosmic-ppe.office.net","office-home-m365copilotapp.wus2test1.office-home-m365copilotapp.westus2-test.cosmic-int.office.net","m365copilotapp.svc.cloud.microsoft","m365copilotapp.svc.cloud.dev.microsoft","ffc-copilot.officeapps.live.com","m365.cloud.dev.microsoft","m365.cloud.dev.microsoft:3001"];const os="2.0.1",wA="2.0.2",Bm="2.0.3",RA="2.0.4",EA="2.0.1",Um="1.9.0",AA="2.0.0",TA="1.7.0",fp="1.8.0",bA="2.0.0",IA="1.9.0",Jo=PA,eg=1500,_A=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),OA=/^https:\/\//,bs="https",Is="teams.microsoft.com",So="The library has not yet been initialized",MA="The runtime has not yet been initialized",DA="The runtime version is not supported",kA="The call was not properly started";let _=class{};_.initializeCalled=!1,_.initializeCompleted=!1,_.additionalValidOrigins=[],_.initializePromise=void 0,_.isFramelessWindow=!1,_.frameContext=void 0,_.hostClientType=void 0,_.printCapabilityEnabled=!1,_.teamsJsInstanceId=new Et().toString();const xm=ae("runtime"),_s=4;function Hm(e){return e.apiVersion===_s}function NA(e){if(Hm(e))return!0;throw e.apiVersion===-1?new Error(MA):new Error(DA)}let v={apiVersion:-1,supports:{}};const jA={supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},$m=[z.desktop,z.web,z.rigel,z.surfaceHub,z.teamsRoomsWindows,z.teamsRoomsAndroid,z.teamsPhones,z.teamsDisplays],zA=[z.android,z.ios,z.ipados,z.visionOS],tg=[...$m,...zA];function LA(e){let t=e;if(t.apiVersion<_s&&FA.forEach((r=>{t.apiVersion===r.versionToUpgradeFrom&&(t=r.upgradeToNextVersion(t))})),Hm(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const FA=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:(t=e.supports.dialog)===null||t===void 0?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,r=wt(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,r,i,n,s;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:(t=e.supports.dialog)===null||t===void 0?void 0:t.card,url:{bot:(i=(r=e.supports.dialog)===null||r===void 0?void 0:r.url)===null||i===void 0?void 0:i.bot,parentCommunication:!((n=e.supports.dialog)===null||n===void 0)&&n.url?{}:void 0},update:(s=e.supports.dialog)===null||s===void 0?void 0:s.update}:void 0})}}}],qA="2.1.2",BA={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:$m}],"1.9.0":[{capability:{location:{}},hostClientTypes:tg}],"2.0.0":[{capability:{people:{}},hostClientTypes:tg},{capability:{sharing:{}},hostClientTypes:[z.desktop,z.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[z.android,z.desktop,z.ios,z.teamsRoomsAndroid,z.teamsPhones,z.teamsDisplays,z.web]},{capability:{webStorage:{}},hostClientTypes:[z.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[z.android,z.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[z.android,z.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[z.android,z.ios,z.ipados,z.visionOS]}],"2.1.2":[]},Sc=xm.extend("generateBackCompatRuntimeConfig");function Wm(e,t){const r=Object.assign({},e);for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(typeof t[i]!="object"||Array.isArray(t[i])?i in e||(r[i]=t[i]):r[i]=Wm(e[i]||{},t[i]));return r}function UA(e,t,r){Sc("generating back compat runtime config for %s",e);let i=Object.assign({},t.supports);Sc("Supported capabilities in config before updating based on highestSupportedVersion: %o",i),Object.keys(r).forEach((s=>{As(e,s)>=0&&r[s].forEach((a=>{_.hostClientType!==void 0&&a.hostClientTypes.includes(_.hostClientType)&&(i=Wm(i,a.capability))}))}));const n={apiVersion:_s,hostVersionsInfo:GE,isLegacyTeams:!0,supports:i};return Sc("Runtime config after updating based on highestSupportedVersion: %o",n),n}const Cc=xm.extend("applyRuntimeConfig");function yc(e){typeof e.apiVersion=="string"&&(Cc("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),Cc("Fast-forwarding runtime %o",e);const t=LA(e);Cc("Applying runtime %o",t),v=zm(t)}function xA(e){return e!=null&&e.serialize!==void 0&&typeof e.serialize=="function"}const Zt="2.48.0";let Co=class or{static storeCallbackInformation(t,r){or.callbackInformation.set(t,r)}static clearMessages(){or.callbackInformation.clear()}static deleteMessageInformation(t){or.callbackInformation.delete(t)}static handleOneWayPerformanceMetrics(t,r,i){const n=t.monotonicTimestamp;n&&i?dg({actionName:t.func,messageDelay:i-n,requestStartedAt:n}):r("Unable to send performance metrics for event %s",t.func)}static handlePerformanceMetrics(t,r,i,n){const s=or.callbackInformation.get(t);s&&r.monotonicTimestamp&&n?(dg({actionName:s.name,messageDelay:n-r.monotonicTimestamp,requestStartedAt:s.calledAt}),or.deleteMessageInformation(t)):i("Unable to send performance metrics for callback %s with arguments %o",t.toString(),r.args)}};Co.callbackInformation=new Map;const Vm=ae("nestedAppAuthUtils"),HA=Vm.extend("tryPolyfillWithNestedAppAuthBridge"),$A="v2";function WA(e,t,r){var i;const n=HA;if(_.isFramelessWindow)return void n("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void n("Cannot polyfill nestedAppAuthBridge as current window does not exist");if(t.parent!==t.top)return void n("Default NAA bridge injection not supported in nested iframe. Use standalone NAA bridge instead.");const s=(()=>{try{return JSON.parse(e)}catch{return null}})();if(!s||!(!((i=s.supports)===null||i===void 0)&&i.nestedAppAuth))return void n("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void n("nestedAppAuthBridge already exists on current window, skipping polyfill");const o=(function(c,u){const p=VA;if(!c)return p("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:d,sendPostMessage:h}=u,l=f=>m=>d(m,f);return{addEventListener:(f,m)=>{f==="message"?c.addEventListener(f,l(m)):p(`Event ${f} is not supported by nestedAppAuthBridge`)},postMessage:f=>{const m=(()=>{try{return JSON.parse(f)}catch{return null}})();if(!m||typeof m!="object"||m.messageType!=="NestedAppAuthRequest")return void p("Unrecognized data format received by app, message being ignored. Message: %o",f);const P=S($A,"nestedAppAuth.execute");h(f,P)},removeEventListener:(f,m)=>{c.removeEventListener(f,l(m))}}})(a,r);o&&(a.nestedAppAuthBridge=o)}const VA=Vm.extend("createNestedAppAuthBridge");let mt=[];const St=ae("validateOrigin");let co;function Km(){return j(this,void 0,void 0,(function*(){co||(yield Jm())}))}function Gm(){return mt.length===0}function Jm(e=!1){return j(this,void 0,void 0,(function*(){if(!Gm()&&!e)return mt;if(co)return co;if(Ue())return mt=Jo,Jo;{St("Initiating fetch call to acquire valid origins list from CDN");const t=new AbortController,r=setTimeout((()=>t.abort()),eg);return co=fetch(_A,{signal:t.signal}).then((i=>{if(clearTimeout(r),!i.ok)throw new Error("Invalid Response from Fetch Call");return St("Fetch call completed and retrieved valid origins list from CDN"),i.json().then((n=>{if((function(s){let a=JSON.parse(s);try{a=JSON.parse(s)}catch{return!1}if(!a.validOrigins)return!1;for(const o of a.validOrigins)try{new URL("https://"+o)}catch{return St("isValidOriginsFromCDN call failed to validate origin: %s",o),!1}return!0})(JSON.stringify(n)))return mt=n.validOrigins,mt;throw new Error("Valid origins list retrieved from CDN is invalid")}))})).catch((i=>(i.name==="AbortError"?St(`validOrigins fetch call to CDN failed due to Timeout of ${eg} ms. Defaulting to fallback list`):St("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",i),mt=Jo,mt))),co}}))}function rg(e,t){if(e.substring(0,2)==="*."){const r=e.substring(1);if(t.length>r.length&&t.split(".").length===r.split(".").length&&t.substring(t.length-r.length)===r)return!0}else if(e===t)return!0;return!1}function KA(e,t){const r=Gm()?Jo:mt;return ng(e,r)?Promise.resolve(!0):(St("Origin %s is not in the local valid origins list, fetching from CDN",e),Jm(t).then((i=>ng(e,i))))}function ng(e,t){if(!pp(e))return St("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const r=e.host;if(t.some((i=>rg(i,r))))return!0;for(const i of _.additionalValidOrigins)if(rg(i.substring(0,8)==="https://"?i.substring(8):i,r))return!0;return St(`Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.
Origins approved by this library: %o
Origins included in app.initialize: %o`,e,t,_.additionalValidOrigins),!1}Km();const tr=ae("communication");let k=class{},x=class{};function GA(e,t){if(x.messageListener=r=>(function(i){return j(this,void 0,void 0,(function*(){if(!i||!i.data||typeof i.data!="object")return void ig("Unrecognized message format received by app, message being ignored. Message: %o",i);const n=i.source||i.originalEvent&&i.originalEvent.source,s=i.origin||i.originalEvent&&i.originalEvent.origin;return Xm(n,s).then((a=>{a?((function(o,c){_.isFramelessWindow||k.parentWindow&&!k.parentWindow.closed&&o!==k.parentWindow||(k.parentWindow=o,k.parentOrigin=c),k.parentWindow&&k.parentWindow.closed&&(k.parentWindow=null,k.parentOrigin=null),vp(k.parentWindow,k.parentOrigin,x.parentMessageQueue,"parent")})(n,s),n!==k.parentWindow?dI(n,s)&&lI(i,n,Os,((o,c)=>x.callbacks.set(o,c))):sg(i)):ig("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",i,n,s)}))}))})(r),k.currentWindow=k.currentWindow||ur(),k.parentWindow=k.currentWindow.parent!==k.currentWindow.self?k.currentWindow.parent:k.currentWindow.opener,k.topWindow=k.currentWindow.top,(k.parentWindow||e)&&k.currentWindow.addEventListener("message",x.messageListener,!1),!k.parentWindow){const r=k.currentWindow;if(!r.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));_.isFramelessWindow=!0,r.onNativeMessage=sg}try{return k.parentOrigin="*",re(t,"initialize",[Zt,_s,e]).then((([r,i,n,s])=>(WA(s,k.currentWindow,{onMessage:tT,sendPostMessage:YA}),{context:r,clientType:i,runtimeConfig:n,clientSupportedSDKVersion:s})))}finally{k.parentOrigin=null}}function JA(){k.currentWindow&&k.currentWindow.removeEventListener("message",x.messageListener,!1),k.currentWindow=null,k.parentWindow=null,k.parentOrigin=null,x.parentMessageQueue=[],x.nextMessageId=0,x.callbacks.clear(),x.promiseCallbacks.clear(),x.portCallbacks.clear(),x.legacyMessageIdsToUuidMap={},Co.clearMessages(),pI()}function Je(e,t,...r){return re(e,t,r).then((([i])=>i))}function de(e,t,...r){return re(e,t,r).then((([i,n])=>{if(!i)throw new Error(n)}))}function gp(e,t,r,...i){return re(e,t,i).then((([n,s])=>{if(!n)throw new Error(s||r)}))}function U(e,t,...r){return re(e,t,r).then((([i,n])=>{if(i)throw i;return n}))}function re(e,t,r=void 0){if(!hp(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((i=>{const n=Os(e,t,r);var s;i((s=n.uuid,new Promise((a=>{x.promiseCallbacks.set(s,a)}))))}))}function Qm(e){return e.map((t=>xA(t)?t.serialize():t))}function ce(e,t,r,i,n){var s;return j(this,void 0,void 0,(function*(){const a=Qm(t),[o]=yield re(i,e,a);if(n&&n(o)||!n&&hr(o))throw new Error(`${o.errorCode}, message: ${(s=o.message)!==null&&s!==void 0?s:"None"}`);if(r.validate(o))return r.deserialize(o);throw new Error(`${N.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(o)}`)}))}function ne(e,t,r,i){var n;return j(this,void 0,void 0,(function*(){const s=Qm(t),[a]=yield re(r,e,s);if(i&&i(a)||!i&&hr(a))throw new Error(`${a.errorCode}, message: ${(n=a.message)!==null&&n!==void 0?n:"None"}`);if(a!==void 0)throw new Error(`${N.INTERNAL_ERROR}, message: Invalid response from host`)}))}function Ym(e,t,r=void 0){if(!hp(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return n=Os(e,t,r).uuid,new Promise(((s,a)=>{x.portCallbacks.set(n,((o,c)=>{o instanceof MessagePort?s(o):a(c&&c.length>0?c[0]:new Error("Host responded without port or error details."))}))}));var n}function T(e,t,r,i){let n;if(r instanceof Function?i=r:r instanceof Array&&(n=r),!hp(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const s=Os(e,t,n);i&&x.callbacks.set(s.uuid,i)}x.parentMessageQueue=[],x.topMessageQueue=[],x.nextMessageId=0,x.callbacks=new Map,x.promiseCallbacks=new Map,x.portCallbacks=new Map,x.legacyMessageIdsToUuidMap={};const QA=tr.extend("sendNestedAuthRequestToTopWindow");function YA(e,t){const r=QA,i=k.topWindow,n=(function(s,a){const o=x.nextMessageId++,c=new Et;return x.legacyMessageIdsToUuidMap[o]=c,{id:o,uuid:c,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:Ts(),apiVersionTag:a,args:[],data:s}})(e,t);return r("Message %s information: %o",be(n),{actionName:n.func}),Zm(i,n)}const ZA=tr.extend("sendRequestToTargetWindowHelper");function Zm(e,t){const r=ZA,i=(function(s){return s===k.topWindow&&Gc()?"top":s===k.parentWindow?"parent":null})(e),n=qm(t);if(_.isFramelessWindow)k.currentWindow&&k.currentWindow.nativeInterface&&(r("Sending message %s to %s via framelessPostMessage interface",be(n),i),k.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(n)));else{const s=(function(a){return a===k.topWindow&&Gc()?k.topOrigin:a===k.parentWindow?k.parentOrigin:null})(e);e&&s?(r("Sending message %s to %s via postMessage",be(n),i),e.postMessage(n,s)):(r("Adding message %s to %s message queue",be(n),i),eS(e).push(t))}return t}const XA=tr.extend("sendMessageToParentHelper");function Os(e,t,r,i,n){const s=XA,a=k.parentWindow,o=(function(c,u,p,d,h){const l=x.nextMessageId++,f=new Et;x.legacyMessageIdsToUuidMap[l]=f;const m=d===!0?h:_.teamsJsInstanceId;return{id:l,uuid:f,func:u,timestamp:Date.now(),monotonicTimestamp:Ts(),args:p||[],apiVersionTag:c,isProxiedFromChild:d!=null&&d,teamsJsInstanceId:m}})(e,t,r,i,n);return Co.storeCallbackInformation(o.uuid,{name:t,calledAt:o.timestamp}),s("Message %s information: %o",be(o),{actionName:t,args:r}),Zm(a,o)}const ig=tr.extend("processIncomingMessage"),eT=tr.extend("processAuthBridgeMessage");function tT(e,t){var r,i;const n=eT;if(!e||!e.data||typeof e.data!="object")return void n("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:s}=e.data,[,a]=s??[],o=(()=>{try{return JSON.parse(a)}catch{return null}})();if(!o||typeof o!="object"||o.messageType!=="NestedAppAuthResponse")return void n("Unrecognized data format received by app, message being ignored. Message: %o",e);const c=e.source||((r=e==null?void 0:e.originalEvent)===null||r===void 0?void 0:r.source),u=e.origin||((i=e==null?void 0:e.originalEvent)===null||i===void 0?void 0:i.origin);c?Xm(c,u)?(k.topWindow&&!k.topWindow.closed&&c!==k.topWindow||(k.topWindow=c,k.topOrigin=u),k.topWindow&&k.topWindow.closed&&(k.topWindow=null,k.topOrigin=null),vp(k.topWindow,k.topOrigin,x.topMessageQueue,"top"),t(a)):n("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):n("Message being ignored by app because it is coming for a target that is null")}const Pc=tr.extend("shouldProcessIncomingMessage");function Xm(e,t){return j(this,void 0,void 0,(function*(){if(k.currentWindow&&e===k.currentWindow)return Pc("Should not process message because it is coming from the current window"),!1;if(k.currentWindow&&k.currentWindow.location&&t&&t===k.currentWindow.location.origin)return!0;{let r;try{r=new URL(t)}catch{return Pc("Message has an invalid origin of %s",t),!1}const i=yield KA(r);return i||Pc("Message has an invalid origin of %s",t),i}}))}const og=tr.extend("handleIncomingMessageFromParent");function Qo(e,t){if(t){const r=[...e].find((([i,n])=>i.toString()===t.toString()));if(r)return r[0]}}function wc(e,t){const r=Qo(t,e.uuid);r&&t.delete(r),e.uuid?x.legacyMessageIdsToUuidMap={}:delete x.legacyMessageIdsToUuidMap[e.id]}function sg(e){const t=og,r=Ts();if("id"in e.data&&typeof e.data.id=="number"){const i=e.data,n=lA(i),s=(function(a){const o=og;if(!a.uuid)return x.legacyMessageIdsToUuidMap[a.id];{const c=a.uuid,u=Qo(x.callbacks,c);if(u)return u;const p=Qo(x.promiseCallbacks,c);if(p)return p;const d=Qo(x.portCallbacks,c);if(d)return d}o("Received message %s that failed to produce a callbackId",be(a))})(n);if(s){const a=x.callbacks.get(s);t("Received a response from parent for message %s",s.toString()),Co.handlePerformanceMetrics(s,n,t,r),a&&(t("Invoking the registered callback for message %s with arguments %o",s.toString(),n.args),a.apply(null,[...n.args,n.isPartialResponse]),(function(u){return u.data.isPartialResponse===!0})(e)||(t("Removing registered callback for message %s",s.toString()),wc(n,x.callbacks)));const o=x.promiseCallbacks.get(s);o&&(t("Invoking the registered promise callback for message %s with arguments %o",s.toString(),n.args),o(n.args),t("Removing registered promise callback for message %s",s.toString()),wc(n,x.promiseCallbacks));const c=x.portCallbacks.get(s);if(c){let u;t("Invoking the registered port callback for message %s with arguments %o",s.toString(),n.args),e.ports&&e.ports[0]instanceof MessagePort&&(u=e.ports[0]),c(u,n.args),t("Removing registered port callback for message %s",s.toString()),wc(n,x.portCallbacks)}n.uuid&&(x.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&typeof e.data.func=="string"){const i=e.data;Co.handleOneWayPerformanceMetrics(i,t,r),t('Received a message from parent %s, action: "%s"',be(i),i.func),HS(i.func,i.args)}else t("Received an unknown message: %O",e)}function Gc(){return k.topWindow!==k.parentWindow}function eS(e){return e===k.topWindow&&Gc()?x.topMessageQueue:e===k.parentWindow?x.parentMessageQueue:[]}function tS(e,t){let r;r=k.currentWindow.setInterval((()=>{eS(e).length===0&&(clearInterval(r),t())}),100)}const rS=ae("internal"),rT=rS.extend("ensureInitializeCalled"),nT=rS.extend("ensureInitialized");function ue(){if(!_.initializeCalled)throw rT(So),new Error(So)}function y(e,...t){if(!_.initializeCompleted)throw nT("%s. initializeCalled: %s",So,_.initializeCalled.toString()),new Error(So);if(t&&t.length>0){let r=!1;for(let i=0;i<t.length;i++)if(t[i]===_.frameContext){r=!0;break}if(!r)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${_.frameContext}".`)}return NA(e)}function Ie(e=os){const t=As(_.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function iT(){return _.hostClientType==z.android||_.hostClientType==z.ios||_.hostClientType==z.ipados||_.hostClientType==z.visionOS}function Yo(e=os){if(!iT())throw{errorCode:N.NOT_SUPPORTED_ON_PLATFORM};if(!Ie(e))throw{errorCode:N.OLD_PLATFORM}}function oT(e){let t=_.additionalValidOrigins.concat(e.filter((i=>typeof i=="string"&&OA.test(i))));const r={};t=t.filter((i=>!r[i]&&(r[i]=!0,!0))),_.additionalValidOrigins=t}function sT(e){if(!cT(e))throw new Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${nS}-${iS}).`)}function aT(e){if(dp(e))throw new Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(uT(e))throw new Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}const nS=4,iS=256;function cT(e){return e.length<iS&&e.length>nS}function uT(e){return[...e].some((t=>{const r=t.charCodeAt(0);return r<32||r>126}))}function oS(e){if(!(e instanceof _e))throw new Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}let sS=class{constructor(t){this.idAsString=t,aT(t)}serialize(){return this.toString()}toString(){return this.idAsString}},_e=class extends sS{constructor(t){super(t),sT(t)}toJSON(){return{appIdAsString:this.toString()}}};function G(e){return e==null}function pT(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");y(v),aI(e)}function dT(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");y(v),cI(e)}const lT=Object.freeze(Object.defineProperty({__proto__:null,registerBeforeSuspendOrTerminateHandler:pT,registerOnResumeHandler:dT},Symbol.toStringTag,{value:"Module"}));let uo;const hT=ae("messageChannels.telemetry");function vT(){return j(this,void 0,void 0,(function*(){if(uo)return hT("Returning telemetry port from cache"),uo;if(!aS())throw E;return uo=yield Ym(S("v1","messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),uo}))}function aS(){var e;return!(!y(v)||!(!((e=v.supports.messageChannels)===null||e===void 0)&&e.telemetry))}function cS(){uo=void 0}const fT=Object.freeze(Object.defineProperty({__proto__:null,_clearTelemetryPort:cS,getTelemetryPort:vT,isSupported:aS},Symbol.toStringTag,{value:"Module"}));let po;const gT=ae("messageChannels.dataLayer");function mT(){return j(this,void 0,void 0,(function*(){if(po)return gT("Returning dataLayer port from cache"),po;if(!uS())throw E;return po=yield Ym(S("v1","messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),po}))}function uS(){var e;return!(!y(v)||!(!((e=v.supports.messageChannels)===null||e===void 0)&&e.dataLayer))}function pS(){po=void 0}const ST=Object.freeze(Object.defineProperty({__proto__:null,_clearDataLayerPort:pS,getDataLayerPort:mT,isSupported:uS},Symbol.toStringTag,{value:"Module"})),at="v2",Rc=ae("app"),Ct={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};var ss,as;function CT(){return _.initializeCompleted}function yT(){return _.frameContext}function PT(e){return ks(S(at,"app.initialize"),e)}function wT(e){k.currentWindow=e}function RT(){_.initializeCalled&&(Yb(),_.initializeCalled=!1,_.initializeCompleted=!1,_.initializePromise=void 0,_.additionalValidOrigins=[],_.frameContext=void 0,_.hostClientType=void 0,_.isFramelessWindow=!1,cS(),pS(),JA())}function dS(){return new Promise((e=>{ue(),e(Je(S(at,"app.getContext"),"getContext"))})).then((e=>(function(t){var r;return{actionInfo:t.actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,messageId:t.messageId,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userClickTimeV2:t.userClickTimeV2,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:mo.teams,clientType:t.hostClientType?t.hostClientType:z.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId,ancestors:t.hostAncestors},appLaunchId:t.appLaunchId,appId:t.appId?new _e(t.appId):void 0,manifestVersion:t.manifestVersion},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:_.frameContext,renderingSurface:t.renderingSurface?t.renderingSurface:void 0,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,isBackgroundLoad:t.isBackgroundLoad,sourceOrigin:t.sourceOrigin},user:{id:(r=t.userObjectId)!==null&&r!==void 0?r:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0,dialogParameters:t.dialogParameters||{}}})(e)))}function ET(){ue(),TS(S(at,"app.notifyAppLoaded"))}function AT(){return gb(S(at,"app.notifySuccess"))}function TT(e){ue(),IS(S(at,"app.notifyFailure"),e)}function bT(e){ue(),bS(S(at,"app.notifyExpectedFailure"),e)}function IT(e){_S(S(at,"app.registerOnThemeChangeHandler"),e)}function _T(e){mb(S(at,"app.registerOnContextChangeHandler"),e)}function OT(e){rI(e)}function MT(e){return OS(S(at,"app.openLink"),e)}(function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"})(ss||(ss={})),(function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"})(as||(as={})),Rc("teamsjs instance is version %s, starting at %s UTC (%s local)",Zt,new Date().toISOString(),new Date().toLocaleString()),(function(){if(Ue())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,r="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&t.length!==0?Rc("teamsjs is being used from %s. %s",t,r):Rc("teamsjs is being used from a script tag embedded directly in your html. %s",r)})();const DT=Object.freeze(Object.defineProperty({__proto__:null,get ExpectedFailureReason(){return as},get FailedReason(){return ss},Messages:Ct,_initialize:wT,_uninitialize:RT,getContext:dS,getFrameContext:yT,initialize:PT,isInitialized:CT,lifecycle:lT,notifyAppLoaded:ET,notifyExpectedFailure:bT,notifyFailure:TT,notifySuccess:AT,openLink:MT,registerHostToAppPerformanceMetricsHandler:OT,registerOnContextChangeHandler:_T,registerOnThemeChangeHandler:IT},Symbol.toStringTag,{value:"Module"}));function kT(e){fS(S(Oe,"dialog.update.resize"),e)}function lS(){return!(!y(v)||!v.supports.dialog)&&!!v.supports.dialog.update}const NT=Object.freeze(Object.defineProperty({__proto__:null,isSupported:lS,resize:kT},Symbol.toStringTag,{value:"Module"}));function jT(e,t,r){mS(S(Oe,"dialog.url.bot.open"),e,t,r)}function hS(){return y(v)&&(v.supports.dialog&&v.supports.dialog.url&&v.supports.dialog.url.bot)!==void 0}const zT=Object.freeze(Object.defineProperty({__proto__:null,isSupported:hS,open:jT},Symbol.toStringTag,{value:"Module"}));function LT(e){if(y(v,C.task),!Ms())throw E;T(S(Oe,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function FT(e){if(y(v,C.content,C.sidePanel,C.meetingStage),!Ms())throw E;T(S(Oe,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function qT(e){if(y(v,C.task),!Ms())throw E;for(pe("messageForChild"),B(S(Oe,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),Zo.reverse();Zo.length>0;)e(Zo.pop())}function Ms(){var e,t;return y(v)&&!!(!((t=(e=v.supports.dialog)===null||e===void 0?void 0:e.url)===null||t===void 0)&&t.parentCommunication)}const BT=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Ms,registerOnMessageFromParent:qT,sendMessageToDialog:FT,sendMessageToParentFromDialog:LT},Symbol.toStringTag,{value:"Module"}));function UT(e,t,r){gS(S(Oe,"dialog.url.open"),e,t,r)}function xT(e,t){SS(S(Oe,"dialog.url.submit"),e,t)}function mp(){return y(v)&&(v.supports.dialog&&v.supports.dialog.url)!==void 0}function Sp(e){return{url:e.url,height:e.size?e.size.height:ge.Small,width:e.size?e.size.width:ge.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function vS(e){const t=Sp(e);return t.completionBotId=e.completionBotId,t}const HT=Object.freeze(Object.defineProperty({__proto__:null,bot:zT,getDialogInfoFromBotUrlDialogInfo:vS,getDialogInfoFromUrlDialogInfo:Sp,isSupported:mp,open:UT,parentCommunication:BT,submit:xT},Symbol.toStringTag,{value:"Module"})),Oe="v2";function fS(e,t){if(y(v,C.content,C.sidePanel,C.task,C.meetingStage),!lS())throw E;T(e,"tasks.updateTask",[t])}function gS(e,t,r,i){if(y(v,C.content,C.sidePanel,C.meetingStage),!mp())throw E;i&&B(S(Oe,"dialog.url.registerMessageForParentHandler"),"messageForParent",i);const n=Sp(t);T(e,"tasks.startTask",[n],((s,a)=>{r==null||r({err:s,result:a}),pe("messageForParent")}))}function mS(e,t,r,i){if(y(v,C.content,C.sidePanel,C.meetingStage),!hS())throw E;i&&B(S(Oe,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",i);const n=vS(t);T(e,"tasks.startTask",[n],((s,a)=>{r==null||r({err:s,result:a}),pe("messageForParent")}))}function SS(e,t,r){if(y(v,C.content,C.task),!mp())throw E;_.frameContext===C.content&&console.warn(`dialog.submit should not be called from FrameContext.content.
If dialog.submit was called from inside the dialog, please disregard this message.
This issue occurs due to a bug in Teams mobile where the dialog is incorrectly identified as being in the content FrameContext.
We are working to resolve this.`),T(e,"tasks.completeTask",[t,r?Array.isArray(r)?r:[r]:[]])}function CS(e){return{card:e.card,height:e.size?e.size.height:ge.Small,width:e.size?e.size.width:ge.Small,title:e.title}}function $T(e){const t=CS(e);return t.completionBotId=e.completionBotId,t}const Zo=[];function WT(e){_.frameContext&&(_.frameContext===C.task?Zo.push(e):pe("messageForChild"))}function VT(e,t){if(y(v,C.content,C.sidePanel,C.meetingStage),!yS())throw E;const r=$T(e);T(S(Oe,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[r],((i,n)=>{t==null||t({err:i,result:n})}))}function yS(){const e=v.hostVersionsInfo&&v.hostVersionsInfo.adaptiveCardSchemaVersion&&!Lm(v.hostVersionsInfo.adaptiveCardSchemaVersion);return y(v)&&(e&&v.supports.dialog&&v.supports.dialog.card&&v.supports.dialog.card.bot)!==void 0}const KT=Object.freeze(Object.defineProperty({__proto__:null,isSupported:yS,open:VT},Symbol.toStringTag,{value:"Module"}));function GT(e,t){if(y(v,C.content,C.sidePanel,C.meetingStage),!PS())throw E;const r=CS(e);T(S(Oe,"dialog.adaptiveCard.open"),"tasks.startTask",[r],((i,n)=>{t==null||t({err:i,result:n})}))}function PS(){const e=v.hostVersionsInfo&&v.hostVersionsInfo.adaptiveCardSchemaVersion&&!Lm(v.hostVersionsInfo.adaptiveCardSchemaVersion);return y(v)&&(e&&v.supports.dialog&&v.supports.dialog.card)!==void 0}const JT=Object.freeze(Object.defineProperty({__proto__:null,bot:KT,isSupported:PS,open:GT},Symbol.toStringTag,{value:"Module"}));function wS(){B(S(Oe,"dialog.registerMessageForChildHandler"),"messageForChild",WT,!1)}function QT(){return!(!y(v)||!v.supports.dialog)}const YT=Object.freeze(Object.defineProperty({__proto__:null,adaptiveCard:JT,initialize:wS,isSupported:QT,update:NT,url:HT},Symbol.toStringTag,{value:"Module"})),it="v2";var Jc,Qc;(function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"})(Jc||(Jc={}));let ZT=class{constructor(){this.enabled=!0,this.selected=!1}},Yc,Zc,Xc;function RS(){B(S(it,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",rb,!1),B(S(it,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",ib,!1),B(S(it,"menus.registerSetModuleViewHandler"),"setModuleView",eb,!1)}function XT(e,t){if(y(v),!Ds())throw E;Xc=t,T(S(it,"menus.setUpViews"),"setUpViews",[e])}function eb(e){Xc&&Xc(e)||(y(v),T(S(it,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function tb(e,t){if(y(v),!Ds())throw E;Yc=t,T(S(it,"menus.setNavBarMenu"),"setNavBarMenu",[e])}function rb(e){Yc&&Yc(e)||(y(v),T(S(it,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function nb(e,t){if(y(v),!Ds())throw E;Zc=t,T(S(it,"menus.showActionMenu"),"showActionMenu",[e])}function ib(e){Zc&&Zc(e)||(y(v),T(S(it,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function Ds(){return!(!y(v)||!v.supports.menus)}(function(e){e.dropDown="dropDown",e.popOver="popOver"})(Qc||(Qc={}));const ob=Object.freeze(Object.defineProperty({__proto__:null,get DisplayMode(){return Jc},MenuItem:ZT,get MenuListType(){return Qc},initialize:RS,isSupported:Ds,setNavBarMenu:tb,setUpViews:XT,showActionMenu:nb},Symbol.toStringTag,{value:"Module"}));let Me=class{},Cp=class extends Me{validate(t){return!0}deserialize(t){return t}},eu,tu;function ES(){B(S(V,"pages.config.registerSettingsSaveHandler"),"settings.save",pb,!1),B(S(V,"pages.config.registerSettingsRemoveHandler"),"settings.remove",hb,!1)}function sb(e){return qS(S(V,"pages.config.setValidityState"),e)}function ab(e){return US(S(V,"pages.config.setConfig"),e)}function cb(e){yp(S(V,"pages.config.registerOnSaveHandler"),e,(()=>{if(!G(e)&&!vr())throw E}))}function yp(e,t,r){!G(t)&&y(v,C.settings),r&&r(),eu=t,!G(t)&&T(e,"registerHandler",["save"])}function ub(e){Pp(S(V,"pages.config.registerOnRemoveHandler"),e,(()=>{if(!G(e)&&!vr())throw E}))}function Pp(e,t,r){!G(t)&&y(v,C.remove,C.settings),r&&r(),tu=t,!G(t)&&T(e,"registerHandler",["remove"])}function pb(e){const t=new lb(e);eu?eu(t):Fe()?qe("settings.save",[e]):t.notifySuccess()}function db(e){Ce(S(V,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[C.content],(()=>{if(!vr())throw E}))}let lb=class{constructor(t){this.notified=!1,this.result=t||{}}notifySuccess(){this.ensureNotNotified(),T(S(V,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(t){this.ensureNotNotified(),T(S(V,"pages.saveEvent.notifyFailure"),"settings.save.failure",[t]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}};function hb(){const e=new vb;tu?tu(e):Fe()?qe("settings.remove",[]):e.notifySuccess()}let vb=class{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),T(S(V,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(t){this.ensureNotNotified(),T(S(V,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[t]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}};function vr(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.config}const fb=Object.freeze(Object.defineProperty({__proto__:null,initialize:ES,isSupported:vr,registerChangeConfigHandler:db,registerOnRemoveHandler:ub,registerOnRemoveHandlerHelper:Pp,registerOnSaveHandler:cb,registerOnSaveHandlerHelper:yp,setConfig:ab,setValidityState:sb},Symbol.toStringTag,{value:"Module"})),AS=ae("app");function ks(e,t){return Ue()?(AS.extend("initialize")("window object undefined at initialization"),Promise.resolve()):nA((()=>(function(r,i){return new Promise((n=>{_.initializeCalled||(_.initializeCalled=!0,Qb(),_.initializePromise=GA(i,r).then((({context:s,clientType:a,runtimeConfig:o,clientSupportedSDKVersion:c=os})=>{_.frameContext=s,_.hostClientType=a,_.clientSupportedSDKVersion=c;try{so("Parsing %s",o);let u=JSON.parse(o);if(so("Checking if %o is a valid runtime object",u??"null"),!u||!u.apiVersion)throw new Error("Received runtime config is invalid");u=Yf(u),o&&yc(u)}catch(u){if(!(u instanceof SyntaxError))throw u;try{so("Attempting to parse %s as an SDK version",o),isNaN(As(o,os))||(_.clientSupportedSDKVersion=o);let p=JSON.parse(c);if(so("givenRuntimeConfig parsed to %o",p??"null"),!p)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");p=Yf(p),yc(p)}catch(p){if(!(p instanceof SyntaxError))throw p;yc(UA(_.clientSupportedSDKVersion,jA,BA))}}_.initializeCompleted=!0})),RS(),ES(),wS()),Array.isArray(i)&&oT(i),_.initializePromise!==void 0?n(_.initializePromise):so("GlobalVars.initializePromise is unexpectedly undefined")}))})(e,t)),6e4,new Error("SDK initialization timed out."))}function TS(e){T(e,Ct.AppLoaded,[Zt])}function bS(e,t){T(e,Ct.ExpectedFailure,[t.reason,t.message])}function IS(e,t){T(e,Ct.Failure,[t.reason,t.message])}function gb(e){return j(this,void 0,void 0,(function*(){if(_.initializeCompleted)return ag(e);if(!_.initializePromise)throw new Error(So);return _.initializePromise.then((()=>ag(e)))}))}function ag(e){return j(this,void 0,void 0,(function*(){return y(v)&&(!((t=v.supports.app)===null||t===void 0)&&t.notifySuccessResponse)?ce(Ct.Success,[Zt],new Cp,e).then((()=>({hasFinishedSuccessfully:!0}))):(T(e,Ct.Success,[Zt]),{hasFinishedSuccessfully:"unknown"});var t}))}const so=AS.extend("initializeHelper");function _S(e,t){!G(t)&&ue(),Zb(e,t)}function mb(e,t){!G(t)&&ue(),Xb(e,t)}function OS(e,t){return new Promise((r=>{y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage),r(de(e,"executeDeepLink",t))}))}function Sb(e){Ce(S(V,"pages.appButton.onClick"),"appButtonClick",e,[C.content],(()=>{if(!Ns())throw E}))}function Cb(e){Ce(S(V,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[C.content],(()=>{if(!Ns())throw E}))}function yb(e){Ce(S(V,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[C.content],(()=>{if(!Ns())throw E}))}function Ns(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.appButton}const Pb=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Ns,onClick:Sb,onHoverEnter:Cb,onHoverLeave:yb},Symbol.toStringTag,{value:"Module"}));function wb(){xS()}function MS(){return NS(S(V,"pages.backStack.navigateBack"))}function Rb(e){wp(S(V,"pages.backStack.registerBackButtonHandler"),e,(()=>{if(!G(e)&&!Rp())throw E}))}function wp(e,t,r){!G(t)&&y(v),r&&r(),Kb(t),!G(t)&&T(e,"registerHandler",["backButton"])}function Rp(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.backStack}const Eb=Object.freeze(Object.defineProperty({__proto__:null,_initialize:wb,isSupported:Rp,navigateBack:MS,registerBackButtonHandler:Rb,registerBackButtonHandlerHelper:wp},Symbol.toStringTag,{value:"Module"}));function Ab(e){return new Promise((t=>{if(y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage),!Ep())throw E;t(U(S(V,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))}))}function Tb(){return new Promise((e=>{if(y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage),!Ep())throw E;e(U(S(V,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))}))}function Ep(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.currentApp}const bb=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Ep,navigateTo:Ab,navigateToDefaultPage:Tb},Symbol.toStringTag,{value:"Module"}));function Ib(){if(y(v,C.content),!Ap())throw E;T(S(V,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function _b(){if(y(v,C.content),!Ap())throw E;T(S(V,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function Ap(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.fullTrust}const Ob=Object.freeze(Object.defineProperty({__proto__:null,enterFullscreen:Ib,exitFullscreen:_b,isSupported:Ap},Symbol.toStringTag,{value:"Module"}));function Mb(e){return jS(S(V,"pages.tabs.navigateToTab"),e)}function Db(e){return zS(S(V,"pages.tabs.getTabInstances"),e)}function kb(e){return LS(S(V,"pages.tabs.getMruTabInstances"),e)}function js(){return!(!y(v)||!v.supports.pages)&&!!v.supports.pages.tabs}const Nb=Object.freeze(Object.defineProperty({__proto__:null,getMruTabInstances:kb,getTabInstances:Db,isSupported:js,navigateToTab:Mb},Symbol.toStringTag,{value:"Module"}));var ru,sr;function jb(e){const t=S(V,"pages.returnFocus");if(y(v),!Qe())throw E;if(e===void 0&&T(t,"returnFocus",[!1]),typeof e=="boolean")T(t,"returnFocus",[e]);else switch(e){case sr.PreviousLandmark:case sr.GoToActivityFeed:T(t,"returnFocus",[!1,e]);break;case sr.NextLandmark:T(t,"returnFocus",[!0,e])}}function zb(e){Ce(S(V,"pages.registerFocusEnterHandler"),"focusEnter",e,[],(()=>{if(!Qe())throw E}))}function DS(e){Tp(S(V,"pages.setCurrentFrame"),e)}function Lb(e,t,r){Km(),ks(S(V,"pages.initializeWithFrameContext"),r).then((()=>t&&t())),DS(e)}function Fb(){return BS(S(V,"pages.getConfig."))}function qb(e){return kS(S(V,"pages.navigateCrossDomain"),e)}function Bb(e){return new Promise((t=>{if(y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage),!Qe())throw E;const r=S(V,"pages.navigateToApp");if(v.isLegacyTeams){const i=cg(e)?e:Wb(e);t(de(r,"executeDeepLink",iA(i)))}else{const i=cg(e)?Vb(e):e;t(de(r,"pages.navigateToApp",i))}}))}function Ub(e){return FS(S(V,"pages.shareDeepLink"),e)}function xb(e){Ce(S(V,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],(()=>{if(!G(e)&&!Qe())throw E}))}function Qe(){return!(!y(v)||!v.supports.pages)}(function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"})(ru||(ru={})),(function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"})(sr||(sr={}));const Hb=Object.freeze(Object.defineProperty({__proto__:null,get EnterFocusType(){return ru},get ReturnFocusType(){return sr},appButton:Pb,backStack:Eb,config:fb,currentApp:bb,fullTrust:Ob,getConfig:Fb,initializeWithFrameContext:Lb,isSupported:Qe,navigateCrossDomain:qb,navigateToApp:Bb,registerFocusEnterHandler:zb,registerFullScreenHandler:xb,returnFocus:jb,setCurrentFrame:DS,shareDeepLink:Ub,tabs:Nb},Symbol.toStringTag,{value:"Module"})),V="v2";function kS(e,t){return new Promise((r=>{if(y(v,C.content,C.sidePanel,C.settings,C.remove,C.task,C.stage,C.meetingStage),!Qe())throw E;r(gp(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function NS(e){return new Promise((t=>{if(y(v),!Rp())throw E;t(gp(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function jS(e,t){return new Promise((r=>{if(y(v),!js())throw E;r(gp(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function $b(e,t){if(y(v),!Qe())throw E;T(e,"returnFocus",[t])}function zS(e,t){return new Promise((r=>{if(y(v),!js())throw E;r(Je(e,"getTabInstances",t))}))}function LS(e,t){return new Promise((r=>{if(y(v),!js())throw E;r(Je(e,"getMruTabInstances",t))}))}function FS(e,t){if(y(v,C.content,C.sidePanel,C.meetingStage),!Qe())throw E;T(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function Tp(e,t){if(y(v,C.content),!Qe())throw E;T(e,"setFrameContext",[t])}function qS(e,t){if(y(v,C.settings,C.remove),!vr())throw E;T(e,"settings.setValidityState",[t])}function BS(e){return new Promise((t=>{if(y(v,C.content,C.settings,C.remove,C.sidePanel),!Qe())throw E;t(Je(e,"settings.getSettings"))}))}function US(e,t){return new Promise((r=>{if(y(v,C.content,C.settings,C.sidePanel),!vr())throw E;r(de(e,"settings.setSettings",t))}))}function cg(e){return e.appId instanceof _e}function Wb(e){return Object.assign(Object.assign({},e),{appId:new _e(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function Vb(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}let nu;function Kb(e){nu=e}function xS(){B(S("v2","pages.backStack.registerBackButtonPressHandler"),"backButtonPress",Gb,!1)}function Gb(){nu&&nu()||(Fe()?qe("backButtonPress",[]):MS())}const Jb=ae("handlers");let W=class je{static initializeHandlers(){je.handlers.themeChange=eI,je.handlers.contextChange=tI,je.handlers.load=iI,je.handlers.beforeUnload=sI,xS()}static uninitializeHandlers(){je.handlers={},je.themeChangeHandler=null,je.beforeUnloadHandler=null,je.beforeSuspendOrTerminateHandler=null,je.resumeHandler=null,je.contextChangeHandler=null}};function Qb(){W.initializeHandlers()}function Yb(){W.uninitializeHandlers()}W.handlers={},W.themeChangeHandler=null,W.loadHandler=null,W.beforeUnloadHandler=null,W.beforeSuspendOrTerminateHandler=null,W.resumeHandler=null,W.hostToAppPerformanceMetricsHandler=null,W.contextChangeHandler=null;const ug=Jb.extend("callHandler");function HS(e,t){const r=W.handlers[e];return r?(ug("Invoking the registered handler for message %s with arguments %o",e,t),[!0,r.apply(this,t)]):Fe()?(qe(e,t),[!1,void 0]):(ug("Handler for action message %s not found.",e),[!1,void 0])}function B(e,t,r,i=!0,n=[]){r?(W.handlers[t]=r,i&&T(e,"registerHandler",[t,...n])):delete W.handlers[t]}function pe(e){delete W.handlers[e]}function pg(e){return W.handlers[e]!=null}function Ce(e,t,r,i,n){r&&y(v,...i),n&&n(),B(e,t,r)}function Zb(e,t){W.themeChangeHandler=t,!G(t)&&T(e,"registerHandler",["themeChange"])}function Xb(e,t){W.contextChangeHandler=t,!G(t)&&T(e,"registerHandler",["contextChange"])}function eI(e){W.themeChangeHandler&&W.themeChangeHandler(e),Fe()&&qe("themeChange",[e])}function tI(e){W.contextChangeHandler&&W.contextChangeHandler(e),Fe()&&qe("contextChange",[e])}function rI(e){W.hostToAppPerformanceMetricsHandler=e}function dg(e){W.hostToAppPerformanceMetricsHandler&&W.hostToAppPerformanceMetricsHandler(e)}function nI(e,t){W.loadHandler=t,!G(t)&&T(e,"registerHandler",["load"])}function iI(e){const t={entityId:(r=e).entityId,contentUrl:new URL(r.contentUrl)};var r;W.resumeHandler?(W.resumeHandler(t),Fe()&&qe("load",[t])):W.loadHandler&&(W.loadHandler(e),Fe()&&qe("load",[e]))}function oI(e,t){W.beforeUnloadHandler=t,!G(t)&&T(e,"registerHandler",["beforeUnload"])}function sI(){return j(this,void 0,void 0,(function*(){const e=()=>{T(S("v2","handleBeforeUnload"),"readyToUnload",[])};W.beforeSuspendOrTerminateHandler?(yield W.beforeSuspendOrTerminateHandler(),Fe()?qe("beforeUnload"):e()):W.beforeUnloadHandler&&W.beforeUnloadHandler(e)||(Fe()?qe("beforeUnload"):e())}))}function aI(e){W.beforeSuspendOrTerminateHandler=e,!G(e)&&T(S("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function cI(e){W.resumeHandler=e,!G(e)&&T(S("v2","registerOnResumeHandler"),"registerHandler",["load"])}const uI=ae("childProxyingCommunication");let J=class{};function pI(){J.window=null,J.origin=null,J.messageQueue=[]}function Fe(){return!!wm()&&!!J.window}function dI(e,t){return!!wm()&&(J.window&&!J.window.closed&&e!==J.window||(J.window=e,J.origin=t),J.window&&J.window.closed?(J.window=null,J.origin=null,!1):J.window===e)}function lI(e,t,r,i){return j(this,void 0,void 0,(function*(){J.window===t&&(vp(J.window,J.origin,J.messageQueue,"child"),(function(n,s,a){if(n.data.id===void 0||n.data.func===void 0)return;const o=dA(n.data),[c,u]=HS(o.func,o.args);if(c&&u!==void 0)return lo("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",be(o),o.func),void lg(o.id,o.uuid,Array.isArray(u)?u:[u]);lo("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",be(o),o.func),(function(p,d,h){const l=d(S("v2","tasks.startTask"),p.func,p.args,!0,p.teamsJsInstanceId),f=J.origin;h(l.uuid,((...m)=>{if(!J.window)return;if(!sp().disableEnforceOriginMatchForChildResponses&&f!==J.origin)return void lo("Origin of child window has changed, not sending response back to child window");const P=m.pop();lo("Message from parent being relayed to child, id: %s",be(p)),lg(p.id,p.uuid,m,P)}))})(o,s,a)})(e,r,i))}))}J.messageQueue=[];const lo=uI.extend("handleIncomingMessageFromChild");function lg(e,t,r,i){const n=J.window,s=(function(c,u,p,d){return{id:c,uuid:u,args:p||[],isPartialResponse:d}})(e,t,r,i),a=hA(s),o=J.origin;n&&o&&(lo("Sending message %s to %s via postMessage, args = %o",be(a),"child",a.args),n.postMessage(a,o))}function qe(e,t){const r=J.window,i=(function(s,a){return{func:s,args:a||[]}})(e,t),n=J.origin;r&&n?r.postMessage(i,n):J.messageQueue.push(i)}const Oo="v1";function hI(e,t){y(v),T(S(Oo,"uploadCustomApp"),"uploadCustomApp",[e],t||Rt())}function vI(e,t,r){y(v),T(S(Oo,"sendCustomMessage"),e,t,r)}function fI(e,t){if(y(v),!Fe())throw new Error("The child window has not yet been initialized or is not present");qe(e,t)}function gI(e,t){y(v),B(S(Oo,"registerCustomHandler"),e,((...r)=>t.apply(this,r)))}function mI(e,t){y(v),B(S(Oo,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function SI(e){y(v,C.content,C.sidePanel,C.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];T(S(Oo,"openFilePreview"),"openFilePreview",t)}const At="v2";let bp=class{constructor(t){this.invokeRequest=t}serialize(){return this.invokeRequest}};function $S(e){const t=e;return t.responseType===cs.ActionExecuteInvokeResponse&&t.value!==void 0&&t.statusCode!==void 0&&t.type!==void 0}const iu="Action.Execute";var yo,cs,pr,Po;(function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"})(yo||(yo={})),(function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"})(cs||(cs={}));let Ip=class extends Me{validate(t){return $S(t)}deserialize(t){return t}};function Tt(e){if(typeof e!="object"||e===null)return!1;const t=e;return Object.values(pr).includes(t.errorCode)&&(t.message===void 0||typeof t.message=="string")}function WS(e){e.requestType===yo.ActionExecuteInvokeRequest?zs(e):e.requestType===yo.QueryMessageExtensionRequest&&(function(t){if(t.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(t.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const r of t.parameters){if(r.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(r.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}})(e)}function zs(e){if(e.type!==iu)throw{errorCode:pr.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${iu}"`};if(!Vc(e.data))throw{errorCode:pr.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}function CI(e,t,r){if(y(v,C.content),!ct())throw E;const i=new _e(e);return WS(r),re(S(At,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[i.toString(),r,t.url.href,t.width,t.height,t.isExternal]).then((([n,s])=>{if(n&&s.responseType!=null)return s;throw s}))}function yI(e,t){if(y(v,C.content),!ct())throw E;const r=new _e(e);return re(S(At,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[r.toString(),t.claims,t.silent]).then((([i,n])=>{if(!i)throw n}))}function PI(e,t,r){if(y(v,C.content),!ct())throw E;const i=new _e(e);return WS(r),re(S(At,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[i.toString(),r,t.claims,t.silent]).then((([n,s])=>{if(n&&s.responseType!=null)return s;throw s}))}function wI(e,t,r){if(y(v,C.content),!ct())throw E;return Ke(e,new Error("titleId is Invalid.")),Ke(t,new Error("oauthConfigId is Invalid.")),re(S(At,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,r.width,r.height,r.isExternal]).then((([i,n])=>{if(!i)throw n}))}function RI(e,t,r){if(y(v,C.content),!ct())throw E;return Ke(e,new Error("titleId is Invalid.")),t&&Fm(t),re(S(At,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,t==null?void 0:t.toString(),r==null?void 0:r.width,r==null?void 0:r.height,r==null?void 0:r.isExternal]).then((([i,n])=>{if(!i)throw n}))}(function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"})(pr||(pr={}));let Ls=class{constructor(t){this.param=t}serialize(){var t,r,i;return{connectorId:this.param.connectorId,oAuthConfigId:this.param.oAuthConfigId,traceId:(i=(r=(t=this.param.traceId)===null||t===void 0?void 0:t.toString)===null||r===void 0?void 0:r.call(t))!==null&&i!==void 0?i:this.param.traceId,windowParameters:this.param.windowParameters?Object.assign({},this.param.windowParameters):void 0}}};function EI(e){if(y(v,C.content),!ct())throw E;return Ke(e.connectorId,new Error("connectorId is Invalid.")),Ke(e.oAuthConfigId,new Error("oauthConfigId is Invalid.")),ne("externalAppAuthentication.authenticateWithConnector",[new Ls(e)],S(At,"externalAppAuthentication.authenticateWithConnector"),Tt)}(function(e){e.Invalid="Invalid",e.Valid="Valid",e.Expired="Expired"})(Po||(Po={}));let AI=class extends Me{validate(t){return typeof t=="string"&&t in Po}deserialize(t){return t}};function TI(e){if(y(v,C.content),!ct())throw E;return Ke(e.connectorId,new Error("connectorId is Invalid.")),Ke(e.oAuthConfigId,new Error("oAuthConfigId is Invalid.")),ce("externalAppAuthentication.getUserAuthenticationStateForConnector",[new Ls(e)],new AI,S(At,"externalAppAuthentication.getUserAuthenticationStateForConnector"),Tt)}function bI(e){if(y(v,C.content),!ct())throw E;return Ke(e.connectorId,new Error("connectorId is Invalid.")),Ke(e.oAuthConfigId,new Error("oauthConfigId is Invalid.")),ne("externalAppAuthentication.disconnectConnector",[new Ls(e)],S(At,"externalAppAuthentication.disconnectConnector"),Tt)}function ct(){return!(!y(v)||!v.supports.externalAppAuthentication)}const II=Object.freeze(Object.defineProperty({__proto__:null,ActionExecuteInvokeRequestType:iu,ActionExecuteResponseHandler:Ip,get InvokeErrorCode(){return pr},get InvokeResponseType(){return cs},get OriginalRequestType(){return yo},SerializableActionExecuteInvokeRequest:bp,SerializableConnectorParameters:Ls,get UserAuthenticationState(){return Po},authenticateAndResendRequest:CI,authenticateWithConnector:EI,authenticateWithOauth2:wI,authenticateWithPowerPlatformConnectorPlugins:RI,authenticateWithSSO:yI,authenticateWithSSOAndResendRequest:PI,disconnectConnector:bI,getUserAuthenticationStateForConnector:TI,isActionExecuteResponse:$S,isInvokeError:Tt,isSupported:ct,validateActionExecuteInvokeRequest:zs},Symbol.toStringTag,{value:"Module"}));function _I(e){if(!G(e)&&y(v),!G(e)&&!VS())throw E;e?B(S("v1","log.request"),"log.request",(()=>{const t=e();T(S("v1","log.receive"),"log.receive",[t])})):pe("log.request")}function VS(){return!(!y(v)||!v.supports.logs)}const OI=Object.freeze(Object.defineProperty({__proto__:null,isSupported:VS,registerGetLogHandler:_I},Symbol.toStringTag,{value:"Module"})),ho="v1";function MI(e){return new Promise((t=>{if(y(v,C.content),!Fs())throw E;const r=de(S(ho,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&B(S(ho,"conversations.registerStartConversationHandler"),"startConversation",((i,n,s,a)=>{var o;return(o=e.onStartConversation)===null||o===void 0?void 0:o.call(e,{subEntityId:i,conversationId:n,channelId:s,entityId:a})})),e.onCloseConversation&&B(S(ho,"conversations.registerCloseConversationHandler"),"closeConversation",((i,n,s,a)=>{var o;return(o=e.onCloseConversation)===null||o===void 0?void 0:o.call(e,{subEntityId:i,conversationId:n,channelId:s,entityId:a})})),t(r)}))}function DI(){if(y(v,C.content),!Fs())throw E;T(S(ho,"conversations.closeConversation"),"conversations.closeConversation"),pe("startConversation"),pe("closeConversation")}function kI(){return new Promise((e=>{if(y(v),!Fs())throw E;e(Je(S(ho,"conversations.getChatMember"),"getChatMembers"))}))}function Fs(){return!(!y(v)||!v.supports.conversations)}const NI=Object.freeze(Object.defineProperty({__proto__:null,closeConversation:DI,getChatMembers:kI,isSupported:Fs,openConversation:MI},Symbol.toStringTag,{value:"Module"})),jI=ae("copilot");function zI(){var e;return y(v)&&!!(!((e=v.supports.copilot)===null||e===void 0)&&e.customTelemetry)}function LI(e,t){var r;return t===void 0&&(t=(r=Ts())!==null&&r!==void 0?r:Date.now()),j(this,void 0,void 0,(function*(){return y(v),jI("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),ne("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],S("v2","copilot.customTelemetry.sendCustomTelemetryData"))}))}const FI=Object.freeze(Object.defineProperty({__proto__:null,isSupported:zI,sendCustomTelemetryData:LI},Symbol.toStringTag,{value:"Module"})),hg=ae("copilot");function KS(){var e,t;return y(v)&&(!!(!((e=v.hostVersionsInfo)===null||e===void 0)&&e.appEligibilityInformation)||!!(!((t=v.supports.copilot)===null||t===void 0)&&t.eligibility))}function qI(e){var t,r,i;return j(this,void 0,void 0,(function*(){if(y(v),!KS())throw new Error(`Error code: ${E.errorCode}, message: Not supported on platform`);if(!((t=v.hostVersionsInfo)===null||t===void 0)&&t.appEligibilityInformation&&!e)return hg("Eligibility information is already available on runtime."),v.hostVersionsInfo.appEligibilityInformation;hg("Eligibility information is not available on runtime. Requesting from host.");const n=yield Je(S("v2","copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo",e);if(hr(n))throw new Error(`Error code: ${n.errorCode}, message: ${(r=n.message)!==null&&r!==void 0?r:"Failed to get eligibility information from the host."}`);if(!(function(s){return!(s.ageGroup===void 0||s.cohort===void 0||s.userClassification===void 0||s.isCopilotEligible===void 0||s.isCopilotEnabledRegion===void 0||s.isOptedOutByAdmin===void 0||s.featureSet&&(s.featureSet.serverFeatures===void 0||s.featureSet.uxFeatures===void 0))})(n))throw new Error("Error deserializing eligibility information");return((i=n.ageGroup)===null||i===void 0?void 0:i.toLowerCase())==="nonadult"&&(n.ageGroup=ns.NotAdult),n}))}const BI=Object.freeze(Object.defineProperty({__proto__:null,getEligibilityInfo:qI,isSupported:KS},Symbol.toStringTag,{value:"Module"}));var ou,su,au,cu,uu,pu,du,lu,wo;(function(e){e.EMAIL="email",e.TEXT="text",e.MEDIA="media",e.CALENDAR_INVITE="calendarInvite",e.WEB_PAGE="webPage",e.MIXED="mixed",e.TEAMS="teams",e.FILE="file"})(ou||(ou={})),(function(e){e.IMAGE="image",e.AUDIO="audio",e.VIDEO="video"})(su||(su={})),(function(e){e.Private="Private",e.Shared="Shared",e.Recap="Recap",e.RecapCall="RecapCall",e.PrivateViewCall="PrivateViewCall",e.Chat="Chat",e.Compose="Compose"})(au||(au={})),(function(e){e.ClientDeviceType="ClientDeviceType",e.ClientRing="ClientRing",e.ClientScenarioName="ClientScenarioName"})(cu||(cu={})),(function(e){e.Enabled="enabled",e.Disabled="disabled",e.EnabledWithTranscript="enabledWithTranscript"})(uu||(uu={})),(function(e){e.NotStarted="notStarted",e.Active="active",e.Inactive="inactive",e.UnknownFutureValue="unknownFutureValue"})(pu||(pu={})),(function(e){e.Chat="Chat",e.Channel="Channel",e.Meeting="Meeting",e.MeetingChat="MeetingChat"})(du||(du={})),(function(e){e.Accepted="accepted",e.NotAccepted="not_accepted"})(lu||(lu={})),(function(e){e.ConsentNotAccepted="consent_not_accepted",e.PageContentBlockedPolicy="page_content_blocked_policy",e.PageContentBlockedDlp="page_content_blocked_dlp",e.PageContentTypeNotSupportedYet="page_content_type_not_supported_yet",e.PageContentSizeNotSupported="page_content_size_not_supported",e.PageContextChanged="page_context_changed",e.PageContentExtractionFailed="page_content_extraction_failed",e.PageContentSizeNotSupportedPDF="page_content_size_not_supported_pdf",e.NotSupportedOnPlatform="not_supported_on_platform",e.OtherError="other_error"})(wo||(wo={}));let GS=class extends Error{constructor(t,r){super(r),this.errorCode=t,this.name="SidePanelError"}};const UI=Object.freeze(Object.defineProperty({__proto__:null,get ContentItemType(){return ou},get CopilotMode(){return uu},get MediaSelectionType(){return su},get SidePanelErrorCode(){return wo},SidePanelErrorImpl:GS,get TeamsContextType(){return du},get TeamsDimensionName(){return cu},get TeamsSessionType(){return au},get TranscriptState(){return pu},get UserConsent(){return lu}},Symbol.toStringTag,{value:"Module"})),_p="v2";function JS(){var e;return y(v)&&!!(!((e=v.supports.copilot)===null||e===void 0)&&e.sidePanel)}function Op(e){if(typeof e!="object"||e===null)return!1;const t=e;return Object.values(wo).includes(t.errorCode)&&(t.message===void 0||typeof t.message=="string")||hr(e)}function xI(e){return j(this,void 0,void 0,(function*(){y(v);const t=e?[new KI(e)]:[];return ce("copilot.sidePanel.getContent",t,new WI,S(_p,"copilot.sidePanel.getContent"),Op)}))}function HI(e){return j(this,void 0,void 0,(function*(){y(v);const t=e?[new GI(e)]:[];return ce("copilot.sidePanel.preCheckUserConsent",t,new VI,S(_p,"copilot.sidePanel.preCheckUserConsent"),Op)}))}function $I(e){Ce(S(_p,"copilot.sidePanel.registerUserActionContentSelect"),"copilot.sidePanel.userActionContentSelect",e,[C.content],(()=>{if(!JS())throw QS}))}const QS=new GS(wo.NotSupportedOnPlatform,"This API is not supported on the current platform.");let WI=class extends Me{validate(t){return t!==null&&typeof t=="object"}deserialize(t){return t}},VI=class extends Me{validate(t){return t!==null&&typeof t=="object"}deserialize(t){return t}},KI=class{constructor(t){this.contentRequest=t}serialize(){return this.contentRequest}},GI=class{constructor(t){this.userConsentRequest=t}serialize(){return this.userConsentRequest}};const JI=Object.freeze(Object.defineProperty({__proto__:null,copilotSidePanelNotSupportedOnPlatformError:QS,getContent:xI,isResponseAReportableError:Op,isSupported:JS,preCheckUserConsent:HI,registerUserActionContentSelect:$I},Symbol.toStringTag,{value:"Module"}));function QI(){var e;return y(v)&&!!(!((e=v.supports.copilot)===null||e===void 0)&&e.view)}function YI(){return j(this,void 0,void 0,(function*(){y(v),yield ce("copilot.view.closeSidePanel",[],new ZI,S("v2","copilot.view.closeSidePanel"))}))}let ZI=class extends Me{validate(t){return!0}deserialize(t){return t}};const XI=Object.freeze(Object.defineProperty({__proto__:null,closeSidePanel:YI,isSupported:QI},Symbol.toStringTag,{value:"Module"})),e_=Object.freeze(Object.defineProperty({__proto__:null,customTelemetry:FI,eligibility:BI,sidePanel:JI,view:XI},Symbol.toStringTag,{value:"Module"})),qs="v2";function t_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Mo())throw E;return rr(e,t),ne("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,r.authId,r.connectionName,r.claims,r.silent],S(qs,"externalAppAuthenticationForCEA.authenticateWithSSO"),Tt)}))}function r_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Mo())throw E;return rr(e,t),ne("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,r.url.href,r.width,r.height,r.isExternal],S(qs,"externalAppAuthenticationForCEA.authenticateWithOauth"),Tt)}))}function n_(e,t,r,i){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Mo())throw E;return rr(e,t),zs(i),ce("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new bp(i),r.url.href,r.width,r.height,r.isExternal],new Ip,S(qs,"externalAppAuthenticationForCEA.authenticateAndResendRequest"),Tt)}))}function i_(e,t,r,i){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Mo())throw E;return rr(e,t),zs(i),ce("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new bp(i),r.authId,r.connectionName,r.claims,r.silent],new Ip,S(qs,"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),Tt)}))}function Mo(){return!(!y(v)||!v.supports.externalAppAuthenticationForCEA)}function rr(e,t){Ke(t,new Error("conversation id is not valid.")),oS(e)}const o_=Object.freeze(Object.defineProperty({__proto__:null,authenticateAndResendRequest:n_,authenticateWithOauth:r_,authenticateWithSSO:t_,authenticateWithSSOAndResendRequest:i_,isSupported:Mo,validateInput:rr},Symbol.toStringTag,{value:"Module"}));var hu,vu;function s_(e,t){if(y(v,C.content),!Mp())throw E;const r=new _e(e);return re(S("v2","externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[r.toString(),t]).then((([i,n])=>{if(!i)throw n}))}function a_(e,t,r){if(y(v,C.content),!Mp())throw E;const i=new _e(e);return re(S("v2","externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[i.toString(),t.href,r]).then((([n,s])=>{if(n)throw n;return s}))}function Mp(){return!(!y(v)||!v.supports.externalAppCardActions)}(function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"})(hu||(hu={})),(function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"})(vu||(vu={}));const c_=Object.freeze(Object.defineProperty({__proto__:null,get ActionOpenUrlErrorCode(){return vu},get ActionOpenUrlType(){return hu},isSupported:Mp,processActionOpenUrl:a_,processActionSubmit:s_},Symbol.toStringTag,{value:"Module"}));function u_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Dp())throw E;rr(e,t);const[i,n]=yield re(S("v2","externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,r.href]);if(i)throw i;return n}))}function p_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!Dp())throw E;rr(e,t);const i=yield Je(S("v2","externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,r);if(i)throw i}))}function Dp(){return!(!y(v)||!v.supports.externalAppCardActionsForCEA)}const d_=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Dp,processActionOpenUrl:u_,processActionSubmit:p_},Symbol.toStringTag,{value:"Module"}));var fu;(function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"})(fu||(fu={}));function l_(e){if(typeof e!="object"||e===null)return!1;const t=e;return Object.values(fu).includes(t.errorCode)&&(t.message===void 0||typeof t.message=="string")}function h_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!YS())throw E;return(function(i,n){oS(i),pA(n)})(e,r),ne("externalAppCardActionsForDA.processActionOpenUrlDialog",[e,new ZS(t),r],S("v2","externalAppCardActionsForDA.processActionOpenUrlDialog"),l_)}))}function YS(){return!(!y(v)||!v.supports.externalAppCardActionsForDA)}let ZS=class{constructor(t){this.info=t}serialize(){const{url:t,title:r,size:i}=this.info;return{url:t.href,title:r,size:i}}};const v_=Object.freeze(Object.defineProperty({__proto__:null,SerializableActionOpenUrlDialogInfo:ZS,isSupported:YS,processActionOpenUrlDialog:h_},Symbol.toStringTag,{value:"Module"}));function f_(e,t,r){return j(this,void 0,void 0,(function*(){if(y(v,C.content),!XS())throw E;const i=new _e(e),[n,s]=yield re(S("v2","externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[i.toString(),t,r]);if(n)throw n;return s}))}function XS(){return!(!y(v)||!v.supports.externalAppCommands)}const g_=Object.freeze(Object.defineProperty({__proto__:null,isSupported:XS,processActionCommand:f_},Symbol.toStringTag,{value:"Module"})),oe="v1";var gu,mu,Su,Cu,yu,Pu;function m_(e,t){if(y(v,C.content),!e||e.length===0)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");T(S(oe,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function S_(e,t){if(y(v,C.content),!e||e.length===0)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");T(S(oe,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function C_(e,t,r){if(y(v,C.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!r)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");T(S(oe,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],r)}function y_(e,t,r){if(y(v,C.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!r)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");T(S(oe,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],r)}function P_(e,t,r){if(y(v,C.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");T(S(oe,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,r])}function w_(e=!1,t){if(y(v,C.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");T(S(oe,"files.getExternalProviders"),"files.getExternalProviders",[e],t)}function R_(e,t,r,i,n=!1,s){if(y(v,C.content),!e||e.length===0)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!s)throw new Error("[files.copyMoveFiles] callback cannot be null");T(S(oe,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,r,i,n],s)}function E_(e){if(y(v,C.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");T(S(oe,"files.getFileDownloads"),"files.getFileDownloads",[],e)}function A_(e=void 0,t){if(y(v,C.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");T(S(oe,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function T_(e){if(y(v,C.content),!e)throw me(N.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");T(S(oe,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function b_(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw me(N.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");T(S(oe,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function I_(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw me(N.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");T(S(oe,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function __(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw me(N.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");T(S(oe,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function O_(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw me(N.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");T(S(oe,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function M_(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw me(N.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");T(S(oe,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function D_(e,t){if(y(v,C.content),!t)throw me(N.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw me(N.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw me(N.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");T(S(oe,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function k_(e){if(y(v),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");B(S(oe,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function N_(e){if(y(v),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");B(S(oe,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function me(e,t){return{errorCode:e,message:t}}(function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"})(gu||(gu={})),(function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"})(mu||(mu={})),(function(e){e.ClassMaterials="classMaterials"})(Su||(Su={})),(function(e){e.Readonly="readonly"})(Cu||(Cu={})),(function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"})(yu||(yu={})),(function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"})(Pu||(Pu={}));const j_=Object.freeze(Object.defineProperty({__proto__:null,get CloudStorageProvider(){return gu},get CloudStorageProviderFileAction(){return Pu},get CloudStorageProviderType(){return mu},get DocumentLibraryAccessType(){return Cu},get FileDownloadStatus(){return yu},get SpecialDocumentLibraryType(){return Su},addCloudStorageFolder:S_,addCloudStorageProvider:T_,addCloudStorageProviderFile:I_,copyMoveFiles:R_,deleteCloudStorageFolder:C_,deleteCloudStorageProviderFile:O_,downloadCloudStorageProviderFile:M_,getCloudStorageFolderContents:y_,getCloudStorageFolders:m_,getExternalProviders:w_,getFileDownloads:E_,openCloudStorageFile:P_,openDownloadFolder:A_,registerCloudStorageProviderContentChangeHandler:N_,registerCloudStorageProviderListChangeHandler:k_,removeCloudStorageProvider:b_,renameCloudStorageProviderFile:__,uploadCloudStorageProviderFile:D_},Symbol.toStringTag,{value:"Module"})),Bs="v1";function z_(){return new Promise((e=>{if(y(v),!Do())throw E;e(U(S(Bs,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))}))}function L_(e){return new Promise((t=>{if(!e||e.length==0)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(y(v),!Do())throw E;t(U(S(Bs,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))}function F_(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(y(v),!Do())throw E;B(S(Bs,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{y(v),e(t)}))}function q_(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(y(v),!Do())throw E;B(S(Bs,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",(t=>{y(v),e(t)}))}function Do(){return!(!y(v)||!v.supports.meetingRoom)}const B_=Object.freeze(Object.defineProperty({__proto__:null,getPairedMeetingRoomInfo:z_,isSupported:Do,registerMeetingRoomCapabilitiesUpdateHandler:F_,registerMeetingRoomStatesUpdateHandler:q_,sendCommandToPairedMeetingRoom:L_},Symbol.toStringTag,{value:"Module"}));function U_(){return!(!y(v)||!v.supports.messageChannels)}const x_=Object.freeze(Object.defineProperty({__proto__:null,dataLayer:ST,isSupported:U_,telemetry:fT},Symbol.toStringTag,{value:"Module"})),H_="1.0.1",$_={onMessage:function(e,t){if(!e||!e.data||typeof e.data!="object"||e.data===null)return void vo("Invalid message format, ignoring. Message: %o",e);if(!(function(s,a){if(a===Xo)try{return new URL(a).protocol==="https:"}catch(o){return us("Invalid message origin URL:",o),!1}return!1})(e.source,e.origin))return void vo("Message source/origin not allowed, ignoring.");const{args:r}=e.data,[,i]=r??[],n=(()=>{try{return JSON.parse(i)}catch(s){return us("Failed to parse response message:",s),null}})();if(!n||n.messageType!=="NestedAppAuthResponse")return void vo("Invalid response format, ignoring. Message: %o",e);t(i)}};let Xo=null,kp=!1;function W_(e,t,r=!1){if(kp=r,!e)throw new Error("Cannot polyfill nestedAppAuthBridge as the current window does not exist");if(!t)throw new Error("Top origin is required to initialize the Nested App Auth Bridge");try{const s=new URL(t);if(s.protocol!=="https:")throw new Error(`Invalid top origin: ${t}. Only HTTPS origins are allowed.`);Xo=s.origin}catch{throw new Error(`Failed to initialize bridge: invalid top origin: ${t}`)}const i=e;if(i.nestedAppAuthBridge)return void vo("Nested App Auth Bridge is already present");const n=(function(s){const a=new WeakMap,{onMessage:o}=$_,c=u=>p=>o(p,u);return{addEventListener:(u,p)=>{if(u==="message"){const d=c(p);a.set(p,d),s.addEventListener(u,d)}else vo(`Event ${u} is not supported by nestedAppAuthBridge`)},postMessage:u=>{if(!s.top)throw new Error("window.top is not available for posting messages");try{const p=JSON.parse(u);if(typeof p=="object"&&p.messageType==="NestedAppAuthRequest"){const d=(function(h){const l=Date.now();return{id:V_(),uuid:Nm(),func:"nestedAppAuth.execute",timestamp:l,apiVersionTag:"v2_nestedAppAuth.execute",monotonicTimestamp:l,args:[],data:h}})(u);if(s===s.top||!Xo)return void us("Not in an embedded iframe; skipping postMessage.");s.top.postMessage(d,Xo)}}catch(p){return void us("Failed to parse message:",p,"Original message:",u)}},removeEventListener:(u,p)=>{const d=a.get(p);d&&(s.removeEventListener(u,d),a.delete(p))}}})(i);n&&(i.nestedAppAuthBridge=n)}function V_(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2,11)}function vo(...e){kp&&console.log(...e)}function us(...e){kp&&console.error(...e)}const K_=Object.freeze(Object.defineProperty({__proto__:null,initialize:W_,version:H_},Symbol.toStringTag,{value:"Module"}));function G_(e){if(y(v,C.content),!eC())throw E;T(S("v1","notifications.showNotification"),"notifications.showNotification",[e])}function eC(){return!(!y(v)||!v.supports.notifications)}const J_=Object.freeze(Object.defineProperty({__proto__:null,isSupported:eC,showNotification:G_},Symbol.toStringTag,{value:"Module"})),Np="v2";function Q_(e){if(!Us())throw new Error(N.NOT_SUPPORTED_ON_PLATFORM.toString());if(G(e))throw new Error(N.INVALID_ARGUMENTS.toString());B(S(Np,"otherApp.install"),"otherApp.install",e)}function Y_(){if(!Us())throw new Error(N.NOT_SUPPORTED_ON_PLATFORM.toString());T(S(Np,"otherApp.unregisterInstall"),"otherApp.unregisterInstall"),pe("otherApp.install")}function Z_(e){if(!Us())throw new Error(N.NOT_SUPPORTED_ON_PLATFORM.toString());return ne("otherApp.notifyInstallCompleted",[e.toString()],S(Np,"otherApp.notifyInstallCompleted"))}function Us(){return!(!y(v)||!v.supports.otherAppStateChange)}const X_=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Us,notifyInstallCompleted:Z_,registerAppInstallationHandler:Q_,unregisterAppInstallationHandler:Y_},Symbol.toStringTag,{value:"Module"})),bt="v1";var wu,Ru,Eu;function e0(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(y(v,C.sidePanel),!ut())throw E;T(S(bt,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function t0(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(y(v,C.sidePanel),!ut())throw E;T(S(bt,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function r0(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(y(v,C.sidePanel),!ut())throw E;T(S(bt,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function n0(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(y(v,C.sidePanel),!ut())throw E;T(S(bt,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function i0(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(y(v,C.sidePanel),!ut())throw E;B(S(bt,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function o0(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(y(v,C.sidePanel),!ut())throw E;B(S(bt,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function s0(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(y(v,C.sidePanel),!ut())throw E;B(S(bt,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function a0(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(y(v,C.sidePanel),!ut())throw E;B(S(bt,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function ut(){return!(!y(v)||!v.supports.remoteCamera)}(function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"})(wu||(wu={})),(function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"})(Ru||(Ru={})),(function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"})(Eu||(Eu={}));const c0=Object.freeze(Object.defineProperty({__proto__:null,get ControlCommand(){return wu},get ErrorReason(){return Ru},get SessionTerminatedReason(){return Eu},getCapableParticipants:e0,isSupported:ut,registerOnCapableParticipantsChangeHandler:i0,registerOnDeviceStateChangeHandler:s0,registerOnErrorHandler:o0,registerOnSessionStatusChangeHandler:a0,requestControl:t0,sendControlCommand:r0,terminateSession:n0},Symbol.toStringTag,{value:"Module"}));function u0(e,t,r,i){if(y(v,C.content),!tC())throw E;if(!e||e.length==0)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!i)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");T(S("v1","appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,r],i)}function tC(){return!(!y(v)||!v.supports.appEntity)}const p0=Object.freeze(Object.defineProperty({__proto__:null,isSupported:tC,selectAppEntity:u0},Symbol.toStringTag,{value:"Module"}));function d0(e){return new Promise((t=>{if(y(v),!rC())throw E;if((_.hostClientType===z.android||_.hostClientType===z.teamsRoomsAndroid||_.hostClientType===z.teamsPhones||_.hostClientType===z.teamsDisplays)&&!Ie(EA)){const r={errorCode:N.OLD_PLATFORM};throw new Error(JSON.stringify(r))}t(Je(S("v1","teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))}))}function rC(){return!(!y(v)||!v.supports.teams)&&!!v.supports.teams.fullTrust&&!!v.supports.teams.fullTrust.joinedTeams}const l0=Object.freeze(Object.defineProperty({__proto__:null,getUserJoinedTeams:d0,isSupported:rC},Symbol.toStringTag,{value:"Module"}));function h0(e){return j(this,void 0,void 0,(function*(){if(y(v),!nC())throw E;return ce("getConfigSetting",[e],new Cp,S("v1","teams.fullTrust.getConfigSetting"))}))}function nC(){return!(!y(v)||!v.supports.teams)&&!!v.supports.teams.fullTrust}const v0=Object.freeze(Object.defineProperty({__proto__:null,getConfigSetting:h0,isSupported:nC,joinedTeams:l0},Symbol.toStringTag,{value:"Module"}));var Au;function f0(e,t){if(y(v,C.content),!jp())throw E;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");T(S("v1","teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function g0(e,t){if(y(v),!jp())throw E;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");T(S("v1","teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function jp(){return!(!y(v)||!v.supports.teams)}(function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"})(Au||(Au={}));const m0=Object.freeze(Object.defineProperty({__proto__:null,get ChannelType(){return Au},fullTrust:v0,getTeamChannels:f0,isSupported:jp,refreshSiteUrl:g0},Symbol.toStringTag,{value:"Module"}));let ar=class rt{static setTimeout(t,r){const i=performance.now(),n=up();return rt.setTimeoutCallbacks[n]={callback:t,timeoutInMs:r,startedAtInMs:i},n}static clearTimeout(t){delete rt.setTimeoutCallbacks[t]}static setInterval(t,r){rt.setTimeout((function i(){t(),rt.setTimeout(i,r)}),r)}static tick(){const t=performance.now(),r=[];for(const i in rt.setTimeoutCallbacks){const n=rt.setTimeoutCallbacks[i];t-n.startedAtInMs>=n.timeoutInMs&&r.push(i)}for(const i of r)rt.setTimeoutCallbacks[i].callback(),delete rt.setTimeoutCallbacks[i]}};ar.setTimeoutCallbacks={};let Tu=class bu{constructor(t,r){this.reportStatisticsResult=r,this.sampleCount=0,this.distributionBins=new Uint32Array(t)}processStarts(t,r,i,n){ar.tick(),this.suitableForThisSession(t,r,i,n)||this.reportAndResetSession(this.getStatistics(),t,n,r,i),this.start()}processEnds(){const t=performance.now()-this.frameProcessingStartedAt,r=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,t)));this.distributionBins[r]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(t,r,i,n){return this.currentSession&&this.currentSession.effectId===t&&this.currentSession.effectParam===n&&this.currentSession.frameWidth===r&&this.currentSession.frameHeight===i}reportAndResetSession(t,r,i,n,s){t&&this.reportStatisticsResult(t),this.resetCurrentSession(this.getNextTimeout(r,this.currentSession),r,i,n,s),this.timeoutId&&ar.clearTimeout(this.timeoutId),this.timeoutId=ar.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),r,i,n,s)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(t,r,i,n,s){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:t,effectId:r,effectParam:i,frameWidth:n,frameHeight:s},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(t,r){return r&&r.effectId===t?Math.min(bu.maxSessionTimeoutInMs,2*r.timeoutInMs):bu.initialSessionTimeoutInMs}};Tu.initialSessionTimeoutInMs=1e3,Tu.maxSessionTimeoutInMs=3e4;const Vo="v2";let ps=class Iu{constructor(t){this.reportPerformanceEvent=t,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Tu(Iu.distributionBinSize,(r=>this.reportPerformanceEvent(S(Vo,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[r])))}startMonitorSlowFrameProcessing(){ar.setInterval((()=>{if(this.processedFrameCount===0)return;const t=this.frameProcessingTimeCost/this.processedFrameCount;t>this.frameProcessTimeLimit&&this.reportPerformanceEvent(S(Vo,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[t]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),Iu.calculateFPSInterval)}setFrameProcessTimeLimit(t){this.frameProcessTimeLimit=t}reportApplyingVideoEffect(t,r){var i,n;((i=this.applyingEffect)===null||i===void 0?void 0:i.effectId)===t&&((n=this.applyingEffect)===null||n===void 0?void 0:n.effectParam)===r||(this.applyingEffect={effectId:t,effectParam:r},this.appliedEffect=void 0)}reportVideoEffectChanged(t,r){this.applyingEffect===void 0||this.applyingEffect.effectId!==t&&this.applyingEffect.effectParam!==r||(this.appliedEffect={effectId:t,effectParam:r},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(t,r){ar.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,t,r,this.appliedEffect.effectParam))}reportFrameProcessed(){var t;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(S(Vo,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,(t=this.appliedEffect)===null||t===void 0?void 0:t.effectParam])))}reportGettingTextureStream(t){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=t}reportTextureStreamAcquired(){if(this.gettingTextureStreamStartedAt!==void 0){const t=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(S(Vo,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,t])}}};ps.distributionBinSize=1e3,ps.calculateFPSInterval=1e3;const xe="v2",ze=Ue()?void 0:new ps(T);var _u,Ou,Ro;function S0(e){if(y(v,C.sidePanel),!ot())throw E;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(B(S(xe,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(t=>ze==null?void 0:ze.setFrameProcessTimeLimit(t.timeLimit)),!1),fg())(function(t,r){if(y(v,C.sidePanel),!ot()||!fg())throw E;B(S(xe,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(i=>j(this,void 0,void 0,(function*(){const{streamId:n}=i;yield iC(n,(function(a,o){return c=>j(this,void 0,void 0,(function*(){const u=c.videoFrame;o==null||o.reportStartFrameProcessing(u.codedWidth,u.codedHeight);const p=yield a(c);return o==null||o.reportFrameProcessed(),p}))})(t,ze),vg,ze)}))),!1),T(S(xe,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[r])})(e.videoFrameHandler,e.config);else{if(!gg())throw E;(function(t,r){if(y(v,C.sidePanel),!ot()||!gg())throw E;B(S(xe,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",(i=>{if(i){const n=i.timestamp;ze==null||ze.reportStartFrameProcessing(i.width,i.height),t((function(s){if("videoFrameBuffer"in s)return s;{const{data:a}=s,o=wt(s,["data"]);return Object.assign(Object.assign({},o),{videoFrameBuffer:a})}})(i),(()=>{ze==null||ze.reportFrameProcessed(),(function(s){T(S(xe,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[s])})(n)}),vg)}}),!1),T(S(xe,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[r])})(e.videoBufferHandler,e.config)}ze==null||ze.startMonitorSlowFrameProcessing()}function C0(e,t){if(y(v,C.sidePanel),!ot())throw E;T(S(xe,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function y0(e){if(y(v,C.sidePanel),!ot())throw E;B(S(xe,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",cC(e,ze),!1),T(S(xe,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function vg(e){T(S(xe,"videoEffects.notifyError"),"video.notifyError",[e])}function ot(){return y(v)&&!!v.supports.video&&(!!v.supports.video.mediaStream||!!v.supports.video.sharedFrame)}function fg(){var e;return y(v,C.sidePanel)&&(function(){var t,r,i,n;return!(!(!((r=(t=ur().chrome)===null||t===void 0?void 0:t.webview)===null||r===void 0)&&r.getTextureStream)||!(!((n=(i=ur().chrome)===null||i===void 0?void 0:i.webview)===null||n===void 0)&&n.registerTextureStream))})()&&!!(!((e=v.supports.video)===null||e===void 0)&&e.mediaStream)}function gg(){var e;return y(v,C.sidePanel)&&!!(!((e=v.supports.video)===null||e===void 0)&&e.sharedFrame)}(function(e){e.NV12="NV12"})(_u||(_u={})),(function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"})(Ou||(Ou={})),(function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"})(Ro||(Ro={}));const P0=Object.freeze(Object.defineProperty({__proto__:null,get EffectChangeType(){return Ou},get EffectFailureReason(){return Ro},get VideoFrameFormat(){return _u},isSupported:ot,notifySelectedVideoEffectChanged:C0,registerForVideoEffect:y0,registerForVideoFrame:S0},Symbol.toStringTag,{value:"Module"})),Mu="v2";function iC(e,t,r,i){var n,s;return j(this,void 0,void 0,(function*(){const a=sC();!Ue()&&((s=(n=window.chrome)===null||n===void 0?void 0:n.webview)===null||s===void 0||s.registerTextureStream(e,a)),aC(yield oC(e,r,i),new R0(r,t),a.writable)}))}function w0(e,t,r,i){var n,s;return j(this,void 0,void 0,(function*(){const a=sC();!Ue()&&((s=(n=window.chrome)===null||n===void 0?void 0:n.webview)===null||s===void 0||s.registerTextureStream(e,a)),aC(yield oC(e,r,i),new T0(r,t),a.writable)}))}function oC(e,t,r){return j(this,void 0,void 0,(function*(){if(Ue())throw E;const i=ur().chrome;try{r==null||r.reportGettingTextureStream(e);const n=(yield i.webview.getTextureStream(e)).getVideoTracks();if(n.length===0)throw new Error(`No video track in stream ${e}`);return r==null||r.reportTextureStreamAcquired(),n[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function sC(){if(Ue())throw E;const e=window.MediaStreamTrackGenerator;if(!e)throw E;return new e({kind:"video"})}function aC(e,t,r){new(ur()).MediaStreamTrackProcessor({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(r)}let R0=class{constructor(t,r){this.notifyError=t,this.videoFrameHandler=r,this.transform=(i,n)=>j(this,void 0,void 0,(function*(){const s=i.timestamp;if(s!==null)try{const a=yield this.videoFrameHandler({videoFrame:i}),o=new VideoFrame(a,{timestamp:s});n.enqueue(o),i.close(),a.close()}catch(a){i.close(),this.notifyError(a)}else this.notifyError("timestamp of the original video frame is null")}))}},E0=class{constructor(t,r){if(this.headerBuffer=t,this.notifyError=r,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(t),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}},A0=class{constructor(t,r){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161,this.ATTRIBUTE_ID_MAP_STREAM_ID=1296320833;const i=new Uint32Array(t);for(let n=0,s=0;n<r;n++){const a=i[s++],o=i[s++],c=i[s++],u=new Uint8Array(t,o,c);this.metadataMap.set(a,u)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){const t=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(t===void 0)return;const r=new Map,i=new TextDecoder("utf-8");let n=0;const s=t[n]+(t[++n]<<8)+(t[++n]<<16)+(t[++n]<<24);for(let a=0;a<s&&n<t.length-1;a++){const o=t[++n]+(t[++n]<<8)+(t[++n]<<16)+(t[++n]<<24),c=t.findIndex(((d,h,l)=>d==0&&h>n)),u=i.decode(t.slice(++n,c)),p=this.metadataMap.get(o);p!==void 0&&r.set(u,p),n=c+(4-(c-n)%4-1)}return r}},T0=class{constructor(t,r){this.notifyError=t,this.videoFrameHandler=r,this.shouldDiscardAudioInferenceResult=!1,this.transform=(i,n)=>j(this,void 0,void 0,(function*(){const s=i.timestamp;if(s!==null)try{const{videoFrame:a,metadata:{audioInferenceResult:o,attributes:c}={}}=yield this.extractVideoFrameAndMetadata(i),u=yield this.videoFrameHandler({videoFrame:a,audioInferenceResult:o,attributes:c}),p=new VideoFrame(u,{timestamp:s});n.enqueue(p),a.close(),i.close(),u.close()}catch(a){i.close(),this.notifyError(a)}else this.notifyError("timestamp of the original video frame is null")})),this.extractVideoFrameAndMetadata=i=>j(this,void 0,void 0,(function*(){if(Ue())throw E;if(i.format!=="NV12")throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const n={x:0,y:0,width:i.codedWidth,height:2},s=new ArrayBuffer(n.width*n.height*3/2);yield i.copyTo(s,{rect:n});const a=new E0(s,this.notifyError),o={x:0,y:a.multiStreamHeaderRowOffset,width:i.codedWidth,height:i.codedHeight-a.multiStreamHeaderRowOffset},c=new ArrayBuffer(o.width*o.height*3/2);yield i.copyTo(c,{rect:o});const u=new A0(c,a.multiStreamCount);return{videoFrame:new VideoFrame(i,{timestamp:i.timestamp,visibleRect:{x:0,y:a.frameRowOffset,width:a.frameWidth,height:a.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:u.audioInferenceResult,attributes:u.attributes}}})),B(S(Mu,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:i})=>{this.shouldDiscardAudioInferenceResult=i}))}};function cC(e,t){return(r,i)=>{t==null||t.reportApplyingVideoEffect(r||"",i),e(r,i).then((()=>{t==null||t.reportVideoEffectChanged(r||"",i),T(S(Mu,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,r,void 0,i])})).catch((n=>{const s=n in Ro?n:Ro.InitializationFailure;T(S(Mu,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,r,s,i])}))}}const Le="v2",Du=2e3,Re=Ue()?void 0:new ps(T);var dr;function b0(e){var t,r;if(!xs())throw E;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(y(v,C.sidePanel)){if(B(S(Le,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(i=>Re==null?void 0:Re.setFrameProcessTimeLimit(i)),!1),(t=v.supports.video)===null||t===void 0?void 0:t.mediaStream)B(S(Le,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(i=>j(this,void 0,void 0,(function*(){const{streamId:n,metadataInTexture:s}=i,a=Re?(function(o,c){return u=>j(this,void 0,void 0,(function*(){const p=u.videoFrame;c.reportStartFrameProcessing(p.codedWidth,p.codedHeight);const d=mg(),h=yield o(u);return d(),c.reportFrameProcessed(),h}))})(e.videoFrameHandler,Re):e.videoFrameHandler;s?yield w0(n,a,fo,Re):yield iC(n,a,fo,Re)}))),!1),T(S(Le,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(!((r=v.supports.video)===null||r===void 0)&&r.sharedFrame))throw E;B(S(Le,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",(i=>{if(i){Re==null||Re.reportStartFrameProcessing(i.width,i.height);const n=mg(),s=i.timestamp;e.videoBufferHandler((function(a){return a.videoFrameBuffer=a.videoFrameBuffer||a.data,delete a.data,a})(i),(()=>{n(),Re==null||Re.reportFrameProcessed(),(function(a){T(S(Le,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[a])})(s)}),fo)}}),!1),T(S(Le,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}Re==null||Re.startMonitorSlowFrameProcessing()}}function mg(){const e=setTimeout((()=>{fo(`Frame not processed in ${Du}ms`,dr.Warn)}),Du);return function(){clearTimeout(e)}}function I0(e,t,r){if(y(v,C.sidePanel),!xs())throw E;T(S(Le,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,r])}function _0(e){if(y(v,C.sidePanel),!xs())throw E;B(S(Le,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",cC(e,Re),!1),T(S(Le,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function O0(e){if(y(v,C.sidePanel),!ot())throw E;T(S(Le,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function xs(){return y(v),ot()}function fo(e,t=dr.Warn){T(S(Le,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function M0(e){if(y(v),!ot())throw E;fo(e,dr.Fatal)}(function(e){e.Fatal="fatal",e.Warn="warn"})(dr||(dr={}));const D0=Object.freeze(Object.defineProperty({__proto__:null,get ErrorLevel(){return dr},frameProcessingTimeoutInMs:Du,isSupported:xs,notifyFatalError:M0,notifySelectedVideoEffectChanged:I0,registerForVideoEffect:_0,registerForVideoFrame:b0,updatePersonalizedEffects:O0},Symbol.toStringTag,{value:"Module"})),ko="v2";let uC=class extends Me{validate(t){return t.tabType==="ConfigurableTab"}deserialize(t){return t}},pC=class{constructor(t){this.configurableTabInstance=t}serialize(){return this.configurableTabInstance}},No=class{constructor(t){this.hostEntityId=t}serialize(){return this.hostEntityId}},k0=class extends Me{validate(t){return t.tabType==="ConfigurableTab"||t.tabType==="StaticTab"}deserialize(t){return t}},N0=class{constructor(t){this.hostEntityTabInstance=t}serialize(){return this.hostEntityTabInstance}},j0=class extends Me{validate(t){return t.allTabs&&t.allTabs.forEach((r=>{})),!0}deserialize(t){return t}};function z0(e,t){if(y(v),!fr())throw new Error(`Error code: ${N.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(jo(e.threadId),t&&t.length===0)throw new Error(`Error code: ${N.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return ce("hostEntity.tab.addAndConfigure",[new No(e),t],new k0,S(ko,"hostEntity.tab.addAndConfigure"))}function L0(e){if(y(v),!fr())throw new Error(`Error code: ${N.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return jo(e.threadId),ce("hostEntity.tab.getAll",[new No(e)],new j0,S(ko,"hostEntity.tab.getAll"))}function F0(e,t){if(y(v),!fr())throw new Error(`Error code: ${N.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return zp(e),jo(t.threadId),ce("hostEntity.tab.reconfigure",[new pC(e),new No(t)],new uC,S(ko,"hostEntity.tab.reconfigure"))}function q0(e,t){if(y(v),!fr())throw new Error(`Error code: ${N.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return zp(e),jo(t.threadId),ce("hostEntity.tab.rename",[new pC(e),new No(t)],new uC,S(ko,"hostEntity.tab.rename"))}function B0(e,t){if(y(v),!fr())throw new Error(`Error code: ${N.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return jo(t.threadId),zp(e),ce("hostEntity.tab.remove",[new N0(e),new No(t)],new Cp,S(ko,"hostEntity.tab.remove"))}function fr(){var e;return!!(y(v)&&dC()&&(!((e=v.supports.hostEntity)===null||e===void 0)&&e.tab))}function jo(e){if(!e||e.length==0)throw new Error(`Error code: ${N.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function zp(e){if(!(e!=null&&e.internalTabInstanceId)||e.internalTabInstanceId.length===0)throw new Error(`Error code: ${N.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}const U0=Object.freeze(Object.defineProperty({__proto__:null,addAndConfigure:z0,getAll:L0,isSupported:fr,reconfigure:F0,remove:B0,rename:q0},Symbol.toStringTag,{value:"Module"}));var ku;function dC(){return!(!y(v)||!v.supports.hostEntity)}(function(e){e.edu="EDU",e.baseTownhall="BASE_TOWNHALL",e.streamingTownhall="STREAMING_TOWNHALL"})(ku||(ku={}));const x0=Object.freeze(Object.defineProperty({__proto__:null,get AppTypes(){return ku},isSupported:dC,tab:U0},Symbol.toStringTag,{value:"Module"})),Hs="v2",Sg="Invalid store dialog size";function H0(e){return j(this,void 0,void 0,(function*(){$s();const{size:t}=e??{};return ne("store.openFullStore",[Ws(t)],S(Hs,"store.openFullStore"))}))}function $0(e){return j(this,void 0,void 0,(function*(){$s();const{size:t,appId:r}=e;if(!(r instanceof _e))throw new Error("No App Id present, but AppId needed to open AppDetail store");return ne("store.openAppDetail",[Ws(t),r],S(Hs,"store.openAppDetail"))}))}function W0(e){return j(this,void 0,void 0,(function*(){$s();const{size:t,appCapability:r,appMetaCapabilities:i,installationScope:n,filteredOutAppIds:s}=e??{};return ne("store.openInContextStore",[Ws(t),r,i,n,s==null?void 0:s.map((a=>a.toString()))],S(Hs,"store.openInContextStore"))}))}function V0(e){return j(this,void 0,void 0,(function*(){$s();const{size:t,collectionId:r}=e;if(r===void 0)throw new Error("No Collection Id present, but CollectionId needed to open a store specific to a collection");return ne("store.openSpecificStore",[Ws(t),r],S(Hs,"store.openSpecificStore"))}))}function lC(){return y(v)&&!!v.supports.store}function $s(){if(y(v,C.content,C.sidePanel,C.meetingStage),!lC())throw E}function Ws(e){if(e===void 0)return;const{width:t,height:r}=e;if(t!==void 0&&typeof t=="number"&&t<0)throw new Error(Sg);if(r!==void 0&&typeof r=="number"&&r<0)throw new Error(Sg);return JSON.stringify(e)}const K0=Object.freeze(Object.defineProperty({__proto__:null,isSupported:lC,openAppDetail:$0,openFullStore:H0,openInContextStore:W0,openSpecificStore:V0},Symbol.toStringTag,{value:"Module"})),pt="v1",It=ae("widgetHosting");function hC(){return y(v)&&!!v.supports.widgetHosting}function G0(e,t){return j(this,void 0,void 0,(function*(){return ue(),It("Calling tool with widgetId and input: ",{widgetId:e,input:t}),ce("widgetHosting.callTool",[new oO(e,t)],new nO,S(pt,"widgetHosting.callTool"),hr)}))}function J0(e,t){return j(this,void 0,void 0,(function*(){return ue(),It("Sending follow-up message with widgetId and prompt: ",{widgetId:e,prompt:t.prompt}),ne("widgetHosting.sendFollowUpMessage",[new sO(e,t)],S(pt,"widgetHosting.sendFollowUpMessage"))}))}function Q0(e,t){return j(this,void 0,void 0,(function*(){return ue(),It("Requesting display mode with widgetId: ",{widgetId:e,mode:t.mode}),ne("widgetHosting.requestDisplayMode",[new aO(e,t)],S(pt,"widgetHosting.requestDisplayMode"))}))}function Y0(e,t){return j(this,void 0,void 0,(function*(){return ue(),It("Requesting modal with widgetId and options: ",{widgetId:e,options:t}),ce("widgetHosting.requestModal",[new dO(e,t)],new iO,S(pt,"widgetHosting.requestModal"),hr)}))}function Z0(e,t){ue(),It("Notifying intrinsic height with widgetId: ",{widgetId:e,height:t}),ne("widgetHosting.notifyIntrinsicHeight",[new pO(e,t)],S(pt,"widgetHosting.notifyIntrinsicHeight"))}function X0(e,t,r){ue(),It("Content size changed with widgetId: ",{widgetId:e,width:t,height:r}),ne("widgetHosting.contentSizeChanged",[new lO(e,t,r)],S(pt,"widgetHosting.contentSizeChanged"))}function eO(e,t){return j(this,void 0,void 0,(function*(){return ue(),It("Setting widget state with widgetId: ",{widgetId:e,state:t}),ne("widgetHosting.setWidgetState",[new uO(e,t)],S(pt,"widgetHosting.setWidgetState"))}))}function tO(e,t){ue(),It("Opening external URL with widgetId: ",{widgetId:e,href:t.href}),ne("widgetHosting.openExternal",[new cO(e,t)],S(pt,"widgetHosting.openExternal"))}function rO(e){Ce(S(pt,"widgetHosting.registerModalCloseHandler"),"widgetHosting.closeWidgetModal",e,[],(()=>{if(!hC())throw new Error("Widget Hosting is not supported on this platform")}))}let nO=class extends Me{validate(t){return t!==null&&typeof t=="object"}deserialize(t){return t}},iO=class extends Me{validate(t){return t!==null&&typeof t=="object"}deserialize(t){return t}},oO=class{constructor(t,r){this.widgetId=t,this.toolInput=r}serialize(){return{widgetId:this.widgetId,name:this.toolInput.name,arguments:this.toolInput.arguments}}},sO=class{constructor(t,r){this.widgetId=t,this.args=r}serialize(){return{widgetId:this.widgetId,prompt:this.args.prompt}}},aO=class{constructor(t,r){this.widgetId=t,this.args=r}serialize(){return{widgetId:this.widgetId,mode:this.args.mode}}},cO=class{constructor(t,r){this.widgetId=t,this.payload=r}serialize(){return{widgetId:this.widgetId,href:this.payload.href}}},uO=class{constructor(t,r){this.widgetId=t,this.state=r}serialize(){return{widgetId:this.widgetId,state:this.state}}},pO=class{constructor(t,r){this.widgetId=t,this.height=r}serialize(){return{widgetId:this.widgetId,height:this.height}}},dO=class{constructor(t,r){this.widgetId=t,this.options=r}serialize(){return{widgetId:this.widgetId,id:this.options.id,title:this.options.title,content:this.options.content,width:this.options.width,height:this.options.height}}},lO=class{constructor(t,r,i){this.widgetId=t,this.width=r,this.height=i}serialize(){return{widgetId:this.widgetId,width:this.width,height:this.height}}};const hO=Object.freeze(Object.defineProperty({__proto__:null,callTool:G0,contentSizeChanged:X0,isSupported:hC,notifyIntrinsicHeight:Z0,openExternal:tO,registerModalCloseHandler:rO,requestDisplayMode:Q0,requestModal:Y0,sendFollowUpMessage:J0,setWidgetState:eO},Symbol.toStringTag,{value:"Module"}));function vC(e){const t=!e||e.length<=0,r=e==null?void 0:e.indexOf("@"),i=e==null?void 0:e.indexOf(".",r);if(t||r===-1||i===-1)throw new Error("Input email address does not have the correct format.")}let vO=class{constructor(t){this.val=t,vC(t)}toString(){return this.val}};function fO(){return v.hostVersionsInfo?v.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}const ds="v1";let fC=class{postMessage(t,r){y(v),T(S(ds,"appWindow.childAppWindow.postMessage"),"messageForChild",[t],r||Rt())}addEventListener(t,r){y(v),t==="message"&&B(S(ds,"appWindow.childAppWindow.addEventListener"),"messageForParent",r)}},gO=class{static get Instance(){return this._instance||(this._instance=new this)}postMessage(t,r){y(v,C.task),T(S(ds,"appWindow.parentAppWindow.postMessage"),"messageForParent",[t],r||Rt())}addEventListener(t,r){y(v,C.task),t==="message"&&B(S(ds,"appWindow.parentAppWindow.addEventListener"),"messageForChild",r)}};function gC(){if(!_.printCapabilityEnabled){if(y(v),!Vs())throw E;_.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&e.keyCode===80&&(Lp(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}}function Lp(){ur().print()}function mO(e){Fp(S("v2","teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!G(e)&&!Vs())throw E}))}function Fp(e,t,r){!G(t)&&y(v),!G(t)&&r&&r(),nI(e,t)}function SO(e){qp(S("v2","teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!G(e)&&!Vs())throw E}))}function qp(e,t,r){!G(t)&&y(v),!G(t)&&r&&r(),oI(e,t)}function Vs(){return!(!y(v)||!v.supports.teamsCore)}const CO=Object.freeze(Object.defineProperty({__proto__:null,enablePrintCapability:gC,isSupported:Vs,print:Lp,registerBeforeUnloadHandler:SO,registerBeforeUnloadHandlerHelper:qp,registerOnLoadHandler:mO,registerOnLoadHandlerHelper:Fp},Symbol.toStringTag,{value:"Module"})),te="v1";function yO(e,t){ks(S(te,"initialize"),t).then((()=>{e&&e()}))}function PO(){gC()}function wO(){Lp()}function RO(e){ue(),T(S(te,"getContext"),"getContext",(t=>{t.frameContext||(t.frameContext=_.frameContext),e(t)}))}function EO(e){_S(S(te,"registerOnThemeChangeHandlerHelper"),e)}function AO(e){Ce(S(te,"registerFullScreenHandler"),"fullScreenChange",e,[])}function TO(e){Ce(S(te,"registerAppButtonClickHandler"),"appButtonClick",e,[C.content])}function bO(e){Ce(S(te,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[C.content])}function IO(e){Ce(S(te,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[C.content])}function _O(e){wp(S(te,"registerBackButtonHandler"),e)}function OO(e){Fp(S(te,"registerOnLoadHandler"),e)}function MO(e){qp(S(te,"registerBeforeUnloadHandler"),e)}function DO(e){Ce(S(te,"registerFocusEnterHandler"),"focusEnter",e,[])}function kO(e){Ce(S(te,"registerChangeSettingsHandler"),"changeSettings",e,[C.content])}function NO(e,t){y(v),zS(S(te,"getTabInstances"),t).then((r=>{e(r)}))}function jO(e,t){y(v),LS(S(te,"getMruTabInstances"),t).then((r=>{e(r)}))}function zO(e){FS(S(te,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function LO(e,t){y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage);const r=t??Rt();OS(S(te,"executeDeepLink"),e).then((()=>{r(!0)})).catch((i=>{r(!1,i.message)}))}function FO(e){Tp(S(te,"setFrameContext"),e)}function qO(e,t,r){ks(S(te,"initializeWithFrameContext"),r).then((()=>t&&t())),Tp(S(te,"setFrameContext"),e)}const Ks="v1";function BO(e){$b(S(Ks,"navigation.returnFocus"),e)}function UO(e,t){y(v);const r=t??Rt();jS(S(Ks,"navigation.navigateToTab"),e).then((()=>{r(!0)})).catch((i=>{r(!1,i.message)}))}function xO(e,t){y(v,C.content,C.sidePanel,C.settings,C.remove,C.task,C.stage,C.meetingStage);const r=t??Rt();kS(S(Ks,"navigation.navigateCrossDomain"),e).then((()=>{r(!0)})).catch((i=>{r(!1,i.message)}))}function HO(e){y(v);const t=e??Rt();NS(S(Ks,"navigation.navigateBack")).then((()=>{t(!0)})).catch((r=>{t(!1,r.message)}))}const lt="v2";var Nu,ju;function mC(){return!(!y(v,C.meetingStage,C.sidePanel,C.content)||!v.supports.interactive)}(function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"})(Nu||(Nu={})),(function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"})(ju||(ju={}));let SC=class CC{getFluidTenantInfo(){return tt(),new Promise((t=>{t(U(S(lt,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))}))}getFluidToken(t){return tt(),new Promise((r=>{r(U(S(lt,"interactive.getFluidToken"),"interactive.getFluidToken",t))}))}getFluidContainerId(){return tt(),new Promise((t=>{t(U(S(lt,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))}))}setFluidContainerId(t){return tt(),new Promise((r=>{r(U(S(lt,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",t))}))}getNtpTime(){return tt(),new Promise((t=>{t(U(S(lt,"interactive.getNtpTime"),"interactive.getNtpTime"))}))}registerClientId(t){return tt(),new Promise((r=>{r(U(S(lt,"interactive.registerClientId"),"interactive.registerClientId",t))}))}getClientRoles(t){return tt(),new Promise((r=>{r(U(S(lt,"interactive.getClientRoles"),"interactive.getClientRoles",t))}))}getClientInfo(t){return tt(),new Promise((r=>{r(U(S(lt,"interactive.getClientInfo"),"interactive.getClientInfo",t))}))}static create(){return tt(),new CC}};function tt(){if(!mC())throw new Error("LiveShareHost Not supported")}const $O=Object.freeze(Object.defineProperty({__proto__:null,get ContainerState(){return ju},LiveShareHost:SC,get UserMeetingRole(){return Nu},isSupported:mC},Symbol.toStringTag,{value:"Module"})),zo="v1",Lo="v2";let es;function WO(e){es=e}function VO(e){const t=e!==void 0,r=t?e:es;if(!r)throw new Error("No parameters are provided for authentication");return y(v,C.content,C.sidePanel,C.settings,C.remove,C.task,C.stage,C.meetingStage),(function(i,n){return j(this,void 0,void 0,(function*(){const s=aA(n.url);return Fm(s),re(i,"authentication.authenticate",[s.href,n.width,n.height,n.isExternal]).then((([a,o])=>{if(a)return o;throw new Error(o)}))}))})(r.successCallback||r.failureCallback?S(zo,"authentication.authenticate"):S(Lo,"authentication.authenticate"),r).then((i=>{try{return r&&r.successCallback?(r.successCallback(i),""):i}finally{t||(es=void 0)}})).catch((i=>{try{if(r&&r.failureCallback)return r.failureCallback(i.message),"";throw i}finally{t||(es=void 0)}}))}function KO(e){return ue(),(function(t,r){return new Promise((i=>{i(re(t,"authentication.getAuthToken",[r==null?void 0:r.resources,r==null?void 0:r.claims,r==null?void 0:r.silent,r==null?void 0:r.tenantId]))})).then((([i,n])=>{if(i)return n;throw new Error(n)}))})(e&&(e.successCallback||e.failureCallback)?S(zo,"authentication.getAuthToken"):S(Lo,"authentication.getAuthToken"),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))}function GO(e){return ue(),(function(t){return new Promise((r=>{r(re(t,"authentication.getUser"))})).then((([r,i])=>{if(r)return i;throw i}))})(e&&(e.successCallback||e.failureCallback)?S(zo,"authentication.getUser"):S(Lo,"authentication.getUser")).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{const r=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(r),null;throw new Error(r)}))}function JO(e,t){y(v,C.authentication);const r=S(t?zo:Lo,"authentication.notifySuccess");T(r,"authentication.authenticate.success",[e]),tS(k.parentWindow,(()=>setTimeout((()=>k.currentWindow.close()),200)))}function QO(e,t){y(v,C.authentication);const r=S(t?zo:Lo,"authentication.notifyFailure");T(r,"authentication.authenticate.failure",[e]),tS(k.parentWindow,(()=>setTimeout((()=>k.currentWindow.close()),200)))}var zu;(function(e){e.Public="public",e.EUDB="eudb",e.Other="other"})(zu||(zu={}));const YO=Object.freeze(Object.defineProperty({__proto__:null,get DataResidency(){return zu},authenticate:VO,getAuthToken:KO,getUser:GO,notifyFailure:QO,notifySuccess:JO,registerAuthenticationHandlers:WO},Symbol.toStringTag,{value:"Module"}));function ZO(){return y(v)&&!!v.supports.appPerformanceMetrics}function XO(e){y(v),B(S("v2","appPerformanceMetrics.memoryUsageHeartbeat"),"appPerformanceMetrics.memoryUsageHeartbeat",e)}const eM=Object.freeze(Object.defineProperty({__proto__:null,isSupported:ZO,registerHostMemoryMetricsHandler:XO},Symbol.toStringTag,{value:"Module"})),tM="/l/app/",rM="/l/meeting/new",nM="attendees",iM="startTime",oM="endTime",sM="subject",aM="content",cM="/l/call/0/0",uM="source",pM="withVideo",dM="/l/chat/0/0",yC="users",lM="topicName",hM="message";function PC(e,t,r){if(e.length===0)throw new Error("Must have at least one user when creating a chat deep link");const i=`${yC}=`+e.map((a=>encodeURIComponent(a))).join(","),n=t===void 0?"":`&${lM}=${encodeURIComponent(t)}`,s=r===void 0?"":`&${hM}=${encodeURIComponent(r)}`;return`${bs}://${Is}${dM}?${i}${n}${s}`}function vM(e,t,r){if(e.length===0)throw new Error("Must have at least one target when creating a call deep link");const i=`${yC}=`+e.map((a=>encodeURIComponent(a))).join(","),n=t===void 0?"":`&${pM}=${encodeURIComponent(t)}`,s=r===void 0?"":`&${uM}=${encodeURIComponent(r)}`;return`${bs}://${Is}${cM}?${i}${n}${s}`}function fM(e,t,r,i,n){const s=e===void 0?"":`${nM}=`+e.map((p=>encodeURIComponent(p))).join(","),a=t===void 0?"":`&${iM}=${encodeURIComponent(t)}`,o=r===void 0?"":`&${oM}=${encodeURIComponent(r)}`,c=i===void 0?"":`&${sM}=${encodeURIComponent(i)}`,u=n===void 0?"":`&${aM}=${encodeURIComponent(n)}`;return`${bs}://${Is}${rM}?${s}${a}${o}${c}${u}`}function gM(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${bs}://${Is}${tM}${encodeURIComponent(e)}`}function mM(e){return new Promise((t=>{if(y(v,C.content,C.sidePanel,C.settings,C.task,C.stage,C.meetingStage),!wC())throw new Error("Not supported");const r=S("v1","appInstallDialog.openAppInstallDialog");v.isLegacyTeams?t(de(r,"executeDeepLink",gM(e.appId))):(T(r,"appInstallDialog.openAppInstallDialog",[e]),t())}))}function wC(){return!(!y(v)||!v.supports.appInstallDialog)}const SM=Object.freeze(Object.defineProperty({__proto__:null,isSupported:wC,openAppInstallDialog:mM},Symbol.toStringTag,{value:"Module"})),We="v1",CM=ae("media");var ls,Eo,Lu,Fu,yt,qu,Bu;(function(e){e.Base64="base64",e.ID="id"})(ls||(ls={}));let RC=class{};function yM(e){if(!e)throw new Error("[captureImage] Callback cannot be null");y(v,C.content,C.task),_.isFramelessWindow?Ie(TA)?T(S(We,"media.captureImage"),"captureImage",e):e({errorCode:N.OLD_PLATFORM},[]):e({errorCode:N.NOT_SUPPORTED_ON_PLATFORM},[])}function PM(){if(y(v,C.content,C.task),!EC())throw E;const e=Ve.Media;return new Promise((t=>{t(U(S(We,"media.hasPermission"),"permissions.has",e))}))}function wM(){if(y(v,C.content,C.task),!EC())throw E;const e=Ve.Media;return new Promise((t=>{t(U(S(We,"media.requestPermission"),"permissions.request",e))}))}function EC(){return!(!y(v)||!v.supports.permissions)}class AC extends RC{constructor(t){super(),t&&(this.content=t.content,this.format=t.format,this.mimeType=t.mimeType,this.name=t.name,this.preview=t.preview,this.size=t.size)}getMedia(t){if(!t)throw new Error("[get Media] Callback cannot be null");y(v,C.content,C.task),Ie(fp)?jM(this.mimeType,this.format,this.content)?Ie(bA)?this.getMediaViaCallback(t):this.getMediaViaHandler(t):t({errorCode:N.INVALID_ARGUMENTS},new Blob):t({errorCode:N.OLD_PLATFORM},new Blob)}getMediaViaCallback(t){const r={mediaMimeType:this.mimeType,assembleAttachment:[]},i=[this.content];T(S(We,"media.getMedia"),"getMedia",i,(function(n){if(t)if(n&&n.error)t(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const s=Uu(r.assembleAttachment,r.mediaMimeType);t(n.error,s??new Blob)}else{const s=xu(n.mediaChunk,r.mediaMimeType);s?r.assembleAttachment.push(s):CM(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else t({errorCode:N.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(t){const r=up(),i={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[r,this.content];this.content&&!G(t)&&T(S(We,"media.getMedia"),"getMedia",n),B(S(We,"media.registerGetMediaRequestHandler"),"getMedia"+r,(function(s){if(t){const a=JSON.parse(s);if(a.error)t(a.error,new Blob),pe("getMedia"+r);else if(a.mediaChunk)if(a.mediaChunk.chunkSequence<=0){const o=Uu(i.assembleAttachment,i.mediaMimeType);t(a.error,o??new Blob),pe("getMedia"+r)}else{const o=xu(a.mediaChunk,i.mediaMimeType);o&&i.assembleAttachment.push(o)}else t({errorCode:N.INTERNAL_ERROR,message:"data received is null"},new Blob),pe("getMedia"+r)}}))}}class RM{constructor(t){this.controllerCallback=t}notifyEventToHost(t,r){y(v,C.content,C.task);try{Yo(Bm)}catch(n){return void(r&&r(n))}const i={mediaType:this.getMediaType(),mediaControllerEvent:t};T(S(We,"media.controller"),"media.controller",[i],(n=>{r&&r(n)}))}stop(t){this.notifyEventToHost(Eo.StopRecording,t)}}class EM extends RM{getMediaType(){return yt.Video}notifyEventToApp(t){if(this.controllerCallback)switch(t){case Eo.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}}function AM(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(y(v,C.content,C.task),!Ie(fp)){const i={errorCode:N.OLD_PLATFORM};return void t(i,[])}try{_M(e)}catch(i){return void t(i,[])}if(!MM(e)){const i={errorCode:N.INVALID_ARGUMENTS};return void t(i,[])}const r=[e];T(S(We,"media.selectMedia"),"selectMedia",r,((i,n,s)=>{var a,o;if(s)return void(OM(e)&&((o=(a=e==null?void 0:e.videoProps)===null||a===void 0?void 0:a.videoController)===null||o===void 0||o.notifyEventToApp(s)));if(!n)return void t(i,[]);const c=[];for(const u of n)c.push(new AC(u));t(i,c)}))}function TM(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(y(v,C.content,C.task),!Ie(fp))return void t({errorCode:N.OLD_PLATFORM});if(!zM(e))return void t({errorCode:N.INVALID_ARGUMENTS});const r=[e];T(S(We,"media.viewImages"),"viewImages",r,t)}function bM(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");y(v,C.content,C.task),_.hostClientType!==z.desktop&&_.hostClientType!==z.web&&_.hostClientType!==z.rigel&&_.hostClientType!==z.teamsRoomsWindows&&_.hostClientType!==z.teamsRoomsAndroid&&_.hostClientType!==z.teamsPhones&&_.hostClientType!==z.teamsDisplays?Ie(IA)?TC(t)?T(S(We,"media.scanBarCode"),"media.scanBarCode",[t],e):e({errorCode:N.INVALID_ARGUMENTS},""):e({errorCode:N.OLD_PLATFORM},""):e({errorCode:N.NOT_SUPPORTED_ON_PLATFORM},"")}(function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"})(Eo||(Eo={})),(function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"})(Lu||(Lu={})),(function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"})(Fu||(Fu={})),(function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"})(yt||(yt={})),(function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"})(qu||(qu={})),(function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"})(Bu||(Bu={}));const IM=Object.freeze(Object.defineProperty({__proto__:null,get CameraStartMode(){return Lu},File:RC,get FileFormat(){return ls},get ImageOutputFormats(){return Bu},get ImageUriType(){return qu},Media:AC,get MediaControllerEvent(){return Eo},get MediaType(){return yt},get Source(){return Fu},VideoController:EM,captureImage:yM,hasPermission:PM,requestPermission:wM,scanBarCode:bM,selectMedia:AM,viewImages:TM},Symbol.toStringTag,{value:"Module"}));function Uu(e,t){if(e==null||t==null||e.length<=0)return null;let r=null,i=1;return e.sort(((n,s)=>n.sequence>s.sequence?1:-1)),e.forEach((n=>{n.sequence==i&&(r=r?new Blob([r,n.file],{type:t}):new Blob([n.file],{type:t}),i++)})),r}function xu(e,t){if(e==null||t==null)return null;const r=atob(e.chunk),i=new Array(r.length);for(let a=0;a<r.length;a++)i[a]=r.charCodeAt(a);const n=new Uint8Array(i),s=new Blob([n],{type:t});return{sequence:e.chunkSequence,file:s}}function _M(e){kM(e)?Yo(wA):NM(e)?Yo(Bm):DM(e)&&Yo(RA)}function OM(e){return!(e.mediaType!=yt.Video||!e.videoProps||!e.videoProps.videoController)}function MM(e){return!(e==null||e.maxMediaCount>10)}function DM(e){var t;return!((e==null?void 0:e.mediaType)!=yt.Image||!(!((t=e==null?void 0:e.imageProps)===null||t===void 0)&&t.imageOutputFormats))}function kM(e){return!(!e||e.mediaType!=yt.VideoAndImage&&!e.videoAndImageProps)}function NM(e){return!(!e||e.mediaType!=yt.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function jM(e,t,r){return e!=null&&t!=null&&t==ls.ID&&r!=null}function zM(e){return!(e==null||e.length<=0||e.length>10)}function TC(e){return!e||!(e.timeOutIntervalInSec===null||e.timeOutIntervalInSec!=null&&e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec!=null&&e.timeOutIntervalInSec>60)}function LM(e){return!(e&&(e.title&&typeof e.title!="string"||e.setSelected&&typeof e.setSelected!="object"||e.openOrgWideSearchInChatOrChannel&&typeof e.openOrgWideSearchInChatOrChannel!="boolean"||e.singleSelect&&typeof e.singleSelect!="boolean"))}const Bp="v2";function FM(e){return new Promise((t=>{if(y(v,C.content,C.task),!Gs())throw E;if(!TC(e))throw{errorCode:N.INVALID_ARGUMENTS};t(U(S(Bp,"barCode.scanBarCode"),"media.scanBarCode",e))}))}function qM(){if(y(v,C.content,C.task),!Gs())throw E;const e=Ve.Media;return new Promise((t=>{t(U(S(Bp,"barCode.hasPermission"),"permissions.has",e))}))}function BM(){if(y(v,C.content,C.task),!Gs())throw E;const e=Ve.Media;return new Promise((t=>{t(U(S(Bp,"barCode.requestPermission"),"permissions.request",e))}))}function Gs(){return!!(y(v)&&v.supports.barCode&&v.supports.permissions)}const UM=Object.freeze(Object.defineProperty({__proto__:null,hasPermission:qM,isSupported:Gs,requestPermission:BM,scanBarCode:FM},Symbol.toStringTag,{value:"Module"}));function xM(e){return bC(S("v2","chat.openChat"),e)}function bC(e,t){return new Promise((r=>{if(y(v,C.content,C.task),!Up())throw E;v.isLegacyTeams?r(de(e,"executeDeepLink",PC([t.user],void 0,t.message))):r(de(e,"chat.openChat",{members:[t.user],message:t.message}))}))}function HM(e){const t=S("v2","chat.openGroupChat");return new Promise((r=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(e.users.length===1){const i={user:e.users[0],message:e.message};r(bC(t,i))}else{if(y(v,C.content,C.task),!Up())throw E;v.isLegacyTeams?r(de(t,"executeDeepLink",PC(e.users,e.topic,e.message))):r(de(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}))}function Up(){return!(!y(v)||!v.supports.chat)}const $M=Object.freeze(Object.defineProperty({__proto__:null,isSupported:Up,openChat:xM,openGroupChat:HM},Symbol.toStringTag,{value:"Module"}));function WM(e){return j(this,void 0,void 0,(function*(){if(y(v,C.content,C.meetingStage,C.task,C.settings,C.stage,C.sidePanel),!xp())throw E;if(!e.type||!Object.values(is).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(is)}`);const t=yield sA(e),r={mimeType:e.type,content:t};return U(S("v2","clipboard.write"),"clipboard.writeToClipboard",r)}))}function VM(){return j(this,void 0,void 0,(function*(){y(v,C.content,C.meetingStage,C.task,C.settings,C.stage,C.sidePanel);const e=S("v2","clipboard.read");if(!xp())throw E;const t=yield U(e,"clipboard.readFromClipboard");if(typeof t=="string"){const r=JSON.parse(t);return oA(r.mimeType,r.content)}return t}))}function xp(){return _.isFramelessWindow?!(!y(v)||!v.supports.clipboard):!!(y(v)&&navigator&&navigator.clipboard&&v.supports.clipboard)}const KM=Object.freeze(Object.defineProperty({__proto__:null,isSupported:xp,read:VM,write:WM},Symbol.toStringTag,{value:"Module"})),GM="v2",JM={validate:e=>Array.isArray(e)||typeof e=="object",deserialize:e=>e};var hs;function QM(){var e;return(e=y(v)&&(v.isNAAChannelRecommended||!!(y(v)&&IC()&&v.isLegacyTeams&&v.supports.nestedAppAuth)))!==null&&e!==void 0&&e}function YM(){return y(v),k.parentOrigin}function Hp(){var e;return(e=y(v)&&v.canParentManageNAATrustedOrigins)!==null&&e!==void 0&&e}function ZM(){var e;return(e=y(v)&&(v.isDeeplyNestedAuthSupported||!!(y(v)&&IC()&&v.isLegacyTeams&&Ie(qA))))!==null&&e!==void 0&&e}function IC(){return _.hostClientType===z.android||_.hostClientType===z.ios||_.hostClientType===z.ipados||_.hostClientType===z.visionOS}function XM(e){return j(this,void 0,void 0,(function*(){if(!Hp())throw E;const t=e.map(OC);return _C(hs.ADD,t)}))}function eD(e){return j(this,void 0,void 0,(function*(){if(!Hp())throw E;const t=e.map(OC);return _C(hs.DELETE,t)}))}function _C(e,t){return j(this,void 0,void 0,(function*(){if(window.parent!==window.top)throw new Error("This API is only available in the top-level parent.");if(!Array.isArray(t)||t.length===0)throw new Error(`The '${t}' parameter is required and must be a non-empty array.`);const r=[new tD(e,t)];return ce("nestedAppAuth.manageNAATrustedOrigins",r,JM,S(GM,"nestedAppAuth.manageNAATrustedOrigins"))}))}function OC(e){try{return new URL(e).origin.toLowerCase()}catch{throw new Error(`Invalid origin provided: ${e}`)}}(function(e){e.ADD="ADD",e.DELETE="DELETE"})(hs||(hs={}));let tD=class{constructor(t,r){this.action=t,this.appOrigins=r}serialize(){return{action:this.action,appOrigins:this.appOrigins}}};const rD=Object.freeze(Object.defineProperty({__proto__:null,addNAATrustedOrigins:XM,canParentManageNAATrustedOrigins:Hp,deleteNAATrustedOrigins:eD,getParentOrigin:YM,isDeeplyNestedAuthSupported:ZM,isNAAChannelRecommended:QM},Symbol.toStringTag,{value:"Module"}));function nD(){if(y(v,C.content,C.task),!$p())throw E;return U(S("v2","geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function iD(e){if(y(v,C.content,C.task),!$p())throw E;if(!e)throw{errorCode:N.INVALID_ARGUMENTS};return U(S("v2","geoLocation.showLocation"),"location.showLocation",e)}function $p(){return!!(y(v)&&v.supports.geoLocation&&v.supports.geoLocation.map&&v.supports.permissions)}const oD=Object.freeze(Object.defineProperty({__proto__:null,chooseLocation:nD,isSupported:$p,showLocation:iD},Symbol.toStringTag,{value:"Module"})),Wp="v2";function sD(){if(y(v,C.content,C.task),!Js())throw E;return U(S(Wp,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function aD(){if(y(v,C.content,C.task),!Js())throw E;const e=Ve.GeoLocation;return new Promise((t=>{t(U(S(Wp,"geoLocation.hasPermission"),"permissions.has",e))}))}function cD(){if(y(v,C.content,C.task),!Js())throw E;const e=Ve.GeoLocation;return new Promise((t=>{t(U(S(Wp,"geoLocation.requestPermission"),"permissions.request",e))}))}function Js(){return!!(y(v)&&v.supports.geoLocation&&v.supports.permissions)}const uD=Object.freeze(Object.defineProperty({__proto__:null,getCurrentLocation:sD,hasPermission:aD,isSupported:Js,map:oD,requestPermission:cD},Symbol.toStringTag,{value:"Module"}));function pD(e){if(y(v,C.content),!MC())throw E;if(!e||!pp(e))throw{errorCode:N.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return U(S("v2","secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function MC(){return!(!y(v)||!v.supports.secondaryBrowser)}const dD=Object.freeze(Object.defineProperty({__proto__:null,isSupported:MC,open:pD},Symbol.toStringTag,{value:"Module"}));function lD(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(y(v,C.content,C.task),!Ie(Um))throw{errorCode:N.OLD_PLATFORM};if(!e)throw{errorCode:N.INVALID_ARGUMENTS};if(!Vp())throw E;T(S("v1","location.getLocation"),"location.getLocation",[e],t)}function hD(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(y(v,C.content,C.task),!Ie(Um))throw{errorCode:N.OLD_PLATFORM};if(!e)throw{errorCode:N.INVALID_ARGUMENTS};if(!Vp())throw E;T(S("v1","location.showLocation"),"location.showLocation",[e],t)}function Vp(){return!(!y(v)||!v.supports.location)}const vD=Object.freeze(Object.defineProperty({__proto__:null,getLocation:lD,isSupported:Vp,showLocation:hD},Symbol.toStringTag,{value:"Module"}));function fD(e){y(v,C.sidePanel),e.contentUrl&&new URL(e.contentUrl),T(S("v1","meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}const gD=Object.freeze(Object.defineProperty({__proto__:null,setOptions:fD},Symbol.toStringTag,{value:"Module"})),ee="v1";var cr,Hu,$u,Ao,vs,fs;function mD(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function SD(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function CD(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");y(v,C.sidePanel,C.meetingStage,C.settings,C.content),T(S(ee,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function yD(){var e,t,r;return j(this,void 0,void 0,(function*(){let i;y(v,C.sidePanel,C.meetingStage,C.settings,C.content);try{i=yield U(S("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",!0)}catch(n){throw new Error((e=n==null?void 0:n.errorCode)===null||e===void 0?void 0:e.toString())}if((((t=i.details)===null||t===void 0?void 0:t.type)==Ao.GroupCall||((r=i.details)===null||r===void 0?void 0:r.type)==Ao.OneOnOneCall)&&!i.details.originalCallerInfo)throw new Error(N.NOT_SUPPORTED_ON_PLATFORM.toString());return i}))}function PD(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");y(v,C.sidePanel,C.meetingStage,C.task),T(S(ee,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function wD(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");y(v,C.sidePanel),T(S(ee,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function RD(e,t,r){if(!e)throw new Error("[request start live streaming] Callback cannot be null");y(v,C.sidePanel),T(S(ee,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,r],e)}function ED(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");y(v,C.sidePanel),T(S(ee,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function AD(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");y(v,C.sidePanel),B(S(ee,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function TD(e,t,r={sharingProtocol:vs.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,r],e)}function bD(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function ID(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function _D(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function OD(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");y(v,C.sidePanel,C.meetingStage),B(S(ee,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function MD(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");y(v,C.sidePanel,C.meetingStage),B(S(ee,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function DD(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");y(v,C.sidePanel,C.meetingStage),B(S(ee,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function kD(e){if((e==null?void 0:e.joinWebUrl)===void 0||(e==null?void 0:e.joinWebUrl)===null)return Promise.reject(new Error("Invalid joinMeetingParams"));y(v);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||fs.Other};return U(S("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function ND(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");y(v,C.sidePanel,C.meetingStage),e.isAppHandlingAudio?(function(r,i){const n=(s,a)=>{if(s&&a!=null)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(s)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${s.errorCode} ${s.message}`);if(typeof a!="boolean")throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");const o=u=>j(this,void 0,void 0,(function*(){try{const p=yield r.micMuteStateChangedCallback(u);Wu(p,p.isMicMuted===u.isMicMuted?cr.HostInitiated:cr.AppDeclinedToChange)}catch{Wu(u,cr.AppFailedToChange)}}));B(S(ee,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",o);const c=u=>{var p;(p=r.audioDeviceSelectionChangedCallback)===null||p===void 0||p.call(r,u)};B(S(ee,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",c),i(a)};T(S(ee,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[r.isAppHandlingAudio],n)})(e,t):(function(r,i){const n=(s,a)=>{if(s&&a!=null)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(s)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${s.errorCode} ${s.message}`);if(typeof a!="boolean")throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");pg("meeting.micStateChanged")&&pe("meeting.micStateChanged"),pg("meeting.audioDeviceSelectionChanged")&&pe("meeting.audioDeviceSelectionChanged"),i(a)};T(S(ee,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[r.isAppHandlingAudio],n)})(e,t)}function jD(e){Wu(e,cr.AppInitiated)}function Wu(e,t){y(v,C.sidePanel,C.meetingStage),T(S(ee,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}(function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"})(cr||(cr={})),(function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"})(Hu||(Hu={})),(function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"})($u||($u={})),(function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"})(Ao||(Ao={})),(function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"})(vs||(vs={})),(function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"})(fs||(fs={}));const zD=Object.freeze(Object.defineProperty({__proto__:null,get CallType(){return Ao},get EventActionSource(){return fs},get MeetingReactionType(){return Hu},get MeetingType(){return $u},get SharingProtocol(){return vs},appShareButton:gD,getAppContentStageSharingCapabilities:bD,getAppContentStageSharingState:_D,getAuthenticationTokenForAnonymousUser:PD,getIncomingClientAudioState:mD,getLiveStreamState:wD,getMeetingDetails:CD,getMeetingDetailsVerbose:yD,joinMeeting:kD,registerLiveStreamChangedHandler:AD,registerMeetingReactionReceivedHandler:DD,registerRaiseHandStateChangedHandler:MD,registerSpeakingStateChangeHandler:OD,requestAppAudioHandling:ND,requestStartLiveStreaming:RD,requestStopLiveStreaming:ED,shareAppContentToStage:TD,stopSharingAppContentToStage:ID,toggleIncomingClientAudio:SD,updateMicState:jD},Symbol.toStringTag,{value:"Module"}));function LD(e,t){let r,i,n="";return typeof e=="function"?(r=e,i=t,n=S("v1","monetization.openPurchaseExperience")):(i=e,n=S("v2","monetization.openPurchaseExperience")),y(v,C.content),rA((()=>new Promise((s=>{if(!DC())throw E;s(U(n,"monetization.openPurchaseExperience",i))}))),r)}function DC(){return!(!y(v)||!v.supports.monetization)}const FD=Object.freeze(Object.defineProperty({__proto__:null,isSupported:DC,openPurchaseExperience:LD},Symbol.toStringTag,{value:"Module"}));function qD(e){return new Promise((t=>{if(y(v,C.content),!Kp())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(de(S("v2","calendar.openCalendarItem"),"calendar.openCalendarItem",e))}))}function BD(e){return new Promise((t=>{if(y(v,C.content),!Kp())throw new Error("Not supported");const r=S("v2","calendar.composeMeeting");v.isLegacyTeams?t(de(r,"executeDeepLink",fM(e.attendees,e.startTime,e.endTime,e.subject,e.content))):t(de(r,"calendar.composeMeeting",e))}))}function Kp(){return!(!y(v)||!v.supports.calendar)}const UD=Object.freeze(Object.defineProperty({__proto__:null,composeMeeting:BD,isSupported:Kp,openCalendarItem:qD},Symbol.toStringTag,{value:"Module"}));function Ec(e){e&&e.length!==0&&e.forEach((t=>{vC(t)}))}function xD(e){if(y(v,C.content),!kC())throw new Error("Not supported");return(function(t){if(!t.handoffId||t.handoffId.trim().length==0||t.handoffId.trim()==="")throw new Error("handoffId should not be null or empty string.");const r=t.composeMailParams;r.type===gs.New&&(Ec(r.toRecipients),Ec(r.ccRecipients),Ec(r.bccRecipients))})(e),ne("mail.handoff.composeMail",[new HD(e)],S("v2","mail.handoff.composeMail"))}function kC(){return!!(y(v)&&v.supports.mail&&v.supports.mail.handoff)}let HD=class{constructor(t){this.composeMailParamsWithHandoff=t}serialize(){return this.composeMailParamsWithHandoff}};const $D=Object.freeze(Object.defineProperty({__proto__:null,composeMailWithHandoff:xD,isSupported:kC},Symbol.toStringTag,{value:"Module"}));function WD(e){return new Promise((t=>{if(y(v,C.content),!Gp())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(de(S("v2","mail.openMailItem"),"mail.openMailItem",e))}))}function VD(e){return new Promise((t=>{if(y(v,C.content),!Gp())throw new Error("Not supported");t(de(S("v2","mail.composeMail"),"mail.composeMail",e))}))}function Gp(){return!(!y(v)||!v.supports.mail)}var gs;(function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"})(gs||(gs={}));const KD=Object.freeze(Object.defineProperty({__proto__:null,get ComposeMailType(){return gs},composeMail:VD,handoff:$D,isSupported:Gp,openMailItem:WD},Symbol.toStringTag,{value:"Module"}));function GD(e,t){let r,i;y(v,C.content,C.task,C.settings);let n="";return typeof e=="function"?([r,i]=[e,t],n=S("v1","people.selectPeople")):(i=e,n=S("v2","people.selectPeople")),tA(JD,r,n,i)}function JD(e,t){return new Promise((r=>{if(!Ie(AA))throw{errorCode:N.OLD_PLATFORM};if(!LM(t))throw{errorCode:N.INVALID_ARGUMENTS};if(!NC())throw E;r(U(e,"people.selectPeople",t))}))}function NC(){return!(!y(v)||!v.supports.people)}const QD=Object.freeze(Object.defineProperty({__proto__:null,isSupported:NC,selectPeople:GD},Symbol.toStringTag,{value:"Module"}));function YD(e){return e?e.modality&&typeof e.modality!="string"?[!1,"modality must be a string"]:e.targetElementBoundingRect&&typeof e.targetElementBoundingRect=="object"?e.triggerType&&typeof e.triggerType=="string"?(function(t){return t?t.displayName&&typeof t.displayName!="string"?[!1,"displayName must be a string"]:!t.identifiers||typeof t.identifiers!="object"?[!1,"persona identifiers object must be provided"]:!t.identifiers.AadObjectId&&!t.identifiers.Smtp&&!t.identifiers.Upn?[!1,"at least one valid identifier must be provided"]:t.identifiers.AadObjectId&&typeof t.identifiers.AadObjectId!="string"?[!1,"AadObjectId identifier must be a string"]:t.identifiers.Smtp&&typeof t.identifiers.Smtp!="string"?[!1,"Smtp identifier must be a string"]:t.identifiers.Upn&&typeof t.identifiers.Upn!="string"?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"persona object must be provided"]})(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function ZD(e){return y(v,C.content),new Promise((t=>{const[r,i]=YD(e);if(!r)throw{errorCode:N.INVALID_ARGUMENTS,message:i};const n={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(U(S("v2","profile.showProfile"),"profile.showProfile",n))}))}function XD(){return!(!y(v)||!v.supports.profile)}const ek=Object.freeze(Object.defineProperty({__proto__:null,isSupported:XD,showProfile:ZD},Symbol.toStringTag,{value:"Module"})),go="v2",jC="search.queryChange",zC="search.queryClose",LC="search.queryExecute";function tk(e,t,r){if(y(v,C.content),!Qs())throw E;B(S(go,"search.registerOnClosedHandler"),zC,e),B(S(go,"search.registerOnExecutedHandler"),LC,t),r&&B(S(go,"search.registerOnChangeHandler"),jC,r)}function rk(){if(y(v,C.content),!Qs())throw E;T(S(go,"search.unregisterHandlers"),"search.unregister"),pe(jC),pe(zC),pe(LC)}function Qs(){return!(!y(v)||!v.supports.search)}function nk(){return new Promise((e=>{if(y(v,C.content),!Qs())throw new Error("Not supported");e(de(S(go,"search.closeSearch"),"search.closeSearch"))}))}const ik=Object.freeze(Object.defineProperty({__proto__:null,closeSearch:nk,isSupported:Qs,registerHandlers:tk,unregisterHandlers:rk},Symbol.toStringTag,{value:"Module"}));function ok(){return j(this,void 0,void 0,(function*(){if(y(v,C.sidePanel,C.meetingStage),!FC())throw E;return yield U(S("v2","sharing.history.getContent"),"sharing.history.getContent")}))}function FC(){var e;return y(v)&&((e=v.supports.sharing)===null||e===void 0?void 0:e.history)!==void 0}const sk=Object.freeze(Object.defineProperty({__proto__:null,getContent:ok,isSupported:FC},Symbol.toStringTag,{value:"Module"})),qC={shareWebContent:"sharing.shareWebContent"};function ak(e,t){try{(function(i){if(!(i&&i.content&&i.content.length))throw{errorCode:N.INVALID_ARGUMENTS,message:"Shared content is missing"}})(e),(function(i){let n;if(i.content.some((s=>!s.type)))throw n={errorCode:N.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},n;if(i.content.some((s=>s.type!==i.content[0].type)))throw n={errorCode:N.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},n})(e),(function(i){let n;if(i.content[0].type!=="URL")throw n={errorCode:N.INVALID_ARGUMENTS,message:"Content type is unsupported"},n;if(i.content.some((s=>!s.url)))throw n={errorCode:N.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},n})(e)}catch(i){return Qf((()=>Promise.reject(i)),t)}y(v,C.content,C.sidePanel,C.task,C.stage,C.meetingStage);const r=S(t?"v1":"v2","sharing.shareWebContent");return Qf(ck,t,r,e)}function ck(e,t){return new Promise((r=>{if(!BC())throw E;r(U(e,qC.shareWebContent,t))}))}function BC(){return!(!y(v)||!v.supports.sharing)}const uk=Object.freeze(Object.defineProperty({__proto__:null,SharingAPIMessages:qC,history:sk,isSupported:BC,shareWebContent:ak},Symbol.toStringTag,{value:"Module"}));function pk(){return new Promise((e=>{if(y(v,C.content),!UC())throw E;e(U(S("v2","stageView.self.close"),"stageView.self.close"))}))}function UC(){var e;return y(v)&&((e=v.supports.stageView)===null||e===void 0?void 0:e.self)!==void 0}const dk=Object.freeze(Object.defineProperty({__proto__:null,close:pk,isSupported:UC},Symbol.toStringTag,{value:"Module"}));var Vu;function lk(e){return new Promise((t=>{if(y(v,C.content),!xC())throw E;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(U(S("v2","stageView.open"),"stageView.open",e))}))}function xC(){return!(!y(v)||!v.supports.stageView)}(function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"})(Vu||(Vu={}));const hk=Object.freeze(Object.defineProperty({__proto__:null,get StageViewOpenMode(){return Vu},isSupported:xC,open:lk,self:dk},Symbol.toStringTag,{value:"Module"})),vk=10;function fk(e){return j(this,void 0,void 0,(function*(){y(v,C.content,C.task),HC(),$C(e);const t=yield U(S("v2","visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return WC(e.maxVisualMediaCount,t),t}))}function gk(e){return j(this,void 0,void 0,(function*(){y(v,C.content,C.task),HC(),$C(e);const t=yield U(S("v2","visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return WC(e.maxVisualMediaCount,t),t}))}function Ys(){return!!(y(v)&&v.supports.visualMedia&&v.supports.visualMedia.image&&v.supports.permissions)}function HC(){if(!Ys())throw E}function $C(e){if(!e||e.maxVisualMediaCount>vk||e.maxVisualMediaCount<1)throw JE}function WC(e,t){if(t.length>e)throw QE}const mk=Object.freeze(Object.defineProperty({__proto__:null,captureImages:fk,isSupported:Ys,retrieveImages:gk},Symbol.toStringTag,{value:"Module"}));var Ku,Gu;function Sk(){if(y(v,C.content,C.task),!Ys())throw E;const e=Ve.Media;return U(S("v2","visualMedia.hasPermission"),"permissions.has",e)}function Ck(){if(y(v,C.content,C.task),!Ys())throw E;const e=Ve.Media;return U(S("v2","visualMedia.requestPermission"),"permissions.request",e)}(function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"})(Ku||(Ku={})),(function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"})(Gu||(Gu={}));const yk=Object.freeze(Object.defineProperty({__proto__:null,get CameraRestriction(){return Ku},get Source(){return Gu},hasPermission:Sk,image:mk,requestPermission:Ck},Symbol.toStringTag,{value:"Module"}));let Ac=null;function Pk(){return j(this,void 0,void 0,(function*(){return Ac===null&&(Ac=(yield dS()).app.host.name),Ac}))}function wk(){return j(this,void 0,void 0,(function*(){if(y(v),!VC())throw E;return!(!v.isLegacyTeams||_.hostClientType!==z.android&&_.hostClientType!==z.ios&&_.hostClientType!==z.ipados&&_.hostClientType!==z.visionOS||(yield(function(){return j(this,void 0,void 0,(function*(){return Pk()}))})())!==mo.teams)||(yield Je(S("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))}))}function VC(){return y(v)&&v.supports.webStorage!==void 0}const Rk=Object.freeze(Object.defineProperty({__proto__:null,isSupported:VC,isWebStorageClearedOnUserLogOut:wk},Symbol.toStringTag,{value:"Module"}));var ms;function Ek(e){const t=S("v2","call.startCall");return new Promise((r=>{var i;if(y(v,C.content,C.task),!KC())throw E;if(!v.isLegacyTeams)return T(t,"call.startCall",[e],r);r(Je(t,"executeDeepLink",vM(e.targets,(i=e.requestedModalities)===null||i===void 0?void 0:i.includes(ms.Video),e.source)).then((n=>{if(!n)throw new Error(kA);return n})))}))}function KC(){return!(!y(v)||!v.supports.call)}(function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"})(ms||(ms={}));const Ak=Object.freeze(Object.defineProperty({__proto__:null,get CallModalities(){return ms},isSupported:KC,startCall:Ek},Symbol.toStringTag,{value:"Module"})),Zs="v1";function Tk(){TS(S(Zs,"appInitialization.notifyAppLoaded"))}function bk(){T(S(Zs,"appInitialization.notifySuccess"),Ct.Success,[Zt])}function Ik(e){IS(S(Zs,"appInitialization.notifyFailure"),e)}function _k(e){bS(S(Zs,"appInitialization.notifyExpectedFailure"),e)}const Ok=Object.freeze(Object.defineProperty({__proto__:null,get ExpectedFailureReason(){return as},get FailedReason(){return ss},Messages:Ct,notifyAppLoaded:Tk,notifyExpectedFailure:_k,notifyFailure:Ik,notifySuccess:bk},Symbol.toStringTag,{value:"Module"})),Cg=ae("thirdPartyCloudStorage");let Mk=class{constructor(t,r){this.fileType=t,this.assembleAttachment=r}},Gt=[],Jt=null,gt=!0,X=null;function Dk(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&e!==""){if(y(v,C.content,C.task),!GC())throw E;if(X)throw X=null,new Error("getDragAndDropFiles cannot be called twice");X=t,gt=!0,T(S("v2","thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],kk)}else t([],{errorCode:N.INVALID_ARGUMENTS})}function kk(e){if(X)if(e&&e.error)X([],e.error),X=null;else if(e&&e.fileChunk)try{gt||e.fileChunk.chunkSequence!==0||(Cg("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),gt=!0,X([],{errorCode:N.INTERNAL_ERROR,message:"error occurred while receiving data"}),Gt=[],X=null);const t=xu(e.fileChunk,e.fileType);if(t?(Jt||(Jt=new Mk(e.fileType,[])),Jt.assembleAttachment.push(t)):(Cg(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),X?X([],{errorCode:N.INTERNAL_ERROR,message:"error occurred while receiving data"}):X=null,Gt=[],X=null,gt=!0),gt=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&Jt){const r=Uu(Jt.assembleAttachment,Jt.fileType);if(r){const i=new File([r],e.fileName,{type:r.type});Gt.push(i)}e.isLastFile&&X&&(X(Gt,e.error),Gt=[],X=null,gt=!0),Jt=null}}catch(t){X&&(X([],{errorCode:N.INTERNAL_ERROR,message:t}),Gt=[],X=null,gt=!0)}else X([],{errorCode:N.INTERNAL_ERROR,message:"data received is null"}),Gt=[],X=null,gt=!0}function GC(){return!(!y(v)||!v.supports.thirdPartyCloudStorage)}const Nk=Object.freeze(Object.defineProperty({__proto__:null,getDragAndDropFiles:Dk,isSupported:GC},Symbol.toStringTag,{value:"Module"})),Fo="v1";function jk(e){qS(S(Fo,"settings.setValidityState"),e)}function zk(e){y(v,C.content,C.settings,C.remove,C.sidePanel),BS(S(Fo,"settings.getSettings")).then((t=>{e(t)}))}function Lk(e,t){y(v,C.content,C.settings,C.sidePanel);const r=t??Rt();US(S(Fo,"settings.setSettings"),e).then((()=>{r(!0)})).catch((i=>{r(!1,i.message)}))}function Fk(e){yp(S(Fo,"settings.registerOnSaveHandler"),e)}function qk(e){Pp(S(Fo,"settings.registerOnRemoveHandler"),e)}const Bk=Object.freeze(Object.defineProperty({__proto__:null,getSettings:zk,registerOnRemoveHandler:qk,registerOnSaveHandler:Fk,setSettings:Lk,setValidityState:jk},Symbol.toStringTag,{value:"Module"})),Jp="v1";function Uk(e,t){const r=S(Jp,"tasks.startTask"),i=t?n=>{var s,a;return t((s=n.err)!==null&&s!==void 0?s:"",(a=n.result)!==null&&a!==void 0?a:"")}:void 0;return e.card===void 0&&e.url===void 0||e.card?(y(v,C.content,C.sidePanel,C.meetingStage),T(r,"tasks.startTask",[e],t)):e.completionBotId!==void 0?mS(r,(function(n){if(n.url===void 0||n.completionBotId===void 0)throw new Error(`Both url ${n.url} and completionBotId ${n.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:n.url,size:{height:n.height?n.height:ge.Small,width:n.width?n.width:ge.Small},title:n.title,fallbackUrl:n.fallbackUrl,completionBotId:n.completionBotId}})(e),i):gS(r,(function(n){if(n.url===void 0)throw new Error("url property of taskInfo object can't be undefined");return{url:n.url,size:{height:n.height?n.height:ge.Small,width:n.width?n.width:ge.Small},title:n.title,fallbackUrl:n.fallbackUrl}})(e),i),new fC}function xk(e){e=JC(e);const t=wt(e,["width","height"]);if(Object.keys(t).length)throw new Error("resize requires a TaskInfo argument containing only width and height");fS(S(Jp,"tasks.updateTask"),e)}function Hk(e,t){SS(S(Jp,"tasks.submitTask"),e,t)}function JC(e){return e.height=e.height?e.height:ge.Small,e.width=e.width?e.width:ge.Small,e}const $k=Object.freeze(Object.defineProperty({__proto__:null,getDefaultSizeIfNotProvided:JC,startTask:Uk,submitTask:Hk,updateTask:xk},Symbol.toStringTag,{value:"Module"}));function Xs(e){try{return e.cartItems=QC(e.cartItems),e}catch{throw new Error("Error deserializing cart")}}function QC(e){return e.map((t=>{if(t.imageURL){const r=new URL(t.imageURL);t.imageURL=r}return t.accessories&&(t.accessories=QC(t.accessories)),t}))}const YC=e=>{try{return e.map((t=>{const{imageURL:r,accessories:i}=t,n=wt(t,["imageURL","accessories"]),s=Object.assign({},n);return r&&(s.imageURL=r.href),i&&(s.accessories=YC(i)),s}))}catch{throw new Error("Error serializing cart items")}};function Wk(e){if(!Array.isArray(e)||e.length===0)throw new Error("cartItems must be a non-empty array");for(const t of e)ZC(t),Vk(t.accessories)}function Vk(e){if(e!=null){if(!Array.isArray(e)||e.length===0)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");ZC(t)}}}function ZC(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");Kk(e.price),Gk(e.quantity)}function Qp(e){if(e!=null){if(!e)throw new Error("id must not be empty");if(jm(e)===!1)throw new Error("id must be a valid UUID")}}function Kk(e){if(typeof e!="number"||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function Gk(e){if(typeof e!="number"||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function Jk(e){if(!Object.values(Ss).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const ea="v2",qo={majorVersion:1,minorVersion:1};var Ju,Ss;function Qk(){if(y(v,C.content,C.task),!Bo())throw E;return U(S(ea,"marketplace.getCart"),"marketplace.getCart",qo).then(Xs)}function Yk(e){if(y(v,C.content,C.task),!Bo())throw E;if(!e)throw new Error("addOrUpdateCartItemsParams must be provided");return Qp(e==null?void 0:e.cartId),Wk(e==null?void 0:e.cartItems),U(S(ea,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:YC(e.cartItems),cartVersion:qo})).then(Xs)}function Zk(e){if(y(v,C.content,C.task),!Bo())throw E;if(!e)throw new Error("removeCartItemsParams must be provided");if(Qp(e==null?void 0:e.cartId),!Array.isArray(e==null?void 0:e.cartItemIds)||(e==null?void 0:e.cartItemIds.length)===0)throw new Error("cartItemIds must be a non-empty array");return U(S(ea,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:qo})).then(Xs)}function Xk(e){if(y(v,C.content,C.task),!Bo())throw E;if(!e)throw new Error("updateCartStatusParams must be provided");return Qp(e==null?void 0:e.cartId),Jk(e==null?void 0:e.cartStatus),U(S(ea,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:qo})).then(Xs)}function Bo(){return!(!y(v)||!v.supports.marketplace)}(function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"})(Ju||(Ju={})),(function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"})(Ss||(Ss={}));const eN=Object.freeze(Object.defineProperty({__proto__:null,get CartStatus(){return Ss},get Intent(){return Ju},addOrUpdateCartItems:Yk,cartVersion:qo,getCart:Qk,isSupported:Bo,removeCartItems:Zk,updateCartStatus:Xk},Symbol.toStringTag,{value:"Module"}));class tN{constructor(t){this.event=t}serialize(){return{altKey:this.event.altKey,bubbles:this.event.bubbles,cancelBubble:this.event.cancelBubble,charCode:this.event.charCode,code:this.event.code,composed:this.event.composed,ctrlKey:this.event.ctrlKey,defaultPrevented:this.event.defaultPrevented,detail:this.event.detail,eventPhase:this.event.eventPhase,isComposing:this.event.isComposing,isTrusted:this.event.isTrusted,key:this.event.key,keyCode:this.event.keyCode,location:this.event.location,metaKey:this.event.metaKey,repeat:this.event.repeat,returnValue:this.event.returnValue,shiftKey:this.event.shiftKey,timeStamp:this.event.timeStamp,type:this.event.type,which:this.event.which}}}function yg(e){return e.toLowerCase().split("+").sort().join("+")}function rN(e,t){if((function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey||!!r.key&&r.key.toLowerCase()==="escape"})(t)){const r=(function(i){return[i.ctrlKey&&"ctrl",i.shiftKey&&"shift",i.altKey&&"alt",i.metaKey&&"meta",i.key.toLowerCase()].filter(Boolean).sort().join("+")})(t);if(e.has(r))return{matchedShortcut:r,isOverridable:Cs.has(r)}}return{matchedShortcut:void 0,isOverridable:!1}}function Pg(e){ys.clear(),e.shortcuts.forEach((t=>{ys.add(yg(t))})),Cs.clear(),e.overridableShortcuts.forEach((t=>{Cs.add(yg(t))}))}class nN extends Me{validate(t){return t&&Array.isArray(t.shortcuts)&&Array.isArray(t.overridableShortcuts)}deserialize(t){return t}}function XC(e){if(e.target.closest(`[${ey}]`))return;const{matchedShortcut:t,isOverridable:r}=rN(ys,e);if(!t||r&&To&&To(e,{matchedShortcut:t}))return;const i=new tN(e);ne("shortcutRelay.forwardShortcutEvent",[i],S("v2","shortcutRelay.forwardShortcutEvent")),e.preventDefault(),e.stopImmediatePropagation()}const Cs=new Set,ys=new Set;let To,Qu=!1;function iN(e){if(!ta())throw E;const t=To;return To=e,t}function oN(){if(!ta())throw E;Qu=!1,ys.clear(),Cs.clear(),To=void 0,document.removeEventListener("keydown",XC,{capture:!0})}function sN(){return j(this,void 0,void 0,(function*(){if(!ta())throw E;var e;Pg(yield ce("shortcutRelay.getHostShortcuts",[],new nN,S("v2","shortcutRelay.getHostShortcuts"))),Qu||document.addEventListener("keydown",XC,{capture:!0}),Qu=!0,e=t=>{Pg(t)},B(S("v2","shortcutRelay.hostShortcutChanged"),"shortcutRelay.hostShortcutChanged",e)}))}function ta(){return!(!y(v)||!v.supports.shortcutRelay)}const ey="data-disable-shortcuts-forwarding",aN=Object.freeze(Object.defineProperty({__proto__:null,DISABLE_SHORTCUT_FORWARDING_ATTRIBUTE:ey,enableShortcutRelayCapability:sN,isSupported:ta,resetIsShortcutRelayCapabilityEnabled:oN,setOverridableShortcutHandler:iN},Symbol.toStringTag,{value:"Module"})),oz=Object.freeze(Object.defineProperty({__proto__:null,get ActionObjectType(){return qc},AppId:_e,get ChannelType(){return Wc},ChildAppWindow:fC,get DialogDimension(){return ge},get EduType(){return Uc},EmailAddress:vO,get ErrorCode(){return N},get FileOpenPreference(){return Fc},get FrameContexts(){return C},get HostClientType(){return z},get HostName(){return mo},LiveShareHost:SC,get NotificationTypes(){return Nc},ParentAppWindow:gO,get RenderingSurfaces(){return xc},get SecondaryM365ContentIdName(){return Bc},get TaskModuleDimension(){return ge},get TeamType(){return Hc},UUID:Et,get UserAuthenticationState(){return Po},get UserSettingTypes(){return zc},get UserTeamRole(){return $c},ValidatedSafeString:sS,get ViewerActionTypes(){return jc},activateChildProxyingCommunication:_E,app:DT,appEntity:p0,appInitialization:Ok,appInstallDialog:SM,appPerformanceMetrics:eM,authentication:YO,barCode:UM,calendar:UD,call:Ak,chat:$M,clipboard:KM,conversations:NI,copilot:e_,dialog:YT,enablePrintCapability:PO,executeDeepLink:LO,externalAppAuthentication:II,externalAppAuthenticationForCEA:o_,externalAppCardActions:c_,externalAppCardActionsForCEA:d_,externalAppCardActionsForDA:v_,externalAppCommands:g_,files:j_,geoLocation:uD,getAdaptiveCardSchemaVersion:fO,getContext:RO,getCurrentFeatureFlagsState:sp,getMruTabInstances:jO,getTabInstances:NO,hostEntity:x0,initialize:yO,initializeWithFrameContext:qO,liveShare:$O,location:vD,logs:OI,mail:KD,marketplace:eN,media:IM,meeting:zD,meetingRoom:B_,menus:ob,messageChannels:x_,monetization:FD,navigateBack:HO,navigateCrossDomain:xO,navigateToTab:UO,nestedAppAuth:rD,nestedAppAuthBridge:K_,notifications:J_,openFilePreview:SI,otherAppStateChange:X_,overwriteFeatureFlagsState:OE,pages:Hb,people:QD,print:wO,profile:ek,registerAppButtonClickHandler:TO,registerAppButtonHoverEnterHandler:bO,registerAppButtonHoverLeaveHandler:IO,registerBackButtonHandler:_O,registerBeforeUnloadHandler:MO,registerChangeSettingsHandler:kO,registerCustomHandler:gI,registerFocusEnterHandler:DO,registerFullScreenHandler:AO,registerOnLoadHandler:OO,registerOnThemeChangeHandler:EO,registerUserSettingsChangeHandler:mI,remoteCamera:c0,returnFocus:BO,search:ik,secondaryBrowser:dD,sendCustomEvent:fI,sendCustomMessage:vI,setFeatureFlagsState:Rm,setFrameContext:FO,settings:Bk,shareDeepLink:zO,sharing:uk,shortcutRelay:aN,sidePanelInterfaces:UI,stageView:hk,store:K0,tasks:$k,teams:m0,teamsCore:CO,thirdPartyCloudStorage:Nk,uploadCustomApp:hI,version:Zt,videoEffects:P0,videoEffectsEx:D0,visualMedia:yk,webStorage:Rk,widgetHosting:hO},Symbol.toStringTag,{value:"Module"}));export{yO as B,RO as E,EO as L,bk as f,QO as g,VO as k,oz as m,KO as p,cj as r,Tk as s,JO as w};
